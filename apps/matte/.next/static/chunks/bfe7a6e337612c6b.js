(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,34098,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(87467);var s=e.i(55654);let i=a.forwardRef(({className:e,type:a,error:i,...r},l)=>(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("input",{type:a,className:(0,s.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",i&&"border-destructive focus-visible:ring-destructive",e),ref:l,...r}),i&&(0,t.jsx)("p",{className:"mt-1 text-xs text-destructive",children:i})]}));i.displayName="Input",e.s(["Input",()=>i])},40574,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(25913);e.i(87467);var i=e.i(55654),r=e.i(31278);let l=(0,s.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:opacity-90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-muted hover:text-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-muted hover:text-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground shadow-sm hover:bg-success/90"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),n=a.forwardRef(({className:e,variant:a,size:s,loading:n,children:o,disabled:d,...c},m)=>(0,t.jsxs)("button",{className:(0,i.cn)(l({variant:a,size:s,className:e})),ref:m,disabled:d||n,...c,children:[n&&(0,t.jsx)(r.Loader2,{className:"animate-spin"}),o]}));n.displayName="Button",e.s(["Button",()=>n])},25913,e=>{"use strict";var t=e.i(7670);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=t.clsx;e.s(["cva",0,(e,t)=>i=>{var r;if((null==t?void 0:t.variants)==null)return s(e,null==i?void 0:i.class,null==i?void 0:i.className);let{variants:l,defaultVariants:n}=t,o=Object.keys(l).map(e=>{let t=null==i?void 0:i[e],s=null==n?void 0:n[e];if(null===t)return null;let r=a(t)||a(s);return l[e][r]}),d=i&&Object.entries(i).reduce((e,t)=>{let[a,s]=t;return void 0===s||(e[a]=s),e},{});return s(e,o,null==t||null==(r=t.compoundVariants)?void 0:r.reduce((e,t)=>{let{class:a,className:s,...i}=t;return Object.entries(i).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...n,...d}[t]):({...n,...d})[t]===a})?[...e,a,s]:e},[]),null==i?void 0:i.class,null==i?void 0:i.className)}])},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},80720,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(87467);var s=e.i(55654);let i=a.forwardRef(({className:e,...a},i)=>(0,t.jsx)("label",{ref:i,className:(0,s.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...a}));i.displayName="Label",e.s(["Label",()=>i])},7003,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(87467);var s=e.i(55654),i=e.i(37727);let r=a.createContext(void 0);function l({children:e,open:s,onOpenChange:i}){let[l,n]=a.useState(!1);return(0,t.jsx)(r.Provider,{value:{open:s??l,setOpen:i??n},children:e})}function n({children:e,className:l}){let{open:n,setOpen:o}=function(){let e=a.useContext(r);if(!e)throw Error("useDialog must be used within a Dialog");return e}();return(a.useEffect(()=>{let e=e=>{"Escape"===e.key&&o(!1)};return n&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow=""}},[n,o]),n)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 animate-fade-in",onClick:()=>o(!1)}),(0,t.jsxs)("div",{className:(0,s.cn)("relative z-50 w-full max-w-lg max-h-[90vh] overflow-auto rounded-lg bg-card p-4 sm:p-6 shadow-lg animate-slide-up",l),children:[(0,t.jsxs)("button",{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onClick:()=>o(!1),children:[(0,t.jsx)(i.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),e]})]}):null}function o({className:e,...a}){return(0,t.jsx)("div",{className:(0,s.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...a})}function d({className:e,...a}){return(0,t.jsx)("h2",{className:(0,s.cn)("text-lg font-semibold leading-none tracking-tight",e),...a})}function c({className:e,...a}){return(0,t.jsx)("p",{className:(0,s.cn)("text-sm text-muted-foreground",e),...a})}function m({className:e,...a}){return(0,t.jsx)("div",{className:(0,s.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a})}e.s(["Dialog",()=>l,"DialogContent",()=>n,"DialogDescription",()=>c,"DialogFooter",()=>m,"DialogHeader",()=>o,"DialogTitle",()=>d])},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},48137,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(87467);var s=e.i(55654);let i=a.createContext(void 0);function r(){let e=a.useContext(i);if(!e)throw Error("useTabs must be used within a Tabs");return e}function l({children:e,defaultValue:r,value:l,onValueChange:n,className:o}){let[d,c]=a.useState(r??"");return(0,t.jsx)(i.Provider,{value:{value:l??d,onValueChange:n??c},children:(0,t.jsx)("div",{className:(0,s.cn)("w-full",o),children:e})})}function n({children:e,className:a}){return(0,t.jsx)("div",{className:(0,s.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),children:e})}function o({children:e,value:a,className:i,disabled:l}){let{value:n,onValueChange:o}=r(),d=n===a;return(0,t.jsx)("button",{type:"button",role:"tab","aria-selected":d,disabled:l,className:(0,s.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",d&&"bg-background text-foreground shadow",i),onClick:()=>o(a),children:e})}function d({children:e,value:a,className:i}){let{value:l}=r();return l!==a?null:(0,t.jsx)("div",{role:"tabpanel",className:(0,s.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",i),children:e})}e.s(["Tabs",()=>l,"TabsContent",()=>d,"TabsList",()=>n,"TabsTrigger",()=>o])},61659,e=>{"use strict";let t=(0,e.i(75254).default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);e.s(["CreditCard",()=>t],61659)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},73708,e=>{"use strict";let t=(0,e.i(75254).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["Image",()=>t],73708)},61911,e=>{"use strict";let t=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>t],61911)},69074,e=>{"use strict";let t=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],69074)},708,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),i=e.i(26293),r=e.i(87467),l=e.i(55654),n=e.i(40574),o=e.i(34098),d=e.i(80720),c=e.i(48137),m=e.i(7003),u=e.i(69481),h=e.i(75254);let p=(0,h.default)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),x=(0,h.default)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),g=(0,h.default)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var f=e.i(61911);let v=(0,h.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var y=e.i(27612),j=e.i(43531);let b=(0,h.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var w=e.i(61659),N=e.i(69074),k=e.i(73708);function _({company:e,isOwner:h,currentUserId:_,currentUserEmail:C,config:S,teamMembers:L,inviteLinks:M,pickupLocations:T}){let D=(0,s.useRouter)(),{addToast:E}=(0,u.useToast)(),F=(0,i.createClient)(),[R,U]=(0,a.useState)(e),[I,q]=(0,a.useState)(S),[B,P]=(0,a.useState)(M),[$,O]=(0,a.useState)(T),[A,z]=(0,a.useState)("");(0,a.useEffect)(()=>{z(window.location.origin)},[]);let[V,H]=(0,a.useState)(R.name),[J,W]=(0,a.useState)(R.theme_id),[G,Z]=(0,a.useState)(!1),[Y,K]=(0,a.useState)(!1),[X,Q]=(0,a.useState)(R.logo_url||null),[ee,et]=(0,a.useState)(I?.walls_rate_per_sqft?.toString()||""),[ea,es]=(0,a.useState)(I?.ceilings_rate_per_sqft?.toString()||""),[ei,er]=(0,a.useState)(I?.trim_rate_per_sqft?.toString()||""),[el,en]=(0,a.useState)(I?.labor_rate_per_hour?.toString()||""),[eo,ed]=(0,a.useState)(!1),[ec,em]=(0,a.useState)(!1),[eu,eh]=(0,a.useState)(null),[ep,ex]=(0,a.useState)(""),[eg,ef]=(0,a.useState)(""),[ev,ey]=(0,a.useState)(""),[ej,eb]=(0,a.useState)(""),[ew,eN]=(0,a.useState)(""),[ek,e_]=(0,a.useState)(!1);async function eC(){Z(!0);try{let{error:e}=await F.from("companies").update({name:V.trim(),theme_id:J}).eq("id",R.id);if(e)throw e;U(e=>({...e,name:V.trim(),theme_id:J})),document.documentElement.setAttribute("data-theme",J),E("Company settings saved!","success"),D.refresh()}catch{E("Failed to save settings","error")}finally{Z(!1)}}async function eS(e){let t=e.target.files?.[0];if(t){if(t.size>5242880)return void E("File too large (max 5MB)","error");if(!["image/jpeg","image/png","image/webp","image/svg+xml"].includes(t.type))return void E("Invalid file type. Allowed: JPEG, PNG, WebP, SVG","error");K(!0);try{let e=new FormData;e.append("file",t);let a=await fetch(`/api/companies/${R.id}/logo`,{method:"POST",body:e}),s=await a.json();if(!a.ok)throw Error(s.error||"Failed to upload logo");Q(s.logo_url),U(e=>({...e,logo_url:s.logo_url})),E("Logo uploaded successfully!","success"),D.refresh()}catch(e){E(e instanceof Error?e.message:"Failed to upload logo","error")}finally{K(!1),e.target.value=""}}}async function eL(){ed(!0);try{let e={company_id:R.id,updated_at:new Date().toISOString()};ee.trim()&&(e.walls_rate_per_sqft=parseFloat(ee)),ea.trim()&&(e.ceilings_rate_per_sqft=parseFloat(ea)),ei.trim()&&(e.trim_rate_per_sqft=parseFloat(ei)),el.trim()&&(e.labor_rate_per_hour=parseFloat(el));let{error:t}=await F.from("estimating_config").upsert(e,{onConflict:"company_id"});if(t)throw t;let{data:a}=await F.from("estimating_config").select("*").eq("company_id",R.id).single();a&&(q(a),et(a.walls_rate_per_sqft?.toString()||""),es(a.ceilings_rate_per_sqft?.toString()||""),er(a.trim_rate_per_sqft?.toString()||""),en(a.labor_rate_per_hour?.toString()||"")),E("Estimating rates saved!","success")}catch{E("Failed to save rates","error")}finally{ed(!1)}}async function eM(e){if(e===_)return void E("You cannot remove yourself","error");if(!confirm("Remove this user from the company?"))return;let{error:t}=await F.from("company_users").delete().eq("user_id",e).eq("company_id",R.id);t?E("Failed to remove user","error"):(D.refresh(),E("User removed","success"))}async function eT(e){if(e.preventDefault(),ep.trim()){e_(!0);try{let e={company_id:R.id,name:ep.trim(),address1:eg||null,city:ev||null,state:ej||null,zip:ew||null};if(eu){let{data:t,error:a}=await F.from("pickup_locations").update(e).eq("id",eu.id).select().single();if(a)throw a;O(e=>e.map(e=>e.id===eu.id?t:e))}else{let{data:t,error:a}=await F.from("pickup_locations").insert(e).select().single();if(a)throw a;O(e=>[...e,t].sort((e,t)=>e.name.localeCompare(t.name)))}em(!1),E("Location saved!","success")}catch{E("Failed to save location","error")}finally{e_(!1)}}}async function eD(){try{let{data:e,error:t}=await F.from("invoices").select("*").eq("company_id",R.id).order("created_at",{ascending:!1});if(t)throw t;let a=[...new Set((e||[]).map(e=>e.customer_id).filter(e=>null!==e))],s=[...new Set((e||[]).map(e=>e.job_id).filter(e=>null!==e))],{data:i}=a.length>0?await F.from("customers").select("id, name").in("id",a):{data:[]},{data:r}=s.length>0?await F.from("jobs").select("id, title").in("id",s):{data:[]},l=new Map((i||[]).map(e=>[e.id,e.name])),n=new Map((r||[]).map(e=>[e.id,e.title])),o=["Date,Customer,Job,Amount,Status,Paid At",...(e||[]).map(e=>[e.created_at,`"${l.get(e.customer_id)||""}"`,`"${n.get(e.job_id)||""}"`,(e.amount_total/100).toFixed(2),e.status,e.paid_at||""].join(","))].join("\n"),d=new Blob([o],{type:"text/csv"}),c=URL.createObjectURL(d),m=document.createElement("a");m.href=c,m.download=`invoices-${new Date().toISOString().split("T")[0]}.csv`,m.click(),URL.revokeObjectURL(c),E("Invoices exported!","success")}catch{E("Failed to export","error")}}async function eE(){try{let{data:e}=await F.from("invoices").select("id").eq("company_id",R.id),t=e?.map(e=>e.id)||[],{data:a,error:s}=t.length>0?await F.from("invoice_payments").select("*").in("invoice_id",t).order("paid_at",{ascending:!1}):{data:[]};if(s)throw s;let{data:i}=t.length>0?await F.from("invoices").select("id, customer_id, job_id").in("id",t):{data:[]},r=[...new Set((i||[]).map(e=>e.customer_id).filter(e=>null!==e))],l=[...new Set((i||[]).map(e=>e.job_id).filter(e=>null!==e))],{data:n}=r.length>0?await F.from("customers").select("id, name").in("id",r):{data:[]},{data:o}=l.length>0?await F.from("jobs").select("id, title").in("id",l):{data:[]},d=new Map((i||[]).map(e=>[e.id,e])),c=new Map((n||[]).map(e=>[e.id,e.name])),m=new Map((o||[]).map(e=>[e.id,e.title])),u=["Date,Customer,Job,Amount,Payment Method",...(a||[]).map(e=>{let t=d.get(e.invoice_id),a=e.stripe_payment_intent_id?.startsWith("manual_")?e.stripe_payment_intent_id.split("_")[1]:"Stripe",s=t?.customer_id||"",i=t?.job_id||"";return[e.paid_at,`"${c.get(s)||""}"`,`"${m.get(i)||""}"`,(e.amount/100).toFixed(2),a].join(",")})].join("\n"),h=new Blob([u],{type:"text/csv"}),p=URL.createObjectURL(h),x=document.createElement("a");x.href=p,x.download=`payments-${new Date().toISOString().split("T")[0]}.csv`,x.click(),URL.revokeObjectURL(p),E("Payments exported!","success")}catch{E("Failed to export","error")}}async function eF(){try{let{data:e,error:t}=await F.from("customers").select("*").eq("company_id",R.id).order("name");if(t)throw t;let a=["Name,Phone,Email,Address,City,State,ZIP,Notes,Created At",...(e||[]).map(e=>[`"${e.name}"`,e.phone||"",e.email||"",`"${e.address1||""}"`,e.city||"",e.state||"",e.zip||"",`"${(e.notes||"").replace(/"/g,'""')}"`,e.created_at].join(","))].join("\n"),s=new Blob([a],{type:"text/csv"}),i=URL.createObjectURL(s),r=document.createElement("a");r.href=i,r.download=`customers-${new Date().toISOString().split("T")[0]}.csv`,r.click(),URL.revokeObjectURL(i),E("Customers exported!","success")}catch{E("Failed to export","error")}}let[eR,eU]=(0,a.useState)(!1),[eI,eq]=(0,a.useState)(!1),[eB,eP]=(0,a.useState)(""),[e$,eO]=(0,a.useState)("");async function eA(){if(!eB||!e$)return void E("Please select both start and end dates","error");eq(!0);try{let{data:e,error:t}=await F.from("jobs").select(`
          *,
          customer:customers(name, phone, email, address1, city, state, zip)
        `).eq("company_id",R.id).gte("created_at",eB).lte("created_at",`${e$}T23:59:59`).order("created_at",{ascending:!1});if(t)throw t;let{data:a,error:s}=await F.from("invoices").select("*").eq("company_id",R.id).gte("created_at",eB).lte("created_at",`${e$}T23:59:59`).order("created_at",{ascending:!1});if(s)throw s;let i=["Date,Job Title,Customer Name,Customer Phone,Customer Email,Address,Job Status,Invoice Amount,Invoice Status,Payment Date",...(e||[]).map(e=>{let t=(a||[]).filter(t=>t.job_id===e.id),s=t.reduce((e,t)=>e+t.amount_total,0),i=t.filter(e=>"paid"===e.status),r=i.length>0?i[0].updated_at:"",n=e.customer,o=n?[n.address1,n.city,n.state,n.zip].filter(Boolean).join(", "):"";return[(0,l.formatDate)(e.created_at),`"${e.title.replace(/"/g,'""')}"`,n?`"${n.name.replace(/"/g,'""')}"`:"",n?.phone||"",n?.email||"",`"${o.replace(/"/g,'""')}"`,e.status,s.toFixed(2),t.length>0?t[0].status:"none",r?(0,l.formatDate)(r):""].join(",")})].join("\n"),r=new Blob([i],{type:"text/csv"}),n=URL.createObjectURL(r),o=document.createElement("a");o.href=n,o.download=`jobs-export-${eB}-to-${e$}.csv`,o.click(),URL.revokeObjectURL(n),E("Export complete!","success"),eU(!1)}catch(e){console.error("Export error:",e),E("Failed to export data","error")}finally{eq(!1)}}return(0,t.jsxs)("div",{className:"min-h-screen pb-20 lg:pb-0",children:[(0,t.jsx)("div",{className:"border-b bg-card p-4",children:(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Settings"})}),(0,t.jsx)("div",{className:"max-w-3xl mx-auto p-4",children:(0,t.jsxs)(c.Tabs,{defaultValue:"company",className:"w-full",children:[(0,t.jsxs)(c.TabsList,{className:"w-full justify-start overflow-x-auto scrollbar-hide flex-nowrap gap-1 -mx-4 px-4 lg:flex-wrap lg:overflow-x-visible",children:[(0,t.jsxs)(c.TabsTrigger,{value:"company",children:[(0,t.jsx)(p,{className:"mr-1.5 h-4 w-4"}),"Company"]}),(0,t.jsxs)(c.TabsTrigger,{value:"estimating",children:[(0,t.jsx)(g,{className:"mr-1.5 h-4 w-4"}),"Estimating"]}),(0,t.jsxs)(c.TabsTrigger,{value:"crew",children:[(0,t.jsx)(f.Users,{className:"mr-1.5 h-4 w-4"}),"Crew"]}),(0,t.jsxs)(c.TabsTrigger,{value:"exports",children:[(0,t.jsx)(v,{className:"mr-1.5 h-4 w-4"}),"Exports"]}),(0,t.jsxs)(c.TabsTrigger,{value:"account",children:[(0,t.jsx)(f.Users,{className:"mr-1.5 h-4 w-4"}),"Account"]})]}),(0,t.jsxs)(c.TabsContent,{value:"company",className:"mt-6 space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Company Details"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"companyName",children:"Company Name"}),(0,t.jsx)(o.Input,{id:"companyName",value:V,onChange:e=>H(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(k.Image,{className:"h-4 w-4"}),"Company Logo"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Upload your company logo to display on customer-facing pages (estimates, invoices, payment links)."}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[X?(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("img",{src:X,alt:"Company Logo",className:"w-20 h-20 rounded-lg object-cover border"})}):(0,t.jsx)("div",{className:"w-20 h-20 rounded-lg bg-muted border flex items-center justify-center",children:(0,t.jsx)(k.Image,{className:"h-8 w-8 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(d.Label,{htmlFor:"logoUpload",className:"cursor-pointer",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.Upload,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:X?"Change Logo":"Upload Logo"})]})}),(0,t.jsx)("input",{id:"logoUpload",type:"file",accept:"image/jpeg,image/png,image/webp,image/svg+xml",onChange:eS,disabled:Y,className:"hidden"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Max 5MB. Formats: JPEG, PNG, WebP, SVG"})]})]}),Y&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Uploading..."})]}),(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(x,{className:"h-4 w-4"}),"Theme"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose a Sherwin-Williams inspired color theme."}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3",children:r.THEMES.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>W(e.id),className:`relative rounded-lg border p-3 text-left transition-all ${J===e.id?"border-primary ring-2 ring-primary":"hover:border-muted-foreground"}`,children:[(0,t.jsx)("div",{className:"h-8 w-full rounded mb-2",style:{backgroundColor:e.color}}),(0,t.jsx)("p",{className:"text-xs font-medium truncate",children:e.name}),J===e.id&&(0,t.jsx)(j.Check,{className:"absolute top-2 right-2 h-4 w-4 text-primary"})]},e.id))})]}),(0,t.jsx)(n.Button,{onClick:eC,loading:G,children:"Save Company Settings"})]}),(0,t.jsxs)(c.TabsContent,{value:"estimating",className:"mt-6 space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Square Footage Rates"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set your default $/sqft rates for auto-pricing estimates."}),(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"wallsRate",children:"Interior Walls ($/sqft)"}),(0,t.jsx)(o.Input,{id:"wallsRate",type:"number",step:"0.01",min:"0",value:ee,onChange:e=>et(e.target.value),placeholder:"Suggested: 2.00"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"ceilingsRate",children:"Ceilings ($/sqft)"}),(0,t.jsx)(o.Input,{id:"ceilingsRate",type:"number",step:"0.01",min:"0",value:ea,onChange:e=>es(e.target.value),placeholder:"Suggested: 0.50"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"trimRate",children:"Trim & Doors ($/sqft)"}),(0,t.jsx)(o.Input,{id:"trimRate",type:"number",step:"0.01",min:"0",value:ei,onChange:e=>er(e.target.value),placeholder:"Suggested: 0.75"})]})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Labor Rate"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set your default hourly rate for labor estimates."}),(0,t.jsx)("div",{className:"max-w-xs",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"laborRate",children:"Labor Rate ($/hr)"}),(0,t.jsx)(o.Input,{id:"laborRate",type:"number",step:"0.01",min:"0",value:el,onChange:e=>en(e.target.value),placeholder:"Suggested: 50.00"})]})})]}),(0,t.jsx)(n.Button,{onClick:eL,loading:eo,children:"Save Settings"})]}),(0,t.jsx)(c.TabsContent,{value:"crew",className:"mt-6 space-y-6",children:(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)("h3",{className:"font-semibold",children:"Crew Members"})}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your crew members have access to jobs, estimates, and customer info. Everyone sees the same data."}),(0,t.jsx)("div",{className:"divide-y",children:L.map(e=>(0,t.jsxs)("div",{className:"py-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium",children:[e.fullName||e.email,e.id===R.owner_user_id&&(0,t.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Owner)"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.email})]}),h&&e.id!==_&&(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>eM(e.id),children:(0,t.jsx)(y.Trash2,{className:"h-4 w-4"})})]},e.id))})]})}),(0,t.jsx)(c.TabsContent,{value:"exports",className:"mt-6 space-y-6",children:(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Export Data"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Download your data for accounting or backup purposes."}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,t.jsxs)(n.Button,{variant:"outline",onClick:()=>eU(!0),children:[(0,t.jsx)(v,{className:"mr-2 h-4 w-4"}),"Export Jobs (CSV)"]}),(0,t.jsxs)(n.Button,{variant:"outline",onClick:eD,children:[(0,t.jsx)(v,{className:"mr-2 h-4 w-4"}),"Export Invoices (CSV)"]}),(0,t.jsxs)(n.Button,{variant:"outline",onClick:eE,children:[(0,t.jsx)(v,{className:"mr-2 h-4 w-4"}),"Export Payments (CSV)"]}),(0,t.jsxs)(n.Button,{variant:"outline",onClick:eF,children:[(0,t.jsx)(v,{className:"mr-2 h-4 w-4"}),"Export Customers (CSV)"]})]})]})}),(0,t.jsxs)(c.TabsContent,{value:"account",className:"mt-6 space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Account"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Email"}),(0,t.jsx)("p",{className:"font-medium",children:C})]}),(0,t.jsxs)(n.Button,{variant:"destructive",onClick:async()=>{await F.auth.signOut(),D.push("/login"),D.refresh()},className:"w-full sm:w-auto",children:[(0,t.jsx)(b,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]})]}),h&&(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Billing & Subscription"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage your subscription and billing information"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"rounded-lg border bg-muted/50 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Current Plan"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-primary",children:"Free Trial"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"You're currently on the free trial. Upgrade to unlock all features."})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Payment Method"}),(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"No payment method on file"}),(0,t.jsxs)(n.Button,{variant:"outline",disabled:!0,children:[(0,t.jsx)(w.CreditCard,{className:"mr-2 h-4 w-4"}),"Add Payment Method"]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Billing History"}),(0,t.jsx)("div",{className:"rounded-lg border p-4",children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No billing history available"})})]}),(0,t.jsx)("div",{className:"pt-4 border-t",children:(0,t.jsx)(n.Button,{variant:"outline",disabled:!0,className:"w-full sm:w-auto",children:"Upgrade Plan"})})]})]})]})]})}),(0,t.jsx)(m.Dialog,{open:eR,onOpenChange:eU,children:(0,t.jsxs)(m.DialogContent,{children:[(0,t.jsxs)(m.DialogHeader,{children:[(0,t.jsx)(m.DialogTitle,{children:"Export Jobs Data"}),(0,t.jsx)(m.DialogDescription,{children:"Export job and invoice data for accounting purposes. Select a date range to export."})]}),(0,t.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"startDate",children:"Start Date"}),(0,t.jsx)(o.Input,{id:"startDate",type:"date",value:eB,onChange:e=>eP(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"endDate",children:"End Date"}),(0,t.jsx)(o.Input,{id:"endDate",type:"date",value:e$,onChange:e=>eO(e.target.value)})]}),(0,t.jsxs)("div",{className:"rounded-lg bg-muted p-3 text-sm",children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"Export includes:"}),(0,t.jsxs)("ul",{className:"list-disc list-inside text-muted-foreground space-y-1",children:[(0,t.jsx)("li",{children:"Job details and status"}),(0,t.jsx)("li",{children:"Customer information"}),(0,t.jsx)("li",{children:"Invoice amounts and payment status"}),(0,t.jsx)("li",{children:"Payment dates"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,t.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>eU(!1),children:"Cancel"}),(0,t.jsxs)(n.Button,{onClick:eA,loading:eI,children:[(0,t.jsx)(v,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]})]})]})}),(0,t.jsx)(m.Dialog,{open:ec,onOpenChange:em,children:(0,t.jsxs)(m.DialogContent,{children:[(0,t.jsxs)(m.DialogHeader,{children:[(0,t.jsx)(m.DialogTitle,{children:eu?"Edit Location":"Add Pickup Location"}),(0,t.jsx)(m.DialogDescription,{children:"Add a Sherwin-Williams store or other pickup point."})]}),(0,t.jsxs)("form",{onSubmit:eT,className:"space-y-4 mt-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"locationName",children:"Name *"}),(0,t.jsx)(o.Input,{id:"locationName",placeholder:"e.g., Sherwin-Williams #1234",value:ep,onChange:e=>ex(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"locationAddress",children:"Street Address"}),(0,t.jsx)(o.Input,{id:"locationAddress",placeholder:"123 Main St",value:eg,onChange:e=>ef(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"locationCity",children:"City"}),(0,t.jsx)(o.Input,{id:"locationCity",value:ev,onChange:e=>ey(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"locationState",children:"State"}),(0,t.jsx)(o.Input,{id:"locationState",maxLength:2,value:ej,onChange:e=>eb(e.target.value.toUpperCase())})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"locationZip",children:"ZIP"}),(0,t.jsx)(o.Input,{id:"locationZip",value:ew,onChange:e=>eN(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,t.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>em(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{type:"submit",loading:ek,children:eu?"Save Changes":"Add Location"})]})]})]})})]})}e.s(["SettingsView",()=>_],708)}]);