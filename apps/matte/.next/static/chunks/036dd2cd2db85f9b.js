(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,42715,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(e,t,a){let r=Reflect.get(e,t,a);return"function"==typeof r?r.bind(e):r}static set(e,t,a,r){return Reflect.set(e,t,a,r)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},76361,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return o}});let r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=s(void 0);if(a&&a.has(e))return a.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var l=i?Object.getOwnPropertyDescriptor(e,n):null;l&&(l.get||l.set)?Object.defineProperty(r,n,l):r[n]=e[n]}return r.default=e,a&&a.set(e,r),r}(e.r(71645));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(s=function(e){return e?a:t})(e)}let i={current:null},n="function"==typeof r.cache?r.cache:e=>e,l=console.warn;function o(e){return function(...t){l(e(...t))}}n(e=>{try{l(i.current)}finally{i.current=null}})},83066,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"afterTaskAsyncStorageInstance",{enumerable:!0,get:function(){return r}});let r=(0,e.r(90317).createAsyncLocalStorage)()},41643,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"afterTaskAsyncStorage",{enumerable:!0,get:function(){return r.afterTaskAsyncStorageInstance}});let r=e.r(83066)},50999,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={isRequestAPICallableInsideAfter:function(){return c},throwForSearchParamsAccessInUseCache:function(){return o},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return l}};for(var s in r)Object.defineProperty(a,s,{enumerable:!0,get:r[s]});let i=e.r(43248),n=e.r(41643);function l(e,t){throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${e} with \`dynamic = "error"\` couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function o(e,t){let a=Object.defineProperty(Error(`Route ${e.route} used \`searchParams\` inside "use cache". Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await \`searchParams\` outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E842",enumerable:!1,configurable:!0});throw Error.captureStackTrace(a,t),e.invalidDynamicUsageError??=a,a}function c(){let e=n.afterTaskAsyncStorage.getStore();return(null==e?void 0:e.rootTaskSpawnPhase)==="action"}},42852,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r,s={RenderStage:function(){return o},StagedRenderingController:function(){return c}};for(var i in s)Object.defineProperty(a,i,{enumerable:!0,get:s[i]});let n=e.r(12718),l=e.r(39470);var o=((r={})[r.Before=1]="Before",r[r.Static=2]="Static",r[r.Runtime=3]="Runtime",r[r.Dynamic=4]="Dynamic",r[r.Abandoned=5]="Abandoned",r);class c{constructor(e=null,t){this.abortSignal=e,this.hasRuntimePrefetch=t,this.currentStage=1,this.staticInterruptReason=null,this.runtimeInterruptReason=null,this.staticStageEndTime=1/0,this.runtimeStageEndTime=1/0,this.runtimeStageListeners=[],this.dynamicStageListeners=[],this.runtimeStagePromise=(0,l.createPromiseWithResolvers)(),this.dynamicStagePromise=(0,l.createPromiseWithResolvers)(),this.mayAbandon=!1,e&&(e.addEventListener("abort",()=>{let{reason:t}=e;this.currentStage<3&&(this.runtimeStagePromise.promise.catch(d),this.runtimeStagePromise.reject(t)),(this.currentStage<4||5===this.currentStage)&&(this.dynamicStagePromise.promise.catch(d),this.dynamicStagePromise.reject(t))},{once:!0}),this.mayAbandon=!0)}onStage(e,t){if(this.currentStage>=e)t();else if(3===e)this.runtimeStageListeners.push(t);else if(4===e)this.dynamicStageListeners.push(t);else throw Object.defineProperty(new n.InvariantError(`Invalid render stage: ${e}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}canSyncInterrupt(){if(1===this.currentStage)return!1;let e=this.hasRuntimePrefetch?4:3;return this.currentStage<e}syncInterruptCurrentStageWithReason(e){if(1!==this.currentStage){if(this.mayAbandon)return this.abandonRenderImpl();switch(this.currentStage){case 2:this.staticInterruptReason=e,this.advanceStage(4);return;case 3:this.hasRuntimePrefetch&&(this.runtimeInterruptReason=e,this.advanceStage(4));return}}}getStaticInterruptReason(){return this.staticInterruptReason}getRuntimeInterruptReason(){return this.runtimeInterruptReason}getStaticStageEndTime(){return this.staticStageEndTime}getRuntimeStageEndTime(){return this.runtimeStageEndTime}abandonRender(){if(!this.mayAbandon)throw Object.defineProperty(new n.InvariantError("`abandonRender` called on a stage controller that cannot be abandoned."),"__NEXT_ERROR_CODE",{value:"E938",enumerable:!1,configurable:!0});this.abandonRenderImpl()}abandonRenderImpl(){let{currentStage:e}=this;switch(e){case 2:this.currentStage=5,this.resolveRuntimeStage();return;case 3:this.currentStage=5;return}}advanceStage(e){if(e<=this.currentStage)return;let t=this.currentStage;if(this.currentStage=e,t<3&&e>=3&&(this.staticStageEndTime=performance.now()+performance.timeOrigin,this.resolveRuntimeStage()),t<4&&e>=4){this.runtimeStageEndTime=performance.now()+performance.timeOrigin,this.resolveDynamicStage();return}}resolveRuntimeStage(){let e=this.runtimeStageListeners;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.runtimeStagePromise.resolve()}resolveDynamicStage(){let e=this.dynamicStageListeners;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.dynamicStagePromise.resolve()}getStagePromise(e){switch(e){case 3:return this.runtimeStagePromise.promise;case 4:return this.dynamicStagePromise.promise;default:throw Object.defineProperty(new n.InvariantError(`Invalid render stage: ${e}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}}waitForStage(e){return this.getStagePromise(e)}delayUntilStage(e,t,a){var r,s,i;let n,l=(r=this.getStagePromise(e),s=t,i=a,n=new Promise((e,t)=>{r.then(e.bind(null,i),t)}),void 0!==s&&(n.displayName=s),n);return this.abortSignal&&l.catch(d),l}}function d(){}},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},48137,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(87467);var r=e.i(55654);let s=a.createContext(void 0);function i(){let e=a.useContext(s);if(!e)throw Error("useTabs must be used within a Tabs");return e}function n({children:e,defaultValue:i,value:n,onValueChange:l,className:o}){let[c,d]=a.useState(i??"");return(0,t.jsx)(s.Provider,{value:{value:n??c,onValueChange:l??d},children:(0,t.jsx)("div",{className:(0,r.cn)("w-full",o),children:e})})}function l({children:e,className:a}){return(0,t.jsx)("div",{className:(0,r.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),children:e})}function o({children:e,value:a,className:s,disabled:n}){let{value:l,onValueChange:o}=i(),c=l===a;return(0,t.jsx)("button",{type:"button",role:"tab","aria-selected":c,disabled:n,className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",c&&"bg-background text-foreground shadow",s),onClick:()=>o(a),children:e})}function c({children:e,value:a,className:s}){let{value:n}=i();return n!==a?null:(0,t.jsx)("div",{role:"tabpanel",className:(0,r.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),children:e})}e.s(["Tabs",()=>n,"TabsContent",()=>c,"TabsList",()=>l,"TabsTrigger",()=>o])},61659,e=>{"use strict";let t=(0,e.i(75254).default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);e.s(["CreditCard",()=>t],61659)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},73708,e=>{"use strict";let t=(0,e.i(75254).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["Image",()=>t],73708)},61911,e=>{"use strict";let t=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>t],61911)},69074,e=>{"use strict";let t=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],69074)},708,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),s=e.i(68720),i=e.i(87467),n=e.i(55654),l=e.i(40574),o=e.i(34098),c=e.i(80720),d=e.i(48137),u=e.i(7003),m=e.i(69481),h=e.i(75254);let p=(0,h.default)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),g=(0,h.default)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),f=(0,h.default)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var x=e.i(61911);let y=(0,h.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var j=e.i(27612),b=e.i(43531);let v=(0,h.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var S=e.i(61659),w=e.i(69074),N=e.i(73708);function _({company:e,isOwner:h,currentUserId:_,currentUserEmail:k,config:C,teamMembers:R,inviteLinks:P,pickupLocations:E}){let T=(0,r.useRouter)(),{addToast:M}=(0,m.useToast)(),O=(0,s.createClient)(),[L,I]=(0,a.useState)(e),[D,F]=(0,a.useState)(C),[A,U]=(0,a.useState)(P),[q,B]=(0,a.useState)(E),[$,W]=(0,a.useState)("");(0,a.useEffect)(()=>{W(window.location.origin)},[]);let[V,z]=(0,a.useState)(L.name),[H,J]=(0,a.useState)(L.theme_id),[G,X]=(0,a.useState)(!1),[Z,Y]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(L.logo_url||null),[ee,et]=(0,a.useState)(D?.walls_rate_per_sqft?.toString()||""),[ea,er]=(0,a.useState)(D?.ceilings_rate_per_sqft?.toString()||""),[es,ei]=(0,a.useState)(D?.trim_rate_per_sqft?.toString()||""),[en,el]=(0,a.useState)(D?.labor_rate_per_hour?.toString()||""),[eo,ec]=(0,a.useState)(!1),[ed,eu]=(0,a.useState)(!1),[em,eh]=(0,a.useState)(null),[ep,eg]=(0,a.useState)(""),[ef,ex]=(0,a.useState)(""),[ey,ej]=(0,a.useState)(""),[eb,ev]=(0,a.useState)(""),[eS,ew]=(0,a.useState)(""),[eN,e_]=(0,a.useState)(!1);async function ek(){X(!0);try{let{error:e}=await O.from("companies").update({name:V.trim(),theme_id:H}).eq("id",L.id);if(e)throw e;I(e=>({...e,name:V.trim(),theme_id:H})),document.documentElement.setAttribute("data-theme",H),M("Company settings saved!","success"),T.refresh()}catch{M("Failed to save settings","error")}finally{X(!1)}}async function eC(e){let t=e.target.files?.[0];if(t){if(t.size>5242880)return void M("File too large (max 5MB)","error");if(!["image/jpeg","image/png","image/webp","image/svg+xml"].includes(t.type))return void M("Invalid file type. Allowed: JPEG, PNG, WebP, SVG","error");Y(!0);try{let e=new FormData;e.append("file",t);let a=await fetch(`/api/companies/${L.id}/logo`,{method:"POST",body:e}),r=await a.json();if(!a.ok)throw Error(r.error||"Failed to upload logo");Q(r.logo_url),I(e=>({...e,logo_url:r.logo_url})),M("Logo uploaded successfully!","success"),T.refresh()}catch(e){M(e instanceof Error?e.message:"Failed to upload logo","error")}finally{Y(!1),e.target.value=""}}}async function eR(){ec(!0);try{let e={company_id:L.id,updated_at:new Date().toISOString()};ee.trim()&&(e.walls_rate_per_sqft=parseFloat(ee)),ea.trim()&&(e.ceilings_rate_per_sqft=parseFloat(ea)),es.trim()&&(e.trim_rate_per_sqft=parseFloat(es)),en.trim()&&(e.labor_rate_per_hour=parseFloat(en));let{error:t}=await O.from("estimating_config").upsert(e,{onConflict:"company_id"});if(t)throw t;let{data:a}=await O.from("estimating_config").select("*").eq("company_id",L.id).single();a&&(F(a),et(a.walls_rate_per_sqft?.toString()||""),er(a.ceilings_rate_per_sqft?.toString()||""),ei(a.trim_rate_per_sqft?.toString()||""),el(a.labor_rate_per_hour?.toString()||"")),M("Estimating rates saved!","success")}catch{M("Failed to save rates","error")}finally{ec(!1)}}async function eP(e){if(e===_)return void M("You cannot remove yourself","error");if(!confirm("Remove this user from the company?"))return;let{error:t}=await O.from("company_users").delete().eq("user_id",e).eq("company_id",L.id);t?M("Failed to remove user","error"):(T.refresh(),M("User removed","success"))}async function eE(e){if(e.preventDefault(),ep.trim()){e_(!0);try{let e={company_id:L.id,name:ep.trim(),address1:ef||null,city:ey||null,state:eb||null,zip:eS||null};if(em){let{data:t,error:a}=await O.from("pickup_locations").update(e).eq("id",em.id).select().single();if(a)throw a;B(e=>e.map(e=>e.id===em.id?t:e))}else{let{data:t,error:a}=await O.from("pickup_locations").insert(e).select().single();if(a)throw a;B(e=>[...e,t].sort((e,t)=>e.name.localeCompare(t.name)))}eu(!1),M("Location saved!","success")}catch{M("Failed to save location","error")}finally{e_(!1)}}}async function eT(){try{let{data:e,error:t}=await O.from("invoices").select("*").eq("company_id",L.id).order("created_at",{ascending:!1});if(t)throw t;let a=[...new Set((e||[]).map(e=>e.customer_id).filter(e=>null!==e))],r=[...new Set((e||[]).map(e=>e.job_id).filter(e=>null!==e))],{data:s}=a.length>0?await O.from("customers").select("id, name").in("id",a):{data:[]},{data:i}=r.length>0?await O.from("jobs").select("id, title").in("id",r):{data:[]},n=new Map((s||[]).map(e=>[e.id,e.name])),l=new Map((i||[]).map(e=>[e.id,e.title])),o=["Date,Customer,Job,Amount,Status,Paid At",...(e||[]).map(e=>[e.created_at,`"${n.get(e.customer_id)||""}"`,`"${l.get(e.job_id)||""}"`,(e.amount_total/100).toFixed(2),e.status,e.paid_at||""].join(","))].join("\n"),c=new Blob([o],{type:"text/csv"}),d=URL.createObjectURL(c),u=document.createElement("a");u.href=d,u.download=`invoices-${new Date().toISOString().split("T")[0]}.csv`,u.click(),URL.revokeObjectURL(d),M("Invoices exported!","success")}catch{M("Failed to export","error")}}async function eM(){try{let{data:e}=await O.from("invoices").select("id").eq("company_id",L.id),t=e?.map(e=>e.id)||[],{data:a,error:r}=t.length>0?await O.from("invoice_payments").select("*").in("invoice_id",t).order("paid_at",{ascending:!1}):{data:[]};if(r)throw r;let{data:s}=t.length>0?await O.from("invoices").select("id, customer_id, job_id").in("id",t):{data:[]},i=[...new Set((s||[]).map(e=>e.customer_id).filter(e=>null!==e))],n=[...new Set((s||[]).map(e=>e.job_id).filter(e=>null!==e))],{data:l}=i.length>0?await O.from("customers").select("id, name").in("id",i):{data:[]},{data:o}=n.length>0?await O.from("jobs").select("id, title").in("id",n):{data:[]},c=new Map((s||[]).map(e=>[e.id,e])),d=new Map((l||[]).map(e=>[e.id,e.name])),u=new Map((o||[]).map(e=>[e.id,e.title])),m=["Date,Customer,Job,Amount,Payment Method",...(a||[]).map(e=>{let t=c.get(e.invoice_id),a=e.stripe_payment_intent_id?.startsWith("manual_")?e.stripe_payment_intent_id.split("_")[1]:"Stripe",r=t?.customer_id||"",s=t?.job_id||"";return[e.paid_at,`"${d.get(r)||""}"`,`"${u.get(s)||""}"`,(e.amount/100).toFixed(2),a].join(",")})].join("\n"),h=new Blob([m],{type:"text/csv"}),p=URL.createObjectURL(h),g=document.createElement("a");g.href=p,g.download=`payments-${new Date().toISOString().split("T")[0]}.csv`,g.click(),URL.revokeObjectURL(p),M("Payments exported!","success")}catch{M("Failed to export","error")}}async function eO(){try{let{data:e,error:t}=await O.from("customers").select("*").eq("company_id",L.id).order("name");if(t)throw t;let a=["Name,Phone,Email,Address,City,State,ZIP,Notes,Created At",...(e||[]).map(e=>[`"${e.name}"`,e.phone||"",e.email||"",`"${e.address1||""}"`,e.city||"",e.state||"",e.zip||"",`"${(e.notes||"").replace(/"/g,'""')}"`,e.created_at].join(","))].join("\n"),r=new Blob([a],{type:"text/csv"}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=`customers-${new Date().toISOString().split("T")[0]}.csv`,i.click(),URL.revokeObjectURL(s),M("Customers exported!","success")}catch{M("Failed to export","error")}}let[eL,eI]=(0,a.useState)(!1),[eD,eF]=(0,a.useState)(!1),[eA,eU]=(0,a.useState)(""),[eq,eB]=(0,a.useState)("");async function e$(){if(!eA||!eq)return void M("Please select both start and end dates","error");eF(!0);try{let{data:e,error:t}=await O.from("jobs").select(`
          *,
          customer:customers(name, phone, email, address1, city, state, zip)
        `).eq("company_id",L.id).gte("created_at",eA).lte("created_at",`${eq}T23:59:59`).order("created_at",{ascending:!1});if(t)throw t;let{data:a,error:r}=await O.from("invoices").select("*").eq("company_id",L.id).gte("created_at",eA).lte("created_at",`${eq}T23:59:59`).order("created_at",{ascending:!1});if(r)throw r;let s=["Date,Job Title,Customer Name,Customer Phone,Customer Email,Address,Job Status,Invoice Amount,Invoice Status,Payment Date",...(e||[]).map(e=>{let t=(a||[]).filter(t=>t.job_id===e.id),r=t.reduce((e,t)=>e+t.amount_total,0),s=t.filter(e=>"paid"===e.status),i=s.length>0?s[0].updated_at:"",l=e.customer,o=l?[l.address1,l.city,l.state,l.zip].filter(Boolean).join(", "):"";return[(0,n.formatDate)(e.created_at),`"${e.title.replace(/"/g,'""')}"`,l?`"${l.name.replace(/"/g,'""')}"`:"",l?.phone||"",l?.email||"",`"${o.replace(/"/g,'""')}"`,e.status,r.toFixed(2),t.length>0?t[0].status:"none",i?(0,n.formatDate)(i):""].join(",")})].join("\n"),i=new Blob([s],{type:"text/csv"}),l=URL.createObjectURL(i),o=document.createElement("a");o.href=l,o.download=`jobs-export-${eA}-to-${eq}.csv`,o.click(),URL.revokeObjectURL(l),M("Export complete!","success"),eI(!1)}catch(e){console.error("Export error:",e),M("Failed to export data","error")}finally{eF(!1)}}return(0,t.jsxs)("div",{className:"min-h-screen pb-20 lg:pb-0",children:[(0,t.jsx)("div",{className:"border-b bg-card p-4",children:(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Settings"})}),(0,t.jsx)("div",{className:"max-w-3xl mx-auto p-4",children:(0,t.jsxs)(d.Tabs,{defaultValue:"company",className:"w-full",children:[(0,t.jsxs)(d.TabsList,{className:"w-full justify-start overflow-x-auto scrollbar-hide flex-nowrap gap-1 -mx-4 px-4 lg:flex-wrap lg:overflow-x-visible",children:[(0,t.jsxs)(d.TabsTrigger,{value:"company",children:[(0,t.jsx)(p,{className:"mr-1.5 h-4 w-4"}),"Company"]}),(0,t.jsxs)(d.TabsTrigger,{value:"estimating",children:[(0,t.jsx)(f,{className:"mr-1.5 h-4 w-4"}),"Estimating"]}),(0,t.jsxs)(d.TabsTrigger,{value:"crew",children:[(0,t.jsx)(x.Users,{className:"mr-1.5 h-4 w-4"}),"Crew"]}),(0,t.jsxs)(d.TabsTrigger,{value:"exports",children:[(0,t.jsx)(y,{className:"mr-1.5 h-4 w-4"}),"Exports"]}),(0,t.jsxs)(d.TabsTrigger,{value:"account",children:[(0,t.jsx)(x.Users,{className:"mr-1.5 h-4 w-4"}),"Account"]})]}),(0,t.jsxs)(d.TabsContent,{value:"company",className:"mt-6 space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Company Details"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"companyName",children:"Company Name"}),(0,t.jsx)(o.Input,{id:"companyName",value:V,onChange:e=>z(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(N.Image,{className:"h-4 w-4"}),"Company Logo"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Upload your company logo to display on customer-facing pages (estimates, invoices, payment links)."}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[K?(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("img",{src:K,alt:"Company Logo",className:"w-20 h-20 rounded-lg object-cover border"})}):(0,t.jsx)("div",{className:"w-20 h-20 rounded-lg bg-muted border flex items-center justify-center",children:(0,t.jsx)(N.Image,{className:"h-8 w-8 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(c.Label,{htmlFor:"logoUpload",className:"cursor-pointer",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(w.Upload,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:K?"Change Logo":"Upload Logo"})]})}),(0,t.jsx)("input",{id:"logoUpload",type:"file",accept:"image/jpeg,image/png,image/webp,image/svg+xml",onChange:eC,disabled:Z,className:"hidden"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Max 5MB. Formats: JPEG, PNG, WebP, SVG"})]})]}),Z&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Uploading..."})]}),(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(g,{className:"h-4 w-4"}),"Theme"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose a Sherwin-Williams inspired color theme."}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3",children:i.THEMES.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>J(e.id),className:`relative rounded-lg border p-3 text-left transition-all ${H===e.id?"border-primary ring-2 ring-primary":"hover:border-muted-foreground"}`,children:[(0,t.jsx)("div",{className:"h-8 w-full rounded mb-2",style:{backgroundColor:e.color}}),(0,t.jsx)("p",{className:"text-xs font-medium truncate",children:e.name}),H===e.id&&(0,t.jsx)(b.Check,{className:"absolute top-2 right-2 h-4 w-4 text-primary"})]},e.id))})]}),(0,t.jsx)(l.Button,{onClick:ek,loading:G,children:"Save Company Settings"})]}),(0,t.jsxs)(d.TabsContent,{value:"estimating",className:"mt-6 space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Square Footage Rates"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set your default $/sqft rates for auto-pricing estimates."}),(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"wallsRate",children:"Interior Walls ($/sqft)"}),(0,t.jsx)(o.Input,{id:"wallsRate",type:"number",step:"0.01",min:"0",value:ee,onChange:e=>et(e.target.value),placeholder:"Suggested: 2.00"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"ceilingsRate",children:"Ceilings ($/sqft)"}),(0,t.jsx)(o.Input,{id:"ceilingsRate",type:"number",step:"0.01",min:"0",value:ea,onChange:e=>er(e.target.value),placeholder:"Suggested: 0.50"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"trimRate",children:"Trim & Doors ($/sqft)"}),(0,t.jsx)(o.Input,{id:"trimRate",type:"number",step:"0.01",min:"0",value:es,onChange:e=>ei(e.target.value),placeholder:"Suggested: 0.75"})]})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Labor Rate"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set your default hourly rate for labor estimates."}),(0,t.jsx)("div",{className:"max-w-xs",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"laborRate",children:"Labor Rate ($/hr)"}),(0,t.jsx)(o.Input,{id:"laborRate",type:"number",step:"0.01",min:"0",value:en,onChange:e=>el(e.target.value),placeholder:"Suggested: 50.00"})]})})]}),(0,t.jsx)(l.Button,{onClick:eR,loading:eo,children:"Save Settings"})]}),(0,t.jsx)(d.TabsContent,{value:"crew",className:"mt-6 space-y-6",children:(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)("h3",{className:"font-semibold",children:"Crew Members"})}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your crew members have access to jobs, estimates, and customer info. Everyone sees the same data."}),(0,t.jsx)("div",{className:"divide-y",children:R.map(e=>(0,t.jsxs)("div",{className:"py-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium",children:[e.fullName||e.email,e.id===L.owner_user_id&&(0,t.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Owner)"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.email})]}),h&&e.id!==_&&(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>eP(e.id),children:(0,t.jsx)(j.Trash2,{className:"h-4 w-4"})})]},e.id))})]})}),(0,t.jsx)(d.TabsContent,{value:"exports",className:"mt-6 space-y-6",children:(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Export Data"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Download your data for accounting or backup purposes."}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,t.jsxs)(l.Button,{variant:"outline",onClick:()=>eI(!0),children:[(0,t.jsx)(y,{className:"mr-2 h-4 w-4"}),"Export Jobs (CSV)"]}),(0,t.jsxs)(l.Button,{variant:"outline",onClick:eT,children:[(0,t.jsx)(y,{className:"mr-2 h-4 w-4"}),"Export Invoices (CSV)"]}),(0,t.jsxs)(l.Button,{variant:"outline",onClick:eM,children:[(0,t.jsx)(y,{className:"mr-2 h-4 w-4"}),"Export Payments (CSV)"]}),(0,t.jsxs)(l.Button,{variant:"outline",onClick:eO,children:[(0,t.jsx)(y,{className:"mr-2 h-4 w-4"}),"Export Customers (CSV)"]})]})]})}),(0,t.jsxs)(d.TabsContent,{value:"account",className:"mt-6 space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Account"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Email"}),(0,t.jsx)("p",{className:"font-medium",children:k})]}),(0,t.jsxs)(l.Button,{variant:"destructive",onClick:async()=>{await O.auth.signOut(),T.push("/login"),T.refresh()},className:"w-full sm:w-auto",children:[(0,t.jsx)(v,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]})]}),h&&(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Billing & Subscription"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage your subscription and billing information"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"rounded-lg border bg-muted/50 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Current Plan"}),(0,t.jsx)("span",{className:"text-sm font-semibold text-primary",children:"Free Trial"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"You're currently on the free trial. Upgrade to unlock all features."})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Payment Method"}),(0,t.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"No payment method on file"}),(0,t.jsxs)(l.Button,{variant:"outline",disabled:!0,children:[(0,t.jsx)(S.CreditCard,{className:"mr-2 h-4 w-4"}),"Add Payment Method"]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Billing History"}),(0,t.jsx)("div",{className:"rounded-lg border p-4",children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No billing history available"})})]}),(0,t.jsx)("div",{className:"pt-4 border-t",children:(0,t.jsx)(l.Button,{variant:"outline",disabled:!0,className:"w-full sm:w-auto",children:"Upgrade Plan"})})]})]})]})]})}),(0,t.jsx)(u.Dialog,{open:eL,onOpenChange:eI,children:(0,t.jsxs)(u.DialogContent,{children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{children:"Export Jobs Data"}),(0,t.jsx)(u.DialogDescription,{children:"Export job and invoice data for accounting purposes. Select a date range to export."})]}),(0,t.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"startDate",children:"Start Date"}),(0,t.jsx)(o.Input,{id:"startDate",type:"date",value:eA,onChange:e=>eU(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"endDate",children:"End Date"}),(0,t.jsx)(o.Input,{id:"endDate",type:"date",value:eq,onChange:e=>eB(e.target.value)})]}),(0,t.jsxs)("div",{className:"rounded-lg bg-muted p-3 text-sm",children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"Export includes:"}),(0,t.jsxs)("ul",{className:"list-disc list-inside text-muted-foreground space-y-1",children:[(0,t.jsx)("li",{children:"Job details and status"}),(0,t.jsx)("li",{children:"Customer information"}),(0,t.jsx)("li",{children:"Invoice amounts and payment status"}),(0,t.jsx)("li",{children:"Payment dates"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,t.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>eI(!1),children:"Cancel"}),(0,t.jsxs)(l.Button,{onClick:e$,loading:eD,children:[(0,t.jsx)(y,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]})]})]})}),(0,t.jsx)(u.Dialog,{open:ed,onOpenChange:eu,children:(0,t.jsxs)(u.DialogContent,{children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{children:em?"Edit Location":"Add Pickup Location"}),(0,t.jsx)(u.DialogDescription,{children:"Add a Sherwin-Williams store or other pickup point."})]}),(0,t.jsxs)("form",{onSubmit:eE,className:"space-y-4 mt-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"locationName",children:"Name *"}),(0,t.jsx)(o.Input,{id:"locationName",placeholder:"e.g., Sherwin-Williams #1234",value:ep,onChange:e=>eg(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"locationAddress",children:"Street Address"}),(0,t.jsx)(o.Input,{id:"locationAddress",placeholder:"123 Main St",value:ef,onChange:e=>ex(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"locationCity",children:"City"}),(0,t.jsx)(o.Input,{id:"locationCity",value:ey,onChange:e=>ej(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"locationState",children:"State"}),(0,t.jsx)(o.Input,{id:"locationState",maxLength:2,value:eb,onChange:e=>ev(e.target.value.toUpperCase())})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"locationZip",children:"ZIP"}),(0,t.jsx)(o.Input,{id:"locationZip",value:eS,onChange:e=>ew(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,t.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>eu(!1),children:"Cancel"}),(0,t.jsx)(l.Button,{type:"submit",loading:eN,children:em?"Save Changes":"Add Location"})]})]})]})})]})}e.s(["SettingsView",()=>_],708)}]);