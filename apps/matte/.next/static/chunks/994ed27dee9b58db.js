(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,34098,e=>{"use strict";var s=e.i(43476),t=e.i(71645);e.i(87467);var a=e.i(55654);let r=t.forwardRef(({className:e,type:t,error:r,...i},n)=>(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("input",{type:t,className:(0,a.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r&&"border-destructive focus-visible:ring-destructive",e),ref:n,...i}),r&&(0,s.jsx)("p",{className:"mt-1 text-xs text-destructive",children:r})]}));r.displayName="Input",e.s(["Input",()=>r])},40574,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(25913);e.i(87467);var r=e.i(55654),i=e.i(31278);let n=(0,a.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:opacity-90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-muted hover:text-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-muted hover:text-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground shadow-sm hover:bg-success/90"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=t.forwardRef(({className:e,variant:t,size:a,loading:l,children:d,disabled:c,...o},u)=>(0,s.jsxs)("button",{className:(0,r.cn)(n({variant:t,size:a,className:e})),ref:u,disabled:c||l,...o,children:[l&&(0,s.jsx)(i.Loader2,{className:"animate-spin"}),d]}));l.displayName="Button",e.s(["Button",()=>l])},25913,e=>{"use strict";var s=e.i(7670);let t=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,a=s.clsx;e.s(["cva",0,(e,s)=>r=>{var i;if((null==s?void 0:s.variants)==null)return a(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:n,defaultVariants:l}=s,d=Object.keys(n).map(e=>{let s=null==r?void 0:r[e],a=null==l?void 0:l[e];if(null===s)return null;let i=t(s)||t(a);return n[e][i]}),c=r&&Object.entries(r).reduce((e,s)=>{let[t,a]=s;return void 0===a||(e[t]=a),e},{});return a(e,d,null==s||null==(i=s.compoundVariants)?void 0:i.reduce((e,s)=>{let{class:t,className:a,...r}=s;return Object.entries(r).every(e=>{let[s,t]=e;return Array.isArray(t)?t.includes({...l,...c}[s]):({...l,...c})[s]===t})?[...e,t,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}])},31278,e=>{"use strict";let s=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>s],31278)},80720,e=>{"use strict";var s=e.i(43476),t=e.i(71645);e.i(87467);var a=e.i(55654);let r=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("label",{ref:r,className:(0,a.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...t}));r.displayName="Label",e.s(["Label",()=>r])},71689,e=>{"use strict";let s=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],71689)},3116,e=>{"use strict";let s=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>s],3116)},63727,e=>{"use strict";let s=(0,e.i(75254).default)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);e.s(["Briefcase",()=>s],63727)},43432,e=>{"use strict";let s=(0,e.i(75254).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>s],43432)},63488,e=>{"use strict";let s=(0,e.i(75254).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>s],63488)},48137,e=>{"use strict";var s=e.i(43476),t=e.i(71645);e.i(87467);var a=e.i(55654);let r=t.createContext(void 0);function i(){let e=t.useContext(r);if(!e)throw Error("useTabs must be used within a Tabs");return e}function n({children:e,defaultValue:i,value:n,onValueChange:l,className:d}){let[c,o]=t.useState(i??"");return(0,s.jsx)(r.Provider,{value:{value:n??c,onValueChange:l??o},children:(0,s.jsx)("div",{className:(0,a.cn)("w-full",d),children:e})})}function l({children:e,className:t}){return(0,s.jsx)("div",{className:(0,a.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),children:e})}function d({children:e,value:t,className:r,disabled:n}){let{value:l,onValueChange:d}=i(),c=l===t;return(0,s.jsx)("button",{type:"button",role:"tab","aria-selected":c,disabled:n,className:(0,a.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",c&&"bg-background text-foreground shadow",r),onClick:()=>d(t),children:e})}function c({children:e,value:t,className:r}){let{value:n}=i();return n!==t?null:(0,s.jsx)("div",{role:"tabpanel",className:(0,a.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),children:e})}e.s(["Tabs",()=>n,"TabsContent",()=>c,"TabsList",()=>l,"TabsTrigger",()=>d])},27612,e=>{"use strict";let s=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>s],27612)},63876,e=>{"use strict";var s=e.i(43476),t=e.i(71645);e.i(87467);var a=e.i(55654);let r=t.forwardRef(({className:e,error:t,...r},i)=>(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("textarea",{className:(0,a.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t&&"border-destructive focus-visible:ring-destructive",e),ref:i,...r}),t&&(0,s.jsx)("p",{className:"mt-1 text-xs text-destructive",children:t})]}));r.displayName="Textarea",e.s(["Textarea",()=>r])},7233,e=>{"use strict";let s=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],7233)},88699,e=>{"use strict";let s=(0,e.i(75254).default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>s],88699)},12426,e=>{"use strict";let s=(0,e.i(75254).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>s],12426)},95613,e=>{"use strict";var s=e.i(43476),t=e.i(25913);e.i(87467);var a=e.i(55654);let r=(0,t.cva)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow",success:"border-transparent bg-success text-success-foreground shadow",warning:"border-transparent bg-warning text-warning-foreground shadow",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:t,...i}){return(0,s.jsx)("div",{className:(0,a.cn)(r({variant:t}),e),...i})}e.s(["Badge",()=>i])},46897,e=>{"use strict";let s=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>s],46897)},84614,e=>{"use strict";let s=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>s],84614)},78583,e=>{"use strict";let s=(0,e.i(75254).default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>s],78583)},29732,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(22016),r=e.i(18566),i=e.i(26293);e.i(87467);var n=e.i(55654),l=e.i(40574),d=e.i(34098),c=e.i(80720),o=e.i(63876),u=e.i(95613),m=e.i(48137),h=e.i(69481);let x=t.createContext(void 0);function p(){let e=t.useContext(x);if(!e)throw Error("useDropdownMenu must be used within a DropdownMenu");return e}function f({children:e}){let[a,r]=t.useState(!1);return(0,s.jsx)(x.Provider,{value:{open:a,setOpen:r},children:(0,s.jsx)("div",{className:"relative inline-block",children:e})})}function g({children:e,asChild:a,className:r}){let{open:i,setOpen:n}=p();return a&&t.isValidElement(e)?t.cloneElement(e,{onClick:()=>n(!i)}):(0,s.jsx)("button",{type:"button",className:r,onClick:()=>n(!i),children:e})}function v({children:e,className:a,align:r="end",sideOffset:i=4}){let{open:l,setOpen:d}=p(),c=t.useRef(null);return(t.useEffect(()=>{let e=e=>{c.current&&!c.current.contains(e.target)&&d(!1)};if(l&&(document.addEventListener("mousedown",e),c.current)){let e=c.current.getBoundingClientRect(),s=window.innerHeight,t=window.innerWidth;e.bottom>s&&(c.current.style.top="auto",c.current.style.bottom="100%",c.current.style.marginBottom=`${i}px`,c.current.style.marginTop="0"),e.right>t&&"end"===r&&(c.current.style.right="0",c.current.style.left="auto"),e.left<0&&"start"===r&&(c.current.style.left="0",c.current.style.right="auto")}return()=>{document.removeEventListener("mousedown",e)}},[l,d,r,i]),l)?(0,s.jsx)("div",{ref:c,className:(0,n.cn)("absolute z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-fade-in","start"===r&&"left-0","center"===r&&"left-1/2 -translate-x-1/2","end"===r&&"right-0","top-full",a),style:{marginTop:`${i}px`},children:e}):null}function j({children:e,className:t,onClick:a,destructive:r,disabled:i}){let{setOpen:l}=p();return(0,s.jsx)("button",{type:"button",disabled:i,className:(0,n.cn)("relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground disabled:pointer-events-none disabled:opacity-50",r&&"text-destructive hover:bg-destructive/10 focus:bg-destructive/10",t),onClick:()=>{a?.(),l(!1)},children:e})}function y({children:e,className:t}){return(0,s.jsx)("div",{className:(0,n.cn)("px-2 py-1.5 text-sm font-semibold",t),children:e})}var b=e.i(71689),N=e.i(43432),w=e.i(63488),k=e.i(46897),_=e.i(84614),T=e.i(63727);let C=(0,e.i(75254).default)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var M=e.i(78583),P=e.i(88699),S=e.i(27612),B=e.i(3116),L=e.i(12426),z=e.i(69638),D=e.i(87316),$=e.i(7233);let A=["good_payer","repeat_customer","referral","vip","needs_followup"],I={good_payer:{label:"Good Payer",variant:"success",icon:"âœ“"},repeat_customer:{label:"Repeat Customer",variant:"default",icon:"â†»"},referral:{label:"Referral",variant:"secondary",icon:"ðŸ‘¥"},vip:{label:"VIP",variant:"outline",icon:"â­"},needs_followup:{label:"Needs Follow-up",variant:"secondary",icon:"!"}};function q({customer:e,jobs:x,invoices:p,jobNotes:q=[],companyId:E}){let F=(0,r.useRouter)(),{addToast:R}=(0,h.useToast)(),V=(0,i.createClient)(),[H,O]=(0,t.useState)(e),[U,J]=(0,t.useState)(!1),[K,Z]=(0,t.useState)(!1),[G,W]=(0,t.useState)([]),[Q,X]=(0,t.useState)(!0),[Y,ee]=(0,t.useState)(H.name),[es,et]=(0,t.useState)(H.phone||""),[ea,er]=(0,t.useState)(H.email||""),[ei,en]=(0,t.useState)(H.address1||""),[el,ed]=(0,t.useState)(H.city||""),[ec,eo]=(0,t.useState)(H.state||""),[eu,em]=(0,t.useState)(H.zip||""),[eh,ex]=(0,t.useState)(H.notes||"");async function ep(e){if(G.length>=5)return void R("Maximum tags reached","error");try{let{error:s}=await V.from("customer_tags").insert({customer_id:H.id,company_id:E,tag:e});if(s&&"23505"!==s.code)throw s;W([...G,e]),R("Tag added","success")}catch(e){console.error("Error adding tag:",e),R("Failed to add tag","error")}}async function ef(e){try{let{error:s}=await V.from("customer_tags").delete().eq("customer_id",H.id).eq("company_id",E).eq("tag",e);if(s)throw s;W(G.filter(s=>s!==e)),R("Tag removed","success")}catch(e){console.error("Error removing tag:",e),R("Failed to remove tag","error")}}(0,t.useEffect)(()=>{!async function(){let{data:e}=await V.from("customer_tags").select("tag").eq("customer_id",H.id).eq("company_id",E);e&&W(e.map(e=>e.tag)),X(!1)}()},[H.id,E,V]);let eg=[H.address1,H.city,H.state,H.zip].filter(Boolean).join(", "),ev=p.filter(e=>"paid"===e.status).reduce((e,s)=>e+s.amount_total,0),ej=x.filter(e=>"paid"===e.payment_state&&e.payment_amount).reduce((e,s)=>e+(s.payment_amount||0),0),ey=p.reduce((e,s)=>e+s.amount_total,0),eb=x.filter(e=>e.payment_amount&&e.payment_amount>0).reduce((e,s)=>e+(s.payment_amount||0),0),eN=p.filter(e=>"paid"!==e.status).reduce((e,s)=>e+s.amount_total,0)+x.filter(e=>e.payment_amount&&e.payment_amount>0&&"paid"!==e.payment_state).reduce((e,s)=>e+(s.payment_amount||0),0),ew=[...p.filter(e=>"paid"===e.status&&e.paid_at).map(e=>{let s=new Date(e.created_at),t=Math.round((new Date(e.paid_at).getTime()-s.getTime())/864e5);return{id:e.id,amount:e.amount_total,paidAt:e.paid_at,daysToPay:Math.max(0,t),type:"invoice"}}),...x.filter(e=>"paid"===e.payment_state&&e.payment_paid_at&&e.payment_amount).map(e=>{let s=new Date(e.created_at),t=Math.round((new Date(e.payment_paid_at).getTime()-s.getTime())/864e5);return{id:e.id,amount:e.payment_amount,paidAt:e.payment_paid_at,daysToPay:Math.max(0,t),type:"job"}})].filter(e=>e.daysToPay>=0).sort((e,s)=>new Date(s.paidAt).getTime()-new Date(e.paidAt).getTime()),ek=ew.length>0?Math.round(ew.reduce((e,s)=>e+s.daysToPay,0)/ew.length):null,e_=[...p.map(e=>({id:e.id,type:"invoice",amount:e.amount_total,status:e.status,created_at:e.created_at,title:`Invoice #${e.id.slice(0,8)}`})),...x.filter(e=>e.payment_amount&&e.payment_amount>0).map(e=>({id:e.id,type:"job",amount:e.payment_amount,status:"paid"===e.payment_state?"paid":"sent"===e.payment_state?"sent":"draft",created_at:e.created_at,title:e.title,jobTitle:e.title}))].sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime()),eT=[...x.map(e=>({type:"job",date:e.created_at,title:e.title,status:e.status,id:e.id})),...p.map(e=>({type:"invoice",date:e.created_at,title:`Invoice - ${(0,n.formatCurrency)(e.amount_total)}`,status:e.status,id:e.id}))].sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime());async function eC(){if(!Y.trim())return void R("Name is required","error");Z(!0);try{let{error:e}=await V.from("customers").update({name:Y.trim(),phone:es||null,email:ea||null,address1:ei||null,city:el||null,state:ec||null,zip:eu||null,notes:eh||null}).eq("id",H.id);if(e)throw e;O(e=>({...e,name:Y.trim(),phone:es||null,email:ea||null,address1:ei||null,city:el||null,state:ec||null,zip:eu||null,notes:eh||null})),J(!1),R("Customer updated!","success")}catch{R("Failed to update customer","error")}finally{Z(!1)}}async function eM(){if(!confirm("Delete this customer? This cannot be undone."))return;let{error:e}=await V.from("customers").delete().eq("id",H.id);e?R("Failed to delete customer","error"):(R("Customer deleted","success"),F.push("/app/customers"))}return(0,s.jsxs)("div",{className:"min-h-screen pb-20 lg:pb-0",children:[(0,s.jsx)("div",{className:"border-b bg-card",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-4",children:[(0,s.jsxs)("button",{onClick:()=>F.back(),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-4",children:[(0,s.jsx)(b.ArrowLeft,{className:"h-4 w-4"}),"Back"]}),(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 min-w-0",children:[(0,s.jsx)("div",{className:"w-14 h-14 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:(0,s.jsx)(_.User,{className:"h-7 w-7 text-primary"})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold truncate",children:H.name}),(0,s.jsxs)("p",{className:"text-muted-foreground text-sm",children:["Customer since ",(0,n.formatDate)(H.created_at)]}),!Q&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 items-center mt-2",children:[G.map(e=>{let t=I[e];return t?(0,s.jsxs)(u.Badge,{variant:t.variant,className:"cursor-pointer",onClick:()=>{confirm(`Remove "${t.label}" tag?`)&&ef(e)},children:[t.icon," ",t.label]},e):null}),G.length<5&&(0,s.jsxs)(f,{children:[(0,s.jsx)(g,{asChild:!0,children:(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"h-6",children:[(0,s.jsx)($.Plus,{className:"mr-1 h-3 w-3"}),"Add Tag"]})}),(0,s.jsxs)(v,{children:[(0,s.jsx)(y,{children:"Select Tag"}),A.filter(e=>!G.includes(e)).map(e=>{let t=I[e];return(0,s.jsxs)(j,{onClick:()=>ep(e),children:[t.icon," ",t.label]},e)})]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(a.default,{href:`/app/jobs/new?customerId=${H.id}`,children:(0,s.jsxs)(l.Button,{size:"sm",children:[(0,s.jsx)($.Plus,{className:"mr-2 h-4 w-4"}),"Add Job"]})}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>J(!U),children:[(0,s.jsx)(P.Pencil,{className:"mr-2 h-4 w-4"}),U?"Cancel":"Edit"]}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:eM,className:"text-destructive hover:text-destructive",children:(0,s.jsx)(S.Trash2,{className:"h-4 w-4"})})]})]})]})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto p-4",children:(0,s.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,s.jsx)("div",{className:"lg:col-span-2 space-y-6 min-w-0",children:U?(0,s.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4 overflow-hidden",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Edit Customer"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"name",children:"Name *"}),(0,s.jsx)(d.Input,{id:"name",value:Y,onChange:e=>ee(e.target.value),required:!0,className:"w-full"})]}),(0,s.jsxs)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2 min-w-0",children:[(0,s.jsx)(c.Label,{htmlFor:"phone",children:"Phone"}),(0,s.jsx)(d.Input,{id:"phone",type:"tel",value:es,onChange:e=>et(e.target.value),className:"w-full"})]}),(0,s.jsxs)("div",{className:"space-y-2 min-w-0",children:[(0,s.jsx)(c.Label,{htmlFor:"email",children:"Email"}),(0,s.jsx)(d.Input,{id:"email",type:"email",value:ea,onChange:e=>er(e.target.value),className:"w-full"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"address1",children:"Street Address"}),(0,s.jsx)(d.Input,{id:"address1",value:ei,onChange:e=>en(e.target.value),className:"w-full"})]}),(0,s.jsxs)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2 min-w-0",children:[(0,s.jsx)(c.Label,{htmlFor:"city",children:"City"}),(0,s.jsx)(d.Input,{id:"city",value:el,onChange:e=>ed(e.target.value),className:"w-full"})]}),(0,s.jsxs)("div",{className:"space-y-2 min-w-0",children:[(0,s.jsx)(c.Label,{htmlFor:"state",children:"State"}),(0,s.jsx)(d.Input,{id:"state",maxLength:2,value:ec,onChange:e=>eo(e.target.value.toUpperCase()),className:"w-full"})]}),(0,s.jsxs)("div",{className:"space-y-2 min-w-0",children:[(0,s.jsx)(c.Label,{htmlFor:"zip",children:"ZIP"}),(0,s.jsx)(d.Input,{id:"zip",value:eu,onChange:e=>em(e.target.value),className:"w-full"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(o.Textarea,{id:"notes",rows:3,value:eh,onChange:e=>ex(e.target.value),placeholder:"Internal notes about this customer...",className:"w-full"})]}),(0,s.jsx)(l.Button,{onClick:eC,loading:K,className:"w-full sm:w-auto",children:"Save Changes"})]})]}):(0,s.jsxs)(m.Tabs,{defaultValue:"timeline",className:"w-full",children:[(0,s.jsxs)(m.TabsList,{className:"w-full justify-start overflow-x-auto scrollbar-hide -mx-4 px-4",children:[(0,s.jsxs)(m.TabsTrigger,{value:"timeline",className:"shrink-0",children:[(0,s.jsx)(B.Clock,{className:"mr-1.5 h-4 w-4 shrink-0"}),(0,s.jsx)("span",{className:"whitespace-nowrap",children:"Timeline"})]}),(0,s.jsxs)(m.TabsTrigger,{value:"jobs",className:"shrink-0",children:[(0,s.jsx)(T.Briefcase,{className:"mr-1.5 h-4 w-4 shrink-0"}),(0,s.jsxs)("span",{className:"whitespace-nowrap",children:["Jobs (",x.length,")"]})]}),(0,s.jsxs)(m.TabsTrigger,{value:"invoices",className:"shrink-0",children:[(0,s.jsx)(C,{className:"mr-1.5 h-4 w-4 shrink-0"}),(0,s.jsxs)("span",{className:"whitespace-nowrap",children:["Payments (",e_.length,")"]})]}),(0,s.jsxs)(m.TabsTrigger,{value:"notes",className:"shrink-0",children:[(0,s.jsx)(M.FileText,{className:"mr-1.5 h-4 w-4 shrink-0"}),(0,s.jsx)("span",{className:"whitespace-nowrap",children:"Notes"})]})]}),(0,s.jsx)(m.TabsContent,{value:"timeline",className:"space-y-4",children:0===eT.length?(0,s.jsxs)("div",{className:"rounded-lg border bg-card p-8 text-center text-muted-foreground",children:[(0,s.jsx)(B.Clock,{className:"mx-auto h-8 w-8 mb-2"}),(0,s.jsx)("p",{children:"No activity yet"})]}):(0,s.jsx)("div",{className:"rounded-lg border bg-card",children:eT.map((e,t)=>(0,s.jsx)(a.default,{href:`/app/${"job"===e.type?"jobs":"invoices"}/${e.id}`,className:"block p-4 hover:bg-muted/50 transition-colors border-b last:border-b-0",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-muted flex items-center justify-center shrink-0",children:"job"===e.type?(0,s.jsx)(T.Briefcase,{className:"h-5 w-5 text-primary"}):(0,s.jsx)(C,{className:"h-5 w-5 text-success"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsx)("p",{className:"font-medium truncate",children:e.title}),(0,s.jsx)(u.Badge,{variant:"paid"===e.status||"done"===e.status?"success":"in_progress"===e.status||"scheduled"===e.status?"secondary":"outline",children:e.status})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-1",children:[(0,s.jsx)(D.Calendar,{className:"h-3 w-3"}),(0,n.formatDate)(e.date)]})]})]})},`${e.type}-${e.id}`))})}),(0,s.jsx)(m.TabsContent,{value:"jobs",className:"space-y-4",children:0===x.length?(0,s.jsxs)("div",{className:"rounded-lg border bg-card p-8 text-center text-muted-foreground",children:[(0,s.jsx)(T.Briefcase,{className:"mx-auto h-8 w-8 mb-2"}),(0,s.jsx)("p",{children:"No jobs yet"})]}):(0,s.jsx)("div",{className:"rounded-lg border bg-card divide-y",children:x.map(e=>(0,s.jsx)(a.default,{href:`/app/jobs/${e.id}`,className:"block p-4 hover:bg-muted/50 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,n.formatDate)(e.created_at)})]}),(0,s.jsx)(u.Badge,{className:n.JOB_STATUS_COLORS[e.status],children:n.JOB_STATUS_LABELS[e.status]})]})},e.id))})}),(0,s.jsx)(m.TabsContent,{value:"invoices",className:"space-y-4",children:0===e_.length?(0,s.jsxs)("div",{className:"rounded-lg border bg-card p-8 text-center text-muted-foreground",children:[(0,s.jsx)(C,{className:"mx-auto h-8 w-8 mb-2"}),(0,s.jsx)("p",{children:"No invoices or payments yet"})]}):(0,s.jsx)("div",{className:"rounded-lg border bg-card divide-y",children:e_.map(e=>(0,s.jsx)(a.default,{href:"invoice"===e.type?`/app/invoices/${e.id}`:`/app/jobs/${e.id}`,className:"block p-4 hover:bg-muted/50 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:(0,n.formatCurrency)(e.amount)}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["job"===e.type&&e.jobTitle?e.jobTitle:e.title," â€¢ ",(0,n.formatDate)(e.created_at)]})]}),(0,s.jsx)(u.Badge,{variant:"paid"===e.status?"success":"sent"===e.status?"secondary":"outline",children:e.status})]})},`${e.type}-${e.id}`))})}),(0,s.jsxs)(m.TabsContent,{value:"notes",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,s.jsx)("h4",{className:"font-semibold text-sm mb-2",children:"Customer Notes"}),H.notes?(0,s.jsx)("p",{className:"whitespace-pre-wrap text-sm",children:H.notes}):(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"No customer notes yet. Click Edit to add notes."})]}),q.length>0&&(0,s.jsxs)("div",{className:"rounded-lg border bg-card",children:[(0,s.jsx)("div",{className:"p-4 border-b",children:(0,s.jsxs)("h4",{className:"font-semibold text-sm",children:["Job Notes (",q.length,")"]})}),(0,s.jsx)("div",{className:"divide-y",children:q.map(e=>(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:e.job.title}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground shrink-0",children:(0,n.formatDate)(e.created_at)})]}),(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.note})]},e.id))})]})]})]})}),(0,s.jsxs)("div",{className:"space-y-4 min-w-0",children:[(0,s.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Contact Info"}),H.phone&&(0,s.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,s.jsx)(N.Phone,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,s.jsx)("a",{href:`tel:${H.phone}`,className:"text-sm hover:underline truncate",children:(0,n.formatPhone)(H.phone)})]}),H.email&&(0,s.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,s.jsx)(w.Mail,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,s.jsx)("a",{href:`mailto:${H.email}`,className:"text-sm hover:underline truncate",children:H.email})]}),eg&&(0,s.jsxs)("div",{className:"flex items-start gap-3 min-w-0",children:[(0,s.jsx)(k.MapPin,{className:"h-4 w-4 text-muted-foreground shrink-0 mt-0.5"}),(0,s.jsx)("span",{className:"text-sm break-words min-w-0",children:eg})]}),!H.phone&&!H.email&&!eg&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No contact info added"})]}),(0,s.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Summary"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center shrink-0",children:(0,s.jsx)(T.Briefcase,{className:"h-4 w-4 text-primary"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Jobs"}),(0,s.jsx)("p",{className:"font-semibold",children:x.length})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/10 flex items-center justify-center shrink-0",children:(0,s.jsx)(C,{className:"h-4 w-4 text-blue-600"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Invoiced"}),(0,s.jsx)("p",{className:"font-semibold",children:(0,n.formatCurrency)(ey+eb)})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-lg bg-success/10 flex items-center justify-center shrink-0",children:(0,s.jsx)(z.CheckCircle,{className:"h-4 w-4 text-success"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Paid"}),(0,s.jsx)("p",{className:"font-semibold text-success",children:(0,n.formatCurrency)(ev+ej)})]})]}),eN>0&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-lg bg-warning/10 flex items-center justify-center shrink-0",children:(0,s.jsx)(L.DollarSign,{className:"h-4 w-4 text-warning"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Pending"}),(0,s.jsx)("p",{className:"font-semibold text-warning",children:(0,n.formatCurrency)(eN)})]})]})]})]}),ew.length>0&&(0,s.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Payment History"}),null!==ek&&(0,s.jsx)(u.Badge,{variant:ek||0===ek?ek<7?"success":ek<14||ek<30?"secondary":"warning":"outline",className:"text-xs",children:ek||0===ek?1===ew.length?`Paid last invoice in ${ew[0].daysToPay} days`:ek<7?"Usually pays within a week âœ…":ek<14?"Usually pays within 2 weeks":ek<30?`Average ${ek} days`:`Slow payer: ${ek} days âš ï¸`:null})]}),ew.length<5&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Based on ",ew.length," invoice",1!==ew.length?"s":""," â€¢ Limited data"]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"text-xs font-medium text-muted-foreground grid grid-cols-3 gap-2 pb-1 border-b",children:[(0,s.jsx)("span",{children:"Invoice"}),(0,s.jsx)("span",{children:"Paid"}),(0,s.jsx)("span",{className:"text-right",children:"Days"})]}),ew.slice(0,5).map(e=>(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,s.jsx)("span",{className:"font-medium truncate",children:(0,n.formatCurrency)(e.amount)}),(0,s.jsx)("span",{className:"text-muted-foreground truncate",children:(0,n.formatDate)(e.paidAt)}),(0,s.jsxs)("span",{className:(0,n.cn)("text-right font-medium",e.daysToPay<7?"text-success":e.daysToPay<30?"text-foreground":"text-warning"),children:[e.daysToPay,"d"]})]},`${e.type}-${e.id}`))]})]})]})]})})]})}e.s(["CustomerDetailView",()=>q],29732)}]);