(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,42715,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReflectAdapter",{enumerable:!0,get:function(){return n}});class n{static get(e,t,r){let n=Reflect.get(e,t,r);return"function"==typeof n?n.bind(e):n}static set(e,t,r,n){return Reflect.set(e,t,r,n)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},76361,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return o}});let n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(void 0);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=a?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(n,i,l):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}(e.r(71645));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}let a={current:null},i="function"==typeof n.cache?n.cache:e=>e,l=console.warn;function o(e){return function(...t){l(e(...t))}}i(e=>{try{l(a.current)}finally{a.current=null}})},83066,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"afterTaskAsyncStorageInstance",{enumerable:!0,get:function(){return n}});let n=(0,e.r(90317).createAsyncLocalStorage)()},41643,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"afterTaskAsyncStorage",{enumerable:!0,get:function(){return n.afterTaskAsyncStorageInstance}});let n=e.r(83066)},50999,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={isRequestAPICallableInsideAfter:function(){return d},throwForSearchParamsAccessInUseCache:function(){return o},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return l}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=e.r(43248),i=e.r(41643);function l(e,t){throw Object.defineProperty(new a.StaticGenBailoutError(`Route ${e} with \`dynamic = "error"\` couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function o(e,t){let r=Object.defineProperty(Error(`Route ${e.route} used \`searchParams\` inside "use cache". Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await \`searchParams\` outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E842",enumerable:!1,configurable:!0});throw Error.captureStackTrace(r,t),e.invalidDynamicUsageError??=r,r}function d(){let e=i.afterTaskAsyncStorage.getStore();return(null==e?void 0:e.rootTaskSpawnPhase)==="action"}},42852,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,s={RenderStage:function(){return o},StagedRenderingController:function(){return d}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let i=e.r(12718),l=e.r(39470);var o=((n={})[n.Before=1]="Before",n[n.Static=2]="Static",n[n.Runtime=3]="Runtime",n[n.Dynamic=4]="Dynamic",n[n.Abandoned=5]="Abandoned",n);class d{constructor(e=null,t){this.abortSignal=e,this.hasRuntimePrefetch=t,this.currentStage=1,this.staticInterruptReason=null,this.runtimeInterruptReason=null,this.staticStageEndTime=1/0,this.runtimeStageEndTime=1/0,this.runtimeStageListeners=[],this.dynamicStageListeners=[],this.runtimeStagePromise=(0,l.createPromiseWithResolvers)(),this.dynamicStagePromise=(0,l.createPromiseWithResolvers)(),this.mayAbandon=!1,e&&(e.addEventListener("abort",()=>{let{reason:t}=e;this.currentStage<3&&(this.runtimeStagePromise.promise.catch(c),this.runtimeStagePromise.reject(t)),(this.currentStage<4||5===this.currentStage)&&(this.dynamicStagePromise.promise.catch(c),this.dynamicStagePromise.reject(t))},{once:!0}),this.mayAbandon=!0)}onStage(e,t){if(this.currentStage>=e)t();else if(3===e)this.runtimeStageListeners.push(t);else if(4===e)this.dynamicStageListeners.push(t);else throw Object.defineProperty(new i.InvariantError(`Invalid render stage: ${e}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}canSyncInterrupt(){if(1===this.currentStage)return!1;let e=this.hasRuntimePrefetch?4:3;return this.currentStage<e}syncInterruptCurrentStageWithReason(e){if(1!==this.currentStage){if(this.mayAbandon)return this.abandonRenderImpl();switch(this.currentStage){case 2:this.staticInterruptReason=e,this.advanceStage(4);return;case 3:this.hasRuntimePrefetch&&(this.runtimeInterruptReason=e,this.advanceStage(4));return}}}getStaticInterruptReason(){return this.staticInterruptReason}getRuntimeInterruptReason(){return this.runtimeInterruptReason}getStaticStageEndTime(){return this.staticStageEndTime}getRuntimeStageEndTime(){return this.runtimeStageEndTime}abandonRender(){if(!this.mayAbandon)throw Object.defineProperty(new i.InvariantError("`abandonRender` called on a stage controller that cannot be abandoned."),"__NEXT_ERROR_CODE",{value:"E938",enumerable:!1,configurable:!0});this.abandonRenderImpl()}abandonRenderImpl(){let{currentStage:e}=this;switch(e){case 2:this.currentStage=5,this.resolveRuntimeStage();return;case 3:this.currentStage=5;return}}advanceStage(e){if(e<=this.currentStage)return;let t=this.currentStage;if(this.currentStage=e,t<3&&e>=3&&(this.staticStageEndTime=performance.now()+performance.timeOrigin,this.resolveRuntimeStage()),t<4&&e>=4){this.runtimeStageEndTime=performance.now()+performance.timeOrigin,this.resolveDynamicStage();return}}resolveRuntimeStage(){let e=this.runtimeStageListeners;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.runtimeStagePromise.resolve()}resolveDynamicStage(){let e=this.dynamicStageListeners;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.dynamicStagePromise.resolve()}getStagePromise(e){switch(e){case 3:return this.runtimeStagePromise.promise;case 4:return this.dynamicStagePromise.promise;default:throw Object.defineProperty(new i.InvariantError(`Invalid render stage: ${e}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}}waitForStage(e){return this.getStagePromise(e)}delayUntilStage(e,t,r){var n,s,a;let i,l=(n=this.getStagePromise(e),s=t,a=r,i=new Promise((e,t)=>{n.then(e.bind(null,a),t)}),void 0!==s&&(i.displayName=s),i);return this.abortSignal&&l.catch(c),l}}function c(){}},95613,e=>{"use strict";var t=e.i(43476),r=e.i(25913);e.i(87467);var n=e.i(55654);let s=(0,r.cva)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow",success:"border-transparent bg-success text-success-foreground shadow",warning:"border-transparent bg-warning text-warning-foreground shadow",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function a({className:e,variant:r,...a}){return(0,t.jsx)("div",{className:(0,n.cn)(s({variant:r}),e),...a})}e.s(["Badge",()=>a])},524,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(87467);var n=e.i(55654);let s=r.forwardRef(({className:e,error:r,children:s,...a},i)=>(0,t.jsxs)("div",{className:"relative w-full",children:[(0,t.jsx)("select",{className:(0,n.cn)("flex h-9 w-full appearance-none rounded-md border border-input bg-background px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r&&"border-destructive focus-visible:ring-destructive",e),ref:i,...a,children:s}),r&&(0,t.jsx)("p",{className:"mt-1 text-xs text-destructive",children:r})]}));s.displayName="Select",e.s(["Select",()=>s])},7003,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(87467);var n=e.i(55654),s=e.i(37727);let a=r.createContext(void 0);function i({children:e,open:n,onOpenChange:s}){let[i,l]=r.useState(!1);return(0,t.jsx)(a.Provider,{value:{open:n??i,setOpen:s??l},children:e})}function l({children:e,className:i}){let{open:l,setOpen:o}=function(){let e=r.useContext(a);if(!e)throw Error("useDialog must be used within a Dialog");return e}();return(r.useEffect(()=>{let e=e=>{"Escape"===e.key&&o(!1)};return l&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow=""}},[l,o]),l)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 animate-fade-in",onClick:()=>o(!1)}),(0,t.jsxs)("div",{className:(0,n.cn)("relative z-50 w-full max-w-lg max-h-[90vh] overflow-auto rounded-lg bg-card p-4 sm:p-6 shadow-lg animate-slide-up",i),children:[(0,t.jsxs)("button",{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onClick:()=>o(!1),children:[(0,t.jsx)(s.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),e]})]}):null}function o({className:e,...r}){return(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...r})}function d({className:e,...r}){return(0,t.jsx)("h2",{className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...r})}function c({className:e,...r}){return(0,t.jsx)("p",{className:(0,n.cn)("text-sm text-muted-foreground",e),...r})}function u({className:e,...r}){return(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r})}e.s(["Dialog",()=>i,"DialogContent",()=>l,"DialogDescription",()=>c,"DialogFooter",()=>u,"DialogHeader",()=>o,"DialogTitle",()=>d])},63876,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(87467);var n=e.i(55654);let s=r.forwardRef(({className:e,error:r,...s},a)=>(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r&&"border-destructive focus-visible:ring-destructive",e),ref:a,...s}),r&&(0,t.jsx)("p",{className:"mt-1 text-xs text-destructive",children:r})]}));s.displayName="Textarea",e.s(["Textarea",()=>s])},63727,e=>{"use strict";let t=(0,e.i(75254).default)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);e.s(["Briefcase",()=>t],63727)},88844,e=>{"use strict";let t=(0,e.i(75254).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>t],88844)},48137,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(87467);var n=e.i(55654);let s=r.createContext(void 0);function a(){let e=r.useContext(s);if(!e)throw Error("useTabs must be used within a Tabs");return e}function i({children:e,defaultValue:a,value:i,onValueChange:l,className:o}){let[d,c]=r.useState(a??"");return(0,t.jsx)(s.Provider,{value:{value:i??d,onValueChange:l??c},children:(0,t.jsx)("div",{className:(0,n.cn)("w-full",o),children:e})})}function l({children:e,className:r}){return(0,t.jsx)("div",{className:(0,n.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",r),children:e})}function o({children:e,value:r,className:s,disabled:i}){let{value:l,onValueChange:o}=a(),d=l===r;return(0,t.jsx)("button",{type:"button",role:"tab","aria-selected":d,disabled:i,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",d&&"bg-background text-foreground shadow",s),onClick:()=>o(r),children:e})}function d({children:e,value:r,className:s}){let{value:i}=a();return i!==r?null:(0,t.jsx)("div",{role:"tabpanel",className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),children:e})}e.s(["Tabs",()=>i,"TabsContent",()=>d,"TabsList",()=>l,"TabsTrigger",()=>o])},15404,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(68720),s=e.i(40574),a=e.i(34098),i=e.i(80720),l=e.i(524),o=e.i(95613),d=e.i(48137),c=e.i(7003),u=e.i(69481),m=e.i(63876),h=e.i(7233),f=e.i(88844),g=e.i(75254);let p=(0,g.default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);var x=e.i(88699),v=e.i(27612),b=e.i(69638),j=e.i(63727);let y=(0,g.default)("store",[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]]),N=["each","gal","box","roll","pack","can","tube"],S=[{value:"paint",label:"Paint"},{value:"primer",label:"Primer"},{value:"sundries",label:"Sundries"},{value:"tools",label:"Tools"}];function w({initialItems:e,pickupLocations:g,companyId:x,jobMaterials:v}){let[b,w]=(0,r.useState)(e),[I,T]=(0,r.useState)(v),[P,R]=(0,r.useState)(!1),[C,E]=(0,r.useState)(null),{addToast:O}=(0,u.useToast)(),A=(0,n.createClient)();(0,r.useEffect)(()=>{async function e(){let{data:e}=await A.from("job_materials").select(`
          *,
          job:jobs!inner(
            id,
            title,
            status,
            company_id
          )
        `).eq("job.company_id",x).in("job.status",["new","quoted","scheduled","in_progress"]).is("purchased_at",null);e&&T(e)}let t=A.channel(`inventory-job-materials-${x}`).on("postgres_changes",{event:"*",schema:"public",table:"job_materials"},()=>{e()}).on("postgres_changes",{event:"*",schema:"public",table:"jobs",filter:`company_id=eq.${x}`},()=>{e()}).subscribe();return()=>{A.removeChannel(t)}},[x,A]);let[D,M]=(0,r.useState)(""),[L,B]=(0,r.useState)("sundries"),[F,q]=(0,r.useState)("each"),[W,U]=(0,r.useState)(""),[$,V]=(0,r.useState)(""),[z,H]=(0,r.useState)(""),[X,K]=(0,r.useState)("Sherwin-Williams"),[G,J]=(0,r.useState)(""),[Q,Y]=(0,r.useState)(""),[Z,ee]=(0,r.useState)(!1),et=(0,r.useMemo)(()=>{let e=new Map;I.forEach(t=>{let r=t.inventory_item_id||`unlinked_${t.name.toLowerCase()}`,n=e.get(r),s=t.quantity_decimal||0;if(n)n.totalNeeded+=s,n.jobIds.push(t.job.id),n.jobTitles.push(t.job.title),n.jobMaterialIds.push(t.id);else{let n=t.inventory_item_id?b.find(e=>e.id===t.inventory_item_id):null,a=n?.on_hand||0,i=n?.preferred_pickup_location_id||null,l=n?.pickup_location?.name||null;e.set(r,{inventoryItemId:t.inventory_item_id,name:t.name,totalNeeded:s,unit:t.unit||n?.unit||"each",storeId:i,storeName:l,onHand:a,quantityStillNeeded:Math.max(s-a,0),jobIds:[t.job.id],jobTitles:[t.job.title],jobMaterialIds:[t.id]})}}),Array.from(e.values()).forEach(e=>{e.quantityStillNeeded=Math.max(e.totalNeeded-e.onHand,0)});let t=Array.from(e.values()).filter(e=>e.quantityStillNeeded>0),r={"No Store":[]};return t.forEach(e=>{let t=e.storeName||"No Store";r[t]||(r[t]=[]),r[t].push(e)}),r},[I,b]),er=(0,r.useMemo)(()=>Object.values(et).flat().filter(e=>!e.inventoryItemId),[et]);function en(){M(""),B("sundries"),q("each"),U(""),V(""),H(""),K("Sherwin-Williams"),J(""),Y(""),E(null)}function es(){en(),R(!0)}async function ea(e){if(e.preventDefault(),D.trim()){ee(!0);try{let e={company_id:x,name:D.trim(),category:L,unit:F,on_hand:parseInt(W)||0,reorder_at:parseInt($)||0,cost_per_unit:z?parseFloat(z):null,vendor_name:X||null,vendor_sku:G||null,preferred_pickup_location_id:null,notes:Q||null};if(C){let{data:t,error:r}=await A.from("inventory_items").update(e).eq("id",C.id).select("*").single();if(r)throw r;let n=g.find(e=>e.id===t.preferred_pickup_location_id)||null,s={...t,pickup_location:n};w(e=>e.map(e=>e.id===C.id?s:e)),O("Item updated!","success")}else{let{data:t,error:r}=await A.from("inventory_items").insert(e).select("*").single();if(r)throw r;let n=g.find(e=>e.id===t.preferred_pickup_location_id)||null,s={...t,pickup_location:n};w(e=>[...e,s].sort((e,t)=>e.name.localeCompare(t.name))),O("Item added!","success")}R(!1),en()}catch(e){console.error("Error saving item:",e),O("Failed to save item","error")}finally{ee(!1)}}}async function ei(e){if(!confirm("Delete this item?"))return;let{error:t}=await A.from("inventory_items").delete().eq("id",e);t?O("Failed to delete item","error"):(w(t=>t.filter(t=>t.id!==e)),O("Item deleted","success"))}async function el(e,t){let{error:r}=await A.from("inventory_items").update({on_hand:t}).eq("id",e);r?O("Failed to update quantity","error"):w(r=>r.map(r=>r.id===e?{...r,on_hand:t}:r))}async function eo(e,t,r){try{let{error:n}=await A.from("job_materials").update({purchased_at:new Date().toISOString()}).in("id",e);if(n)throw n;if(t){let e=b.find(e=>e.id===t);if(e){let n=e.on_hand+r;await el(t,n)}}T(t=>t.filter(t=>!e.includes(t.id))),O("Marked as purchased!","success")}catch(e){console.error("Error marking as purchased:",e),O("Failed to mark as purchased","error")}}let ed=Object.values(et).flat().length;return(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 border-b bg-card p-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Inventory"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[b.length," item",1!==b.length?"s":""," •"," ",ed," needed for jobs"]})]}),(0,t.jsxs)(s.Button,{onClick:es,children:[(0,t.jsx)(h.Plus,{className:"mr-2 h-4 w-4"}),"Add Item"]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-auto p-4",children:(0,t.jsxs)(d.Tabs,{defaultValue:"all",className:"w-full",children:[(0,t.jsxs)(d.TabsList,{children:[(0,t.jsxs)(d.TabsTrigger,{value:"all",children:["All Items (",b.length,")"]}),(0,t.jsxs)(d.TabsTrigger,{value:"needed",children:[(0,t.jsx)(j.Briefcase,{className:"mr-1.5 h-3.5 w-3.5"}),"Needed for Jobs (",ed,")"]}),(0,t.jsxs)(d.TabsTrigger,{value:"buy",children:[(0,t.jsx)(p,{className:"mr-1.5 h-3.5 w-3.5"}),"Buy List (",er.length,")"]}),(0,t.jsxs)(d.TabsTrigger,{value:"stores",children:[(0,t.jsx)(y,{className:"mr-1.5 h-3.5 w-3.5"}),"Stores (",g.length,")"]})]}),(0,t.jsx)(d.TabsContent,{value:"all",className:"mt-4",children:0===b.length?(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-8 text-center",children:[(0,t.jsx)(f.Package,{className:"mx-auto h-8 w-8 text-muted-foreground mb-2"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"No inventory items yet"}),(0,t.jsx)(s.Button,{onClick:es,className:"mt-4",children:"Add your first item"})]}):(0,t.jsx)("div",{className:"rounded-lg border bg-card divide-y",children:b.map(e=>(0,t.jsx)(_,{item:e,onEdit:()=>{E(e),M(e.name),B(e.category),q(e.unit),U(e.on_hand.toString()),V(e.reorder_at.toString()),H(e.cost_per_unit?.toString()||""),K(e.vendor_name||"Sherwin-Williams"),J(e.vendor_sku||""),Y(e.notes||""),R(!0)},onDelete:()=>ei(e.id),onUpdateQuantity:t=>el(e.id,t)},e.id))})}),(0,t.jsx)(d.TabsContent,{value:"needed",className:"mt-4",children:0===ed?(0,t.jsx)("div",{className:"rounded-lg border bg-card p-8 text-center",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No materials needed for active jobs!"})}):(0,t.jsx)("div",{className:"space-y-6",children:Object.entries(et).map(([e,r])=>r.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:e}),(0,t.jsx)("div",{className:"rounded-lg border bg-card divide-y",children:r.map(e=>(0,t.jsx)(k,{need:e,onMarkAsPurchased:t=>eo(e.jobMaterialIds,e.inventoryItemId,t)},e.inventoryItemId||e.name))})]},e))})}),(0,t.jsx)(d.TabsContent,{value:"buy",className:"mt-4",children:0===er.length?(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-8 text-center",children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Nothing to buy!"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"All materials needed for jobs are already in your inventory."})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"rounded-lg border bg-card divide-y",children:er.map((e,r)=>(0,t.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Need ",e.quantityStillNeeded.toFixed(2)," ",e.unit]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["For ",e.jobTitles.length," job",1!==e.jobTitles.length?"s":"",": ",e.jobTitles.join(", ")]}),e.storeName&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Store: ",e.storeName]})]}),(0,t.jsxs)(o.Badge,{variant:"warning",children:[e.quantityStillNeeded.toFixed(2)," ",e.unit]})]},e.inventoryItemId||e.name||r))}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"These items are needed for jobs but aren't in your inventory. Add them to your inventory or purchase them directly."})]})}),(0,t.jsx)(d.TabsContent,{value:"stores",className:"mt-4",children:0===g.length?(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-8 text-center",children:[(0,t.jsx)(y,{className:"mx-auto h-8 w-8 text-muted-foreground mb-2"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"No pickup locations configured yet"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Add stores or pickup locations in Settings to track where you purchase materials."})]}):(0,t.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:g.map(e=>{let r=b.filter(t=>t.preferred_pickup_location_id===e.id);return(0,t.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold",children:e.name}),e.address1&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[e.address1,e.city&&`, ${e.city}`,e.state&&`, ${e.state}`]})]}),(0,t.jsx)(o.Badge,{variant:"default",children:r.length})]}),e.notes&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:e.notes}),r.length>0&&(0,t.jsxs)("div",{className:"mt-3 pt-3 border-t",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Items from this store:"}),(0,t.jsxs)("div",{className:"space-y-1",children:[r.slice(0,5).map(e=>(0,t.jsxs)("p",{className:"text-xs truncate",children:["• ",e.name]},e.id)),r.length>5&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",r.length-5," more"]})]})]})]},e.id)})})})]})}),(0,t.jsx)(c.Dialog,{open:P,onOpenChange:R,children:(0,t.jsxs)(c.DialogContent,{children:[(0,t.jsxs)(c.DialogHeader,{children:[(0,t.jsx)(c.DialogTitle,{children:C?"Edit Item":"Add Inventory Item"}),(0,t.jsx)(c.DialogDescription,{children:"Track supplies to know when you need to restock."})]}),(0,t.jsxs)("form",{onSubmit:ea,className:"space-y-4 mt-4",children:[(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2 sm:col-span-2",children:[(0,t.jsx)(i.Label,{htmlFor:"name",children:"Item Name *"}),(0,t.jsx)(a.Input,{id:"name",placeholder:"e.g., Painter's Tape 2in",value:D,onChange:e=>M(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(i.Label,{htmlFor:"category",children:"Category"}),(0,t.jsx)(l.Select,{id:"category",value:L,onChange:e=>B(e.target.value),children:S.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(i.Label,{htmlFor:"unit",children:"Unit"}),(0,t.jsx)(l.Select,{id:"unit",value:F,onChange:e=>q(e.target.value),children:N.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(i.Label,{htmlFor:"onHand",children:"On Hand"}),(0,t.jsx)(a.Input,{id:"onHand",type:"number",min:"0",value:W,onChange:e=>U(e.target.value),placeholder:"0"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(i.Label,{htmlFor:"reorderAt",children:"Reorder At"}),(0,t.jsx)(a.Input,{id:"reorderAt",type:"number",min:"0",value:$,onChange:e=>V(e.target.value),placeholder:"5"})]}),(0,t.jsxs)("div",{className:"space-y-2 sm:col-span-2",children:[(0,t.jsx)(i.Label,{htmlFor:"costPerUnit",children:"Cost per Unit ($)"}),(0,t.jsx)(a.Input,{id:"costPerUnit",type:"number",step:"0.01",min:"0",value:z,onChange:e=>H(e.target.value),placeholder:"0.00"})]})]}),(0,t.jsx)("hr",{}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium",children:"Vendor Info (optional)"}),(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(i.Label,{htmlFor:"vendorName",children:"Vendor"}),(0,t.jsx)(a.Input,{id:"vendorName",value:X,onChange:e=>K(e.target.value),placeholder:"Sherwin-Williams"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(i.Label,{htmlFor:"vendorSku",children:"SKU"}),(0,t.jsx)(a.Input,{id:"vendorSku",value:G,onChange:e=>J(e.target.value),placeholder:"SW-12345"})]}),(0,t.jsxs)("div",{className:"space-y-2 sm:col-span-2",children:[(0,t.jsx)(i.Label,{htmlFor:"notes",children:"Notes"}),(0,t.jsx)(m.Textarea,{id:"notes",value:Q,onChange:e=>Y(e.target.value),placeholder:"Optional notes about this item",rows:2})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,t.jsx)(s.Button,{type:"button",variant:"outline",onClick:()=>R(!1),children:"Cancel"}),(0,t.jsx)(s.Button,{type:"submit",loading:Z,children:C?"Save Changes":"Add Item"})]})]})]})})]})}function _({item:e,onEdit:r,onDelete:n,onUpdateQuantity:a,showWarning:i}){let l=e.on_hand<=e.reorder_at;return(0,t.jsxs)("div",{className:"p-4 flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"font-medium truncate",children:e.name}),l&&i&&(0,t.jsx)(o.Badge,{variant:"warning",className:"shrink-0",children:"Low"}),(0,t.jsx)(o.Badge,{variant:"default",className:"shrink-0 text-xs",children:e.category})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.on_hand," ",e.unit," on hand",e.reorder_at>0&&` • Reorder at ${e.reorder_at}`]}),e.vendor_sku&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["SKU: ",e.vendor_sku]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(s.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>a(Math.max(0,e.on_hand-1)),children:"-"}),(0,t.jsx)("span",{className:"w-8 text-center text-sm font-medium",children:e.on_hand}),(0,t.jsx)(s.Button,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>a(e.on_hand+1),children:"+"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",onClick:r,children:(0,t.jsx)(x.Pencil,{className:"h-4 w-4"})}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",onClick:n,children:(0,t.jsx)(v.Trash2,{className:"h-4 w-4"})})]})]})}function k({need:e,onMarkAsPurchased:r}){return(0,t.jsxs)("div",{className:"p-4 flex items-start gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"font-medium",children:e.name}),!e.inventoryItemId&&(0,t.jsx)(o.Badge,{variant:"default",className:"shrink-0 text-xs",children:"Not Linked"})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Total needed: ",e.totalNeeded.toFixed(2)," ",e.unit," • ","On hand: ",e.onHand," ",e.unit," • ","Still need: ",e.quantityStillNeeded.toFixed(2)," ",e.unit]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["For ",e.jobTitles.length," job",1!==e.jobTitles.length?"s":"",": ",e.jobTitles.join(", ")]})]}),(0,t.jsxs)(s.Button,{variant:"outline",size:"sm",onClick:()=>r(e.quantityStillNeeded),children:[(0,t.jsx)(b.CheckCircle,{className:"mr-2 h-4 w-4"}),"Mark as Purchased"]})]})}e.s(["InventoryView",()=>w],15404)}]);