module.exports=[96792,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(59193);var d=a.i(63561),e=a.i(33508);let f=c.createContext(void 0);function g({children:a,open:d,onOpenChange:e}){let[g,h]=c.useState(!1);return(0,b.jsx)(f.Provider,{value:{open:d??g,setOpen:e??h},children:a})}function h({children:a,className:g}){let{open:h,setOpen:i}=function(){let a=c.useContext(f);if(!a)throw Error("useDialog must be used within a Dialog");return a}();return(c.useEffect(()=>{let a=a=>{"Escape"===a.key&&i(!1)};return h&&(document.addEventListener("keydown",a),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",a),document.body.style.overflow=""}},[h,i]),h)?(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 animate-fade-in",onClick:()=>i(!1)}),(0,b.jsxs)("div",{className:(0,d.cn)("relative z-50 w-full max-w-lg max-h-[90vh] overflow-auto rounded-lg bg-card p-4 sm:p-6 shadow-lg animate-slide-up",g),children:[(0,b.jsxs)("button",{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onClick:()=>i(!1),children:[(0,b.jsx)(e.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]}),a]})]}):null}function i({className:a,...c}){return(0,b.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...c})}function j({className:a,...c}){return(0,b.jsx)("h2",{className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",a),...c})}function k({className:a,...c}){return(0,b.jsx)("p",{className:(0,d.cn)("text-sm text-muted-foreground",a),...c})}function l({className:a,...c}){return(0,b.jsx)("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...c})}a.s(["Dialog",()=>g,"DialogContent",()=>h,"DialogDescription",()=>k,"DialogFooter",()=>l,"DialogHeader",()=>i,"DialogTitle",()=>j])},48351,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(59193);var d=a.i(63561);let e=c.forwardRef(({className:a,error:c,children:e,...f},g)=>(0,b.jsxs)("div",{className:"relative w-full",children:[(0,b.jsx)("select",{className:(0,d.cn)("flex h-9 w-full appearance-none rounded-md border border-input bg-background px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",c&&"border-destructive focus-visible:ring-destructive",a),ref:g,...f,children:e}),c&&(0,b.jsx)("p",{className:"mt-1 text-xs text-destructive",children:c})]}));e.displayName="Select",a.s(["Select",()=>e])},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},85158,a=>{"use strict";var b=a.i(87924),c=a.i(187);a.i(59193);var d=a.i(63561);let e=(0,c.cva)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow",success:"border-transparent bg-success text-success-foreground shadow",warning:"border-transparent bg-warning text-warning-foreground shadow",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{className:(0,d.cn)(e({variant:c}),a),...f})}a.s(["Badge",()=>f])},46842,a=>{"use strict";let b=(0,a.i(70106).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>b],46842)},39177,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(187);a.i(59193);var e=a.i(63561),f=a.i(96221);let g=(0,d.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:opacity-90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-muted hover:text-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-muted hover:text-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground shadow-sm hover:bg-success/90"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),h=c.forwardRef(({className:a,variant:c,size:d,loading:h,children:i,disabled:j,...k},l)=>(0,b.jsxs)("button",{className:(0,e.cn)(g({variant:c,size:d,className:a})),ref:l,disabled:j||h,...k,children:[h&&(0,b.jsx)(f.Loader2,{className:"animate-spin"}),i]}));h.displayName="Button",a.s(["Button",()=>h])},187,a=>{"use strict";var b=a.i(98621);let c=a=>"boolean"==typeof a?`${a}`:0===a?"0":a,d=b.clsx;a.s(["cva",0,(a,b)=>e=>{var f;if((null==b?void 0:b.variants)==null)return d(a,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:g,defaultVariants:h}=b,i=Object.keys(g).map(a=>{let b=null==e?void 0:e[a],d=null==h?void 0:h[a];if(null===b)return null;let f=c(b)||c(d);return g[a][f]}),j=e&&Object.entries(e).reduce((a,b)=>{let[c,d]=b;return void 0===d||(a[c]=d),a},{});return d(a,i,null==b||null==(f=b.compoundVariants)?void 0:f.reduce((a,b)=>{let{class:c,className:d,...e}=b;return Object.entries(e).every(a=>{let[b,c]=a;return Array.isArray(c)?c.includes({...h,...j}[b]):({...h,...j})[b]===c})?[...a,c,d]:a},[]),null==e?void 0:e.class,null==e?void 0:e.className)}])},96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},24987,a=>{"use strict";let b=(0,a.i(70106).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],24987)},4720,a=>{"use strict";let b=(0,a.i(70106).default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);a.s(["FileText",()=>b],4720)},84739,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(52517);a.i(59193);var g=a.i(63561),h=a.i(39177),i=a.i(85158),j=a.i(48351),k=a.i(96792),l=a.i(20170),m=a.i(210),n=a.i(46842),o=a.i(24987),p=a.i(4720);let q=(0,a.i(70106).default)("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);var r=a.i(63588);let s=[{value:"cash",label:"Cash"},{value:"check",label:"Check"},{value:"venmo",label:"Venmo"},{value:"zelle",label:"Zelle"},{value:"other",label:"Other"}];function t({invoice:a}){let t=(0,d.useRouter)(),{addToast:u}=(0,l.useToast)(),v=(0,f.createClient)(),[w,x]=(0,c.useState)(a),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)("cash"),[C,D]=(0,c.useState)(!1),E=`/i/${w.public_token}`,F=[w.job.address1,w.job.city,w.job.state].filter(Boolean).join(", ");async function G(){D(!0);try{let{data:a}=await v.from("invoices").select("status").eq("id",w.id).single();if(a?.status==="paid"){x(a=>({...a,status:"paid"})),z(!1),u("Invoice was already marked as paid","info"),D(!1);return}let{error:b}=await v.from("invoices").update({status:"paid",paid_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",w.id).neq("status","paid");if(b)throw b;await v.from("invoice_payments").insert({invoice_id:w.id,stripe_payment_intent_id:`manual_${A}_${Date.now()}`,amount:w.amount_total,paid_at:new Date().toISOString()}),w.job_id&&await v.from("jobs").update({status:"paid",updated_at:new Date().toISOString()}).eq("id",w.job_id),x(a=>({...a,status:"paid",paid_at:new Date().toISOString()})),z(!1),u(`Marked as paid via ${A}!`,"success")}catch{u("Failed to mark as paid","error")}finally{D(!1)}}return(0,b.jsxs)("div",{className:"min-h-screen pb-20 lg:pb-0",children:[(0,b.jsx)("div",{className:"border-b bg-card",children:(0,b.jsxs)("div",{className:"max-w-3xl mx-auto p-4",children:[(0,b.jsxs)("button",{onClick:()=>t.back(),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-4",children:[(0,b.jsx)(m.ArrowLeft,{className:"h-4 w-4"}),"Back"]}),(0,b.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Invoice"}),(0,b.jsx)(i.Badge,{variant:"paid"===w.status?"success":"sent"===w.status?"secondary":"outline",children:w.status})]}),(0,b.jsxs)("p",{className:"text-muted-foreground mt-1",children:["Created ",(0,g.formatDate)(w.created_at)]})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:function(){let a=w.customer?.name||"there",b=`Hey ${a} — here's your invoice for ${(0,g.formatCurrency)(w.amount_total)}: ${E} — thank you!`,c=w.customer?.phone;c&&/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?window.location.href=`sms:${c}${/iPhone|iPad|iPod/i.test(navigator.userAgent)?"&":"?"}body=${encodeURIComponent(b)}`:((0,g.copyToClipboard)(b),u("Message copied!","success"))},children:[(0,b.jsx)(r.MessageSquare,{className:"mr-2 h-4 w-4"}),w.customer?.phone&&/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?"Text Invoice":"Copy Message"]})})]})]})}),(0,b.jsxs)("div",{className:"max-w-3xl mx-auto p-4 space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Customer"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.User,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium",children:w.customer.name})]}),w.customer.phone&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:w.customer.phone}),w.customer.email&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:w.customer.email})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Job"}),(0,b.jsxs)(e.default,{href:`/app/jobs/${w.job.id}`,className:"font-medium hover:underline flex items-center gap-2",children:[(0,b.jsx)(p.FileText,{className:"h-4 w-4 text-muted-foreground"}),w.job.title]}),F&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-1",children:[(0,b.jsx)(o.MapPin,{className:"h-3 w-3"}),F]})]})]}),(0,b.jsx)("div",{className:"rounded-lg border bg-card p-6",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Amount Due"}),(0,b.jsx)("p",{className:"text-4xl font-bold",children:(0,g.formatCurrency)(w.amount_total)})]})}),(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[(0,b.jsx)("h3",{className:"font-semibold",children:"Payment Status"}),"paid"===w.status?(0,b.jsxs)("div",{className:"bg-success/10 text-success rounded-lg p-4 text-center",children:[(0,b.jsx)("p",{className:"font-semibold",children:"Paid"}),w.paid_at&&(0,b.jsxs)("p",{className:"text-sm",children:["on ",(0,g.formatDate)(w.paid_at)]})]}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Mark this invoice as paid when you receive payment."}),(0,b.jsxs)(h.Button,{onClick:()=>z(!0),children:[(0,b.jsx)(q,{className:"mr-2 h-4 w-4"}),"Mark as Paid"]})]})]})]}),(0,b.jsx)(k.Dialog,{open:y,onOpenChange:z,children:(0,b.jsxs)(k.DialogContent,{children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Mark Invoice as Paid"}),(0,b.jsxs)(k.DialogDescription,{children:["Record a manual payment for ",(0,g.formatCurrency)(w.amount_total),"."]})]}),(0,b.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Payment Method"}),(0,b.jsx)(j.Select,{value:A,onChange:a=>B(a.target.value),children:s.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,b.jsx)(h.Button,{type:"button",variant:"outline",onClick:()=>z(!1),children:"Cancel"}),(0,b.jsxs)(h.Button,{onClick:G,loading:C,children:[(0,b.jsx)(q,{className:"mr-2 h-4 w-4"}),"Confirm Payment"]})]})]})]})})]})}a.s(["InvoiceDetailView",()=>t],84739)}];

//# sourceMappingURL=_8bcaf958._.js.map