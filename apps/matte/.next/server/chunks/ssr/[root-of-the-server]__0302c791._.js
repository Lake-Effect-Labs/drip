module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},23874,a=>{a.n(a.i(34198))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},14717,a=>{a.n(a.i(63692))},61731,a=>{a.n(a.i(68368))},916,a=>{a.n(a.i(3974))},333,a=>{"use strict";async function b(a,b){let{data:c}=await a.from("company_users").select("user_id").eq("company_id",b);if(!c||0===c.length)return[];let d=c.map(a=>a.user_id),{data:e}=await a.from("user_profiles").select("id, email, full_name").in("id",d);return e?.map(a=>({id:a.id,email:a.email,fullName:a.full_name||a.email}))||[]}async function c(a,b){let{data:c}=await a.from("jobs").select("*").eq("company_id",b).order("created_at",{ascending:!1});if(!c||0===c.length)return[];let d=[...new Set(c.filter(a=>a.customer_id).map(a=>a.customer_id))],{data:e}=d.length>0?await a.from("customers").select("*").in("id",d):{data:[]},f=new Map(e?.map(a=>[a.id,a])||[]);return c.map(a=>({...a,customer:a.customer_id&&f.get(a.customer_id)||null}))}async function d(a,b){let{data:c}=await a.from("jobs").select("*").eq("company_id",b).not("scheduled_date","is",null).order("scheduled_date",{ascending:!0});if(!c||0===c.length)return[];let d=[...new Set(c.filter(a=>a.customer_id).map(a=>a.customer_id))],{data:e}=d.length>0?await a.from("customers").select("*").in("id",d):{data:[]},f=new Map(e?.map(a=>[a.id,a])||[]);return c.map(a=>({...a,customer:a.customer_id&&f.get(a.customer_id)||null}))}async function e(a,b){let[c,d,e]=await Promise.all([a.from("jobs").select("id, status, payment_state, payment_amount").eq("company_id",b),a.from("inventory_items").select("id, name, on_hand, reorder_at, unit").eq("company_id",b),a.from("time_entries").select("duration_seconds, started_at").eq("company_id",b)]),f=c.data||[],g=d.data||[],h=e.data||[],i=f.filter(a=>["scheduled","in_progress"].includes(a.status)).length,j=f.filter(a=>"due"===a.payment_state&&a.payment_amount).reduce((a,b)=>a+(b.payment_amount||0),0),k=g.filter(a=>a.on_hand<=a.reorder_at&&a.reorder_at>0),l=new Date,m=new Date(l.getFullYear(),l.getMonth(),l.getDate()),n=new Date(m);n.setDate(n.getDate()-n.getDay());let o=h.filter(a=>new Date(a.started_at)>=m&&a.duration_seconds),p=h.filter(a=>new Date(a.started_at)>=n&&a.duration_seconds),q=o.reduce((a,b)=>a+(b.duration_seconds||0),0)/3600,r=p.reduce((a,b)=>a+(b.duration_seconds||0),0)/3600;return{activeJobs:i,outstandingPayments:j,lowInventoryCount:k.length,lowInventoryItems:k.slice(0,5),todayHours:Math.round(10*q)/10,weekHours:Math.round(10*r)/10,hasTimeTracking:h.length>0}}a.s(["getDashboardData",()=>e,"getJobsWithCustomers",()=>c,"getScheduledJobs",()=>d,"getTeamMembers",()=>b])},18958,a=>{"use strict";a.s(["JobDetailView",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call JobDetailView() from the server but JobDetailView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/matte/src/components/app/jobs/job-detail-view.tsx <module evaluation>","JobDetailView")},53304,a=>{"use strict";a.s(["JobDetailView",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call JobDetailView() from the server but JobDetailView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/matte/src/components/app/jobs/job-detail-view.tsx","JobDetailView")},47959,a=>{"use strict";a.i(18958);var b=a.i(53304);a.n(b)},86271,a=>{"use strict";var b=a.i(7997);a.i(70396);var c=a.i(73727),d=a.i(14754),e=a.i(333),f=a.i(47959);async function g({params:a}){let{id:g}=await a,h=await (0,d.createClient)(),i=(0,d.createAdminClient)(),{data:{user:j}}=await h.auth.getUser();if(!j)return null;let{data:k}=await i.from("company_users").select("company_id").eq("user_id",j.id).maybeSingle();if(!k)return null;let{data:l}=await i.from("jobs").select("*").eq("id",g).eq("company_id",k.company_id).maybeSingle();l||(0,c.notFound)();let m=null;if(l.customer_id){let{data:a}=await i.from("customers").select("*").eq("id",l.customer_id).maybeSingle();m=a}let n={...l,customer:m},{data:o}=await i.from("estimates").select("*").eq("job_id",g).order("created_at",{ascending:!1}),p=await Promise.all((o||[]).map(async a=>{let{data:b}=await i.from("estimate_line_items").select("*").eq("estimate_id",a.id);return{...a,line_items:b||[]}})),{data:q}=await i.from("invoices").select("*").eq("job_id",g).order("created_at",{ascending:!1}),{data:r}=await i.from("job_materials").select("*").eq("job_id",g).order("created_at",{ascending:!0}),s=await (0,e.getTeamMembers)(i,k.company_id),{data:t}=await i.from("estimating_config").select("*").eq("company_id",k.company_id).single();return(0,b.jsx)(f.JobDetailView,{job:n,estimates:p,invoices:q||[],materials:r||[],teamMembers:s,companyId:k.company_id,estimatingConfig:t})}a.s(["default",()=>g])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0302c791._.js.map