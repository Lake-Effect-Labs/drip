{"version":3,"sources":["../../../../../../apps/matte/src/components/app/jobs/photo-gallery.tsx","../../../../../../apps/matte/src/components/app/jobs/job-detail-view.tsx","../../../../../../apps/matte/src/components/app/jobs/message-templates-dialog.tsx","../../../../../../apps/matte/src/components/app/jobs/job-templates-dialog.tsx","../../../../../../apps/matte/src/components/app/jobs/job-history-timeline.tsx","../../../../../../apps/matte/src/components/app/jobs/unified-payment.tsx","../../../../../../apps/matte/src/components/ui/date-time-picker.tsx","../../../../../../node_modules/lucide-react/src/icons/copy.ts","../../../../../../node_modules/lucide-react/src/icons/image-plus.ts","../../../../../../node_modules/lucide-react/src/icons/share-2.ts","../../../../../../node_modules/lucide-react/src/icons/pen.ts","../../../../../../node_modules/lucide-react/src/icons/save.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select } from \"@/components/ui/select\";\nimport { useToast } from \"@/components/ui/toast\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Camera, Upload, X, Trash2, Image as ImageIcon, ImagePlus } from \"lucide-react\";\nimport type { JobPhoto } from \"@drip/core/types\";\n\ninterface PhotoGalleryProps {\n  jobId: string;\n  companyId: string;\n  compact?: boolean;\n}\n\nexport function PhotoGallery({ jobId, companyId, compact = false }: PhotoGalleryProps) {\n  const [photos, setPhotos] = useState<JobPhoto[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [uploading, setUploading] = useState(false);\n  const [selectedPhoto, setSelectedPhoto] = useState<JobPhoto | null>(null);\n  const [selectedTag, setSelectedTag] = useState<\"before\" | \"after\" | \"other\">(\"other\");\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const { addToast } = useToast();\n\n  useEffect(() => {\n    loadPhotos();\n  }, [jobId]);\n\n  async function loadPhotos() {\n    try {\n      const response = await fetch(`/api/jobs/${jobId}/photos`);\n      if (!response.ok) throw new Error(\"Failed to load photos\");\n      const data = await response.json();\n      setPhotos(data);\n    } catch (error) {\n      console.error(\"Error loading photos:\", error);\n      addToast(\"Failed to load photos\", \"error\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function handleFileSelect(e: React.ChangeEvent<HTMLInputElement>) {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Validate file size (10MB)\n    if (file.size > 10 * 1024 * 1024) {\n      addToast(\"File too large (max 10MB)\", \"error\");\n      return;\n    }\n\n    // Validate file type\n    const validTypes = [\"image/jpeg\", \"image/jpg\", \"image/png\", \"image/webp\", \"image/heic\"];\n    if (!validTypes.includes(file.type)) {\n      addToast(\"Invalid file type. Use JPEG, PNG, WebP, or HEIC\", \"error\");\n      return;\n    }\n\n    await uploadPhoto(file);\n  }\n\n  async function uploadPhoto(file: File) {\n    setUploading(true);\n\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      formData.append(\"tag\", selectedTag);\n\n      const response = await fetch(`/api/jobs/${jobId}/photos`, {\n        method: \"POST\",\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        console.error(\"Upload error details:\", error);\n        throw new Error(error.error || \"Upload failed\");\n      }\n\n      const photo = await response.json();\n      setPhotos((prev) => [photo, ...prev]);\n      addToast(\"Photo uploaded!\", \"success\");\n\n      // Reset file input\n      if (fileInputRef.current) {\n        fileInputRef.current.value = \"\";\n      }\n    } catch (error: any) {\n      console.error(\"Upload error:\", error);\n      addToast(error.message || \"Failed to upload photo\", \"error\");\n    } finally {\n      setUploading(false);\n    }\n  }\n\n  async function handleDeletePhoto(photoId: string) {\n    if (!confirm(\"Delete this photo? This cannot be undone.\")) {\n      return;\n    }\n\n    try {\n      const response = await fetch(`/api/jobs/${jobId}/photos/${photoId}`, {\n        method: \"DELETE\",\n      });\n\n      if (!response.ok) throw new Error(\"Failed to delete photo\");\n\n      setPhotos((prev) => prev.filter((p) => p.id !== photoId));\n      setSelectedPhoto(null);\n      addToast(\"Photo deleted\", \"success\");\n    } catch (error) {\n      console.error(\"Delete error:\", error);\n      addToast(\"Failed to delete photo\", \"error\");\n    }\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Upload Controls */}\n      {!compact && (\n        <div className=\"flex gap-2 items-center\">\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\"image/jpeg,image/jpg,image/png,image/webp,image/heic\"\n            onChange={handleFileSelect}\n            className=\"hidden\"\n          />\n\n          <Select\n            value={selectedTag}\n            onChange={(e) => setSelectedTag(e.target.value as \"before\" | \"after\" | \"other\")}\n            className=\"flex-1 min-h-[44px]\"\n          >\n            <option value=\"before\">Before</option>\n            <option value=\"after\">After</option>\n            <option value=\"other\">Other</option>\n          </Select>\n\n          <Button\n            onClick={() => fileInputRef.current?.click()}\n            disabled={uploading}\n            loading={uploading}\n            className=\"flex-1 touch-target min-h-[44px]\"\n          >\n            <ImagePlus className=\"mr-2 h-4 w-4\" />\n            {uploading ? \"Uploading...\" : \"Add Photo\"}\n          </Button>\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading && (\n        <div className=\"p-8 text-center text-muted-foreground\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2\" />\n          <p className=\"text-sm\">Loading photos...</p>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {!loading && photos.length === 0 && (\n        <div className=\"p-8 text-center text-muted-foreground rounded-lg border bg-muted/30\">\n          <ImageIcon className=\"mx-auto h-8 w-8 mb-2\" />\n          <p>No photos yet</p>\n          <p className=\"text-xs mt-1\">Take or upload photos to document this job</p>\n        </div>\n      )}\n\n      {/* Photo Grid - All Photos */}\n      {!loading && photos.length > 0 && (\n        <div className={compact ? \"flex items-center gap-2\" : \"grid grid-cols-2 sm:grid-cols-3 gap-3\"}>\n          {compact ? (\n            <>\n              <div className=\"flex items-center gap-1 text-sm text-muted-foreground\">\n                <ImageIcon className=\"h-4 w-4\" />\n                <span>{photos.length} photo{photos.length !== 1 ? 's' : ''}</span>\n              </div>\n              {photos.slice(0, 3).map((photo) => (\n                <button\n                  key={photo.id}\n                  onClick={() => setSelectedPhoto(photo)}\n                  className=\"w-12 h-12 rounded overflow-hidden bg-muted hover:opacity-80 transition-opacity\"\n                >\n                  <img\n                    src={photo.public_url}\n                    alt={photo.caption || \"Photo\"}\n                    className=\"w-full h-full object-cover\"\n                  />\n                </button>\n              ))}\n            </>\n          ) : (\n            photos.map((photo) => (\n              <button\n                key={photo.id}\n                onClick={() => setSelectedPhoto(photo)}\n                className=\"aspect-square rounded-lg overflow-hidden bg-muted hover:opacity-80 transition-opacity relative\"\n              >\n                <img\n                  src={photo.public_url}\n                  alt={photo.caption || \"Photo\"}\n                  className=\"w-full h-full object-cover\"\n                />\n                {photo.tag && (\n                  <span className=\"absolute top-2 left-2 text-xs bg-black/60 text-white px-2 py-1 rounded\">\n                    {photo.tag}\n                  </span>\n                )}\n              </button>\n            ))\n          )}\n        </div>\n      )}\n\n      {/* Photo Detail Dialog */}\n      <Dialog open={!!selectedPhoto} onOpenChange={(open) => !open && setSelectedPhoto(null)}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Photo</DialogTitle>\n          </DialogHeader>\n          {selectedPhoto && (\n            <div className=\"space-y-4\">\n              <img\n                src={selectedPhoto.public_url}\n                alt={selectedPhoto.caption || \"Photo\"}\n                className=\"w-full rounded-lg\"\n              />\n              <div className=\"flex items-center justify-between\">\n                <div className=\"text-sm text-muted-foreground space-y-1\">\n                  <p>\n                    <strong>Tag:</strong> {selectedPhoto.tag || \"other\"}\n                  </p>\n                  {selectedPhoto.file_name && (\n                    <p>\n                      <strong>File:</strong> {selectedPhoto.file_name}\n                    </p>\n                  )}\n                  {selectedPhoto.caption && (\n                    <p>\n                      <strong>Caption:</strong> {selectedPhoto.caption}\n                    </p>\n                  )}\n                </div>\n                <Button\n                  variant=\"destructive\"\n                  size=\"sm\"\n                  onClick={() => handleDeletePhoto(selectedPhoto.id)}\n                >\n                  <Trash2 className=\"mr-2 h-4 w-4\" />\n                  Delete\n                </Button>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","\"use client\";\n\nimport { useState, useEffect, useRef } from \"react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { createClient } from \"@drip/core/database/client\";\nimport {\n  cn,\n  formatDate,\n  formatTime,\n  formatCurrency,\n  copyToClipboard,\n  generateToken,\n  COMMON_MATERIALS,\n  JOB_STATUSES,\n  JOB_STATUS_LABELS,\n  JOB_STATUS_COLORS,\n  type JobStatus,\n} from \"@/lib/utils\";\nimport type { Job, Customer, Estimate, EstimateLineItem, Invoice, JobMaterial, EstimatingConfig } from \"@drip/core/types\";\nimport { JobHistoryTimeline } from \"./job-history-timeline\";\nimport { MessageTemplatesDialog } from \"./message-templates-dialog\";\nimport { JobTemplatesDialog } from \"./job-templates-dialog\";\nimport { PhotoGallery } from \"./photo-gallery\";\nimport { UnifiedPayment } from \"./unified-payment\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { SimpleCheckbox } from \"@/components/ui/checkbox\";\nimport { useToast } from \"@/components/ui/toast\";\nimport { DateTimePicker } from \"@/components/ui/date-time-picker\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  ArrowLeft,\n  Calendar,\n  Clock,\n  MapPin,\n  Phone,\n  Mail,\n  User,\n  FileText,\n  Receipt,\n  Package,\n  Copy,\n  Plus,\n  Trash2,\n  ExternalLink,\n  X,\n  XCircle,\n  Pencil,\n  Share2,\n  Archive,\n  Save,\n  CheckCircle,\n  ChevronRight,\n} from \"lucide-react\";\n\ntype JobWithCustomer = Job & { customer: Customer | null };\ntype EstimateWithLineItems = Estimate & { line_items: EstimateLineItem[] };\n\ninterface JobHistory {\n  id: string;\n  job_id: string;\n  status: string;\n  changed_by: string | null;\n  changed_at: string;\n  notes: string | null;\n}\n\ninterface JobDetailViewProps {\n  job: JobWithCustomer;\n  estimates: EstimateWithLineItems[];\n  invoices: Invoice[];\n  materials: JobMaterial[];\n  jobHistory?: JobHistory[];\n  teamMembers: { id: string; email: string; fullName: string }[];\n  companyId: string;\n  estimatingConfig?: EstimatingConfig | null;\n}\n\nexport function JobDetailView({\n  job: initialJob,\n  estimates,\n  invoices,\n  materials: initialMaterials,\n  jobHistory = [],\n  teamMembers,\n  companyId,\n  estimatingConfig,\n}: JobDetailViewProps) {\n  const router = useRouter();\n  const { addToast } = useToast();\n  const supabase = createClient();\n  \n  // Get current user ID from Supabase auth\n  const [currentUserId, setCurrentUserId] = useState<string>(\"\");\n  \n  useEffect(() => {\n    const fetchUser = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (user) {\n        setCurrentUserId(user.id);\n      }\n    };\n    fetchUser();\n  }, [supabase]);\n\n  const [job, setJob] = useState(initialJob);\n  const [materials, setMaterials] = useState(initialMaterials);\n  const [estimatesList, setEstimatesList] = useState(estimates);\n  const [invoicesList, setInvoicesList] = useState(invoices);\n  const [pickupLocations, setPickupLocations] = useState<Array<{ id: string; name: string }>>([]);\n  const [selectedPickupLocation, setSelectedPickupLocation] = useState<string | null>(job.pickup_location_id || null);\n  const [timeEntries, setTimeEntries] = useState<Array<{\n    id: string;\n    user_id: string;\n    started_at: string;\n    ended_at: string | null;\n    duration_seconds: number | null;\n    user?: { full_name: string };\n  }>>([]);\n  const [loadingTimeEntries, setLoadingTimeEntries] = useState(false);\n  const [addingTimeEntry, setAddingTimeEntry] = useState(false);\n  const [editingTimeEntry, setEditingTimeEntry] = useState<string | null>(null);\n  const [showAddTimeDialog, setShowAddTimeDialog] = useState(false);\n  const [newTimeEntry, setNewTimeEntry] = useState({\n    userId: currentUserId,\n    hours: \"\",\n    date: new Date().toISOString().split(\"T\")[0],\n  });\n  const [paymentLineItems, setPaymentLineItems] = useState<Array<{\n    id: string;\n    title: string;\n    price: number;\n  }>>([]);\n\n  // Sync state with props when they change (e.g., after navigation)\n  useEffect(() => {\n    setJob(initialJob);\n    setMaterials(initialMaterials);\n    setEstimatesList(estimates);\n    setInvoicesList(invoices);\n    // Update schedule states when job changes\n    setScheduledDate(initialJob.scheduled_date || \"\");\n    setScheduledEndDate(initialJob.scheduled_end_date || \"\");\n    setScheduledTime(initialJob.scheduled_time || \"\");\n    setIsMultiDay(!!initialJob.scheduled_end_date);\n  }, [initialJob.id, initialJob.scheduled_date, initialJob.scheduled_end_date, initialJob.scheduled_time, initialMaterials.length, estimates.length, invoices.length]);\n\n  // Real-time subscription for estimate updates\n  useEffect(() => {\n    const channel = supabase\n      .channel(`job-${job.id}-estimates`)\n      .on(\n        'postgres_changes',\n        {\n          event: 'UPDATE',\n          schema: 'public',\n          table: 'estimates',\n          filter: `job_id=eq.${job.id}`,\n        },\n        (payload) => {\n          // Update the estimate in the list\n          setEstimatesList((prev) =>\n            prev.map((est) =>\n              est.id === payload.new.id ? { ...est, ...payload.new } : est\n            )\n          );\n\n          // If estimate was accepted, update job status to quoted\n          if (payload.new.status === 'accepted' && job.status === 'new') {\n            setJob((prev) => ({ ...prev, status: 'quoted' }));\n          }\n        }\n      )\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [job.id, job.status, supabase]);\n\n  // Real-time subscription for job updates (schedule acceptance, payment updates, etc.)\n  useEffect(() => {\n    const channel = supabase\n      .channel(`job-${job.id}-updates`)\n      .on(\n        'postgres_changes',\n        {\n          event: 'UPDATE',\n          schema: 'public',\n          table: 'jobs',\n          filter: `id=eq.${job.id}`,\n        },\n        (payload) => {\n          // Update job with new data\n          setJob((prev) => ({ ...prev, ...payload.new }));\n          \n          // Also update schedule-related state if schedule fields changed\n          if (payload.new.scheduled_date !== undefined) {\n            setScheduledDate(payload.new.scheduled_date || \"\");\n          }\n          if (payload.new.scheduled_end_date !== undefined) {\n            setScheduledEndDate(payload.new.scheduled_end_date || \"\");\n          }\n          if (payload.new.scheduled_time !== undefined) {\n            setScheduledTime(payload.new.scheduled_time || \"\");\n          }\n          if (payload.new.scheduled_end_date !== undefined) {\n            setIsMultiDay(!!payload.new.scheduled_end_date);\n          }\n        }\n      )\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [job.id, supabase]);\n\n  // Real-time subscription for invoice updates (payments, status changes)\n  useEffect(() => {\n    const channel = supabase\n      .channel(`job-${job.id}-invoices`)\n      .on(\n        'postgres_changes',\n        {\n          event: 'UPDATE',\n          schema: 'public',\n          table: 'invoices',\n          filter: `job_id=eq.${job.id}`,\n        },\n        (payload) => {\n          // Update the invoice in the list\n          setInvoicesList((prev) =>\n            prev.map((inv) =>\n              inv.id === payload.new.id ? { ...inv, ...payload.new } : inv\n            )\n          );\n\n          // If invoice was paid, update job status\n          if (payload.new.status === 'paid' && job.status !== 'paid') {\n            setJob((prev) => ({ ...prev, status: 'paid' }));\n          }\n        }\n      )\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [job.id, job.status, supabase]);\n\n  // Real-time subscription for payment line items changes\n  useEffect(() => {\n    const channel = supabase\n      .channel(`job-${job.id}-payment-line-items`)\n      .on(\n        'postgres_changes',\n        {\n          event: '*',\n          schema: 'public',\n          table: 'job_payment_line_items',\n          filter: `job_id=eq.${job.id}`,\n        },\n        async () => {\n          // Refetch all payment line items when any change occurs\n          const { data } = await supabase\n            .from(\"job_payment_line_items\")\n            .select(\"id, title, price\")\n            .eq(\"job_id\", job.id)\n            .order(\"sort_order\");\n          \n          if (data) {\n            setPaymentLineItems(data);\n          }\n        }\n      )\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [job.id, supabase]);\n  const [saving, setSaving] = useState(false);\n  const [newMaterial, setNewMaterial] = useState(\"\");\n  const [showCommonMaterials, setShowCommonMaterials] = useState(false);\n  const notesTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  \n  // Inline add forms\n  const [showAddEstimate, setShowAddEstimate] = useState(false);\n  const [showAddInvoice, setShowAddInvoice] = useState(false);\n  const [estimateLineItems, setEstimateLineItems] = useState<Array<{ title: string; price: string }>>([{ title: \"\", price: \"\" }]);\n  const [newInvoiceAmount, setNewInvoiceAmount] = useState(\"\");\n  const [addingEstimate, setAddingEstimate] = useState(false);\n  const [addingInvoice, setAddingInvoice] = useState(false);\n  const [messageTemplatesOpen, setMessageTemplatesOpen] = useState(false);\n  const [selectedEstimate, setSelectedEstimate] = useState<EstimateWithLineItems | null>(null);\n  const [selectedInvoice, setSelectedInvoice] = useState<Invoice | null>(null);\n  const [showMaterialForm, setShowMaterialForm] = useState(false);\n  const [showShareDialog, setShowShareDialog] = useState(false);\n  const [showShareScheduleDialog, setShowShareScheduleDialog] = useState(false);\n  const [showDuplicateDialog, setShowDuplicateDialog] = useState(false);\n  const [duplicating, setDuplicating] = useState(false);\n  const [showTemplateDialog, setShowTemplateDialog] = useState(false);\n  const [scheduleToken, setScheduleToken] = useState<string | null>((job as any).schedule_token || null);\n  const [loadingScheduleToken, setLoadingScheduleToken] = useState(false);\n  const [templateDialogMode, setTemplateDialogMode] = useState<\"save\" | \"manage\">(\"save\");\n  const [showCopyDialog, setShowCopyDialog] = useState(false);\n  const [copyDialogType, setCopyDialogType] = useState<\"estimate\" | \"invoice\" | \"materials\" | \"reminder\" | \"schedule-confirmation\">(\"estimate\");\n  const [materialType, setMaterialType] = useState<\"paint\" | \"generic\">(\"generic\");\n  const [editingCostId, setEditingCostId] = useState<string | null>(null);\n  const [editingSchedule, setEditingSchedule] = useState(false);\n  const [editingAssignment, setEditingAssignment] = useState(false);\n  const [editingTracking, setEditingTracking] = useState(false);\n  const [editingNotes, setEditingNotes] = useState(false);\n  const [editingMaterials, setEditingMaterials] = useState(false);\n  const [editingPhotos, setEditingPhotos] = useState(false);\n  const [materialFormData, setMaterialFormData] = useState({\n    name: \"\",\n    brand: \"\",\n    color: \"\",\n    sheen: \"\",\n    quantity: \"\",\n    quantityUnit: \"gal\",\n    productLine: \"\",\n    area: \"\",\n    notes: \"\",\n    showAdvanced: false\n  });\n\n  // Form state\n  const [scheduledDate, setScheduledDate] = useState(job.scheduled_date || \"\");\n  const [scheduledEndDate, setScheduledEndDate] = useState(job.scheduled_end_date || \"\");\n  const [scheduledTime, setScheduledTime] = useState(job.scheduled_time || \"\");\n  const [isMultiDay, setIsMultiDay] = useState(!!job.scheduled_end_date);\n  const [assignedUserId, setAssignedUserId] = useState(job.assigned_user_id || \"\");\n  const [notes, setNotes] = useState(job.notes || \"\");\n\n  const address = [job.address1, job.city, job.state, job.zip]\n    .filter(Boolean)\n    .join(\", \");\n\n  // Auto-save function\n  async function autoSave(fields: {\n    scheduled_date?: string | null;\n    scheduled_time?: string | null;\n    assigned_user_id?: string | null;\n    notes?: string | null;\n  }) {\n    try {\n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          ...fields,\n          updated_at: new Date().toISOString(),\n        })\n        .eq(\"id\", job.id);\n\n      if (error) {\n        console.error(\"Auto-save error:\", error);\n        return;\n      }\n\n      setJob((prev) => ({\n        ...prev,\n        ...fields,\n      }));\n    } catch (err) {\n      console.error(\"Auto-save error:\", err);\n    }\n  }\n\n  // Ensure schedule token exists\n  async function ensureScheduleToken() {\n    if (scheduleToken) return scheduleToken;\n    \n    setLoadingScheduleToken(true);\n    try {\n      const token = generateToken(24);\n      \n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          schedule_token: token,\n        })\n        .eq(\"id\", job.id);\n\n      if (error) throw error;\n\n      setScheduleToken(token);\n      setJob((prev) => ({ ...prev, schedule_token: token } as any));\n      return token;\n    } catch (err) {\n      console.error(\"Failed to generate schedule token:\", err);\n      addToast(\"Failed to generate schedule link\", \"error\");\n      return null;\n    } finally {\n      setLoadingScheduleToken(false);\n    }\n  }\n\n  // Save handlers (no auto-save)\n  async function handleSaveSchedule() {\n    if (!scheduledDate || !scheduledTime) {\n      addToast(\"Please set both date and time\", \"error\");\n      return;\n    }\n\n    // Validate end date is after start date if provided\n    if (scheduledEndDate && scheduledEndDate < scheduledDate) {\n      addToast(\"End date must be after start date\", \"error\");\n      return;\n    }\n\n    try {\n      // Generate token if it doesn't exist\n      const token = scheduleToken || generateToken(24);\n      \n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          scheduled_date: scheduledDate || null,\n          scheduled_end_date: scheduledEndDate || null,\n          scheduled_time: scheduledTime || null,\n          schedule_state: \"awaiting_confirmation\",\n          schedule_token: token,\n          updated_at: new Date().toISOString(),\n        })\n        .eq(\"id\", job.id);\n\n      if (error) {\n        addToast(\"Failed to save schedule\", \"error\");\n        return;\n      }\n\n      setJob((prev) => ({\n        ...prev,\n        scheduled_date: scheduledDate || null,\n        scheduled_end_date: scheduledEndDate || null,\n        scheduled_time: scheduledTime || null,\n        schedule_state: \"awaiting_confirmation\",\n        schedule_token: token,\n      } as any));\n      setScheduleToken(token);\n      setEditingSchedule(false);\n      addToast(\"Schedule saved - awaiting customer confirmation\", \"success\");\n    } catch (err) {\n      console.error(\"Save error:\", err);\n      addToast(\"Failed to save schedule\", \"error\");\n    }\n  }\n\n  async function handleAcceptSchedule() {\n    try {\n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          schedule_state: \"accepted\",\n          schedule_accepted_at: new Date().toISOString(),\n          status: \"scheduled\",\n          updated_at: new Date().toISOString(),\n        })\n        .eq(\"id\", job.id);\n\n      if (error) {\n        addToast(\"Failed to accept schedule\", \"error\");\n        return;\n      }\n\n      setJob((prev) => ({\n        ...prev,\n        schedule_state: \"accepted\",\n        schedule_accepted_at: new Date().toISOString(),\n        status: \"scheduled\",\n      } as any));\n      addToast(\"Schedule accepted!\", \"success\");\n    } catch (err) {\n      console.error(\"Accept error:\", err);\n      addToast(\"Failed to accept schedule\", \"error\");\n    }\n  }\n\n  async function handleSaveAssignment() {\n    try {\n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          assigned_user_id: assignedUserId || null,\n          updated_at: new Date().toISOString(),\n        })\n        .eq(\"id\", job.id);\n\n      if (error) {\n        addToast(\"Failed to save assignment\", \"error\");\n        return;\n      }\n\n      setJob((prev) => ({\n        ...prev,\n        assigned_user_id: assignedUserId || null,\n      }));\n      addToast(\"Assignment saved\", \"success\");\n    } catch (err) {\n      console.error(\"Save error:\", err);\n      addToast(\"Failed to save assignment\", \"error\");\n    }\n  }\n\n  async function handleSaveNotes() {\n    try {\n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          notes: notes || null,\n          updated_at: new Date().toISOString(),\n        })\n        .eq(\"id\", job.id);\n\n      if (error) {\n        addToast(\"Failed to save notes\", \"error\");\n        return;\n      }\n\n      setJob((prev) => ({\n        ...prev,\n        notes: notes || null,\n      }));\n      setEditingNotes(false);\n      addToast(\"Notes saved\", \"success\");\n    } catch (err) {\n      console.error(\"Save error:\", err);\n      addToast(\"Failed to save notes\", \"error\");\n    }\n  }\n\n  async function handlePickupLocationChange(locationId: string | null) {\n    setSelectedPickupLocation(locationId);\n    // Save immediately for pickup location as it's a simple select\n    try {\n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          pickup_location_id: locationId,\n          updated_at: new Date().toISOString(),\n        })\n        .eq(\"id\", job.id);\n\n      if (error) {\n        addToast(\"Failed to save pickup location\", \"error\");\n        return;\n      }\n\n      setJob((prev) => ({\n        ...prev,\n        pickup_location_id: locationId,\n      } as any));\n      addToast(\"Pickup location saved\", \"success\");\n    } catch (err) {\n      console.error(\"Save error:\", err);\n      addToast(\"Failed to save pickup location\", \"error\");\n    }\n  }\n\n  async function handleAddTimeEntry() {\n    if (!newTimeEntry.hours || parseFloat(newTimeEntry.hours) <= 0) {\n      addToast(\"Please enter valid hours\", \"error\");\n      return;\n    }\n    if (!newTimeEntry.userId) {\n      addToast(\"Please select a worker\", \"error\");\n      return;\n    }\n\n    setAddingTimeEntry(true);\n    try {\n      const hours = parseFloat(newTimeEntry.hours);\n      const durationSeconds = Math.round(hours * 3600);\n      // Create start time as local date at 9 AM, then convert to ISO (UTC)\n      // Use local timezone to create the date, then convert to UTC\n      const localDate = new Date(`${newTimeEntry.date}T09:00:00`);\n      const startDateTime = localDate.toISOString();\n      const endDateTime = new Date(localDate.getTime() + durationSeconds * 1000).toISOString();\n\n      const { data, error } = await supabase\n        .from(\"time_entries\")\n        .insert({\n          job_id: job.id,\n          company_id: companyId,\n          user_id: newTimeEntry.userId,\n          started_at: startDateTime,\n          ended_at: endDateTime,\n          duration_seconds: durationSeconds,\n        })\n        .select(`\n          id,\n          user_id,\n          started_at,\n          ended_at,\n          duration_seconds,\n          user:user_id (full_name)\n        `)\n        .single();\n\n      if (error) throw error;\n\n      // Refresh time entries to get updated user info\n      const { data: refreshedEntries } = await supabase\n        .from(\"time_entries\")\n        .select(`\n          id,\n          user_id,\n          started_at,\n          ended_at,\n          duration_seconds\n        `)\n        .eq(\"job_id\", job.id)\n        .order(\"started_at\", { ascending: false });\n      \n      if (refreshedEntries) {\n        // Fetch user profiles\n        const userIds = [...new Set(refreshedEntries.map(e => e.user_id).filter((id): id is string => id !== null))];\n        let userMap: Record<string, { full_name: string }> = {};\n        \n        if (userIds.length > 0) {\n          const { data: profiles } = await supabase\n            .from(\"user_profiles\")\n            .select(\"id, full_name\")\n            .in(\"id\", userIds);\n          \n          if (profiles) {\n            userMap = profiles.reduce((acc, p) => {\n              acc[p.id] = { full_name: p.full_name || \"\" };\n              return acc;\n            }, {} as Record<string, { full_name: string }>);\n          }\n        }\n        \n        // Combine entries with user data\n        const entriesWithUsers = refreshedEntries.map(entry => ({\n          ...entry,\n          user: entry.user_id ? userMap[entry.user_id] : null,\n        }));\n        \n        setTimeEntries(entriesWithUsers as any);\n      }\n      \n      setNewTimeEntry({\n        userId: currentUserId,\n        hours: \"\",\n        date: new Date().toISOString().split(\"T\")[0],\n      });\n      addToast(\"Time entry added\", \"success\");\n    } catch (err) {\n      console.error(\"Failed to add time entry:\", err);\n      addToast(\"Failed to add time entry\", \"error\");\n    } finally {\n      setAddingTimeEntry(false);\n    }\n  }\n\n  async function handleUpdateTimeEntry(entryId: string, hours: number) {\n    const durationSeconds = Math.round(hours * 3600);\n    const entry = timeEntries.find(e => e.id === entryId);\n    if (!entry) return;\n\n    const startDateTime = entry.started_at;\n    const endDateTime = new Date(new Date(startDateTime).getTime() + durationSeconds * 1000).toISOString();\n\n    const { error } = await supabase\n      .from(\"time_entries\")\n      .update({\n        ended_at: endDateTime,\n        duration_seconds: durationSeconds,\n      })\n      .eq(\"id\", entryId);\n\n    if (error) {\n      addToast(\"Failed to update time entry\", \"error\");\n      return;\n    }\n\n    setTimeEntries((prev) =>\n      prev.map((e) =>\n        e.id === entryId\n          ? { ...e, ended_at: endDateTime, duration_seconds: durationSeconds }\n          : e\n      )\n    );\n    setEditingTimeEntry(null);\n    addToast(\"Time entry updated\", \"success\");\n  }\n\n  async function handleDeleteTimeEntry(entryId: string) {\n    const { error } = await supabase\n      .from(\"time_entries\")\n      .delete()\n      .eq(\"id\", entryId);\n\n    if (error) {\n      addToast(\"Failed to delete time entry\", \"error\");\n      return;\n    }\n\n    setTimeEntries((prev) => prev.filter((e) => e.id !== entryId));\n    addToast(\"Time entry deleted\", \"success\");\n  }\n\n  // Notes change handler (no auto-save)\n  function handleNotesChange(newNotes: string) {\n    setNotes(newNotes);\n  }\n\n  // Fetch pickup locations\n  useEffect(() => {\n    async function fetchPickupLocations() {\n      const { data } = await supabase\n        .from(\"pickup_locations\")\n        .select(\"id, name\")\n        .eq(\"company_id\", companyId)\n        .order(\"name\");\n      \n      if (data) {\n        setPickupLocations(data);\n      }\n    }\n    fetchPickupLocations();\n  }, [companyId]);\n\n  // Fetch time entries\n  useEffect(() => {\n    async function fetchTimeEntries() {\n      setLoadingTimeEntries(true);\n      const { data: entries } = await supabase\n        .from(\"time_entries\")\n        .select(`\n          id,\n          user_id,\n          started_at,\n          ended_at,\n          duration_seconds\n        `)\n        .eq(\"job_id\", job.id)\n        .order(\"started_at\", { ascending: false });\n      \n      if (entries) {\n        // Fetch user profiles for all unique user IDs\n        const userIds = [...new Set(entries.map(e => e.user_id).filter((id): id is string => id !== null))];\n        let userMap: Record<string, { full_name: string }> = {};\n        \n        if (userIds.length > 0) {\n          const { data: profiles } = await supabase\n            .from(\"user_profiles\")\n            .select(\"id, full_name\")\n            .in(\"id\", userIds);\n          \n          if (profiles) {\n            userMap = profiles.reduce((acc, p) => {\n              acc[p.id] = { full_name: p.full_name || \"\" };\n              return acc;\n            }, {} as Record<string, { full_name: string }>);\n          }\n        }\n        \n        // Combine entries with user data\n        const entriesWithUsers = entries.map(entry => ({\n          ...entry,\n          user: entry.user_id ? userMap[entry.user_id] : null,\n        }));\n        \n        setTimeEntries(entriesWithUsers as any);\n      }\n      setLoadingTimeEntries(false);\n    }\n    fetchTimeEntries();\n  }, [job.id, supabase, teamMembers]);\n\n  // Update newTimeEntry userId when currentUserId changes\n  useEffect(() => {\n    if (currentUserId && !newTimeEntry.userId) {\n      setNewTimeEntry(prev => ({ ...prev, userId: currentUserId }));\n    }\n  }, [currentUserId]);\n\n  // Fetch payment line items and estimate token\n  useEffect(() => {\n    async function fetchPaymentLineItems() {\n      const { data } = await supabase\n        .from(\"job_payment_line_items\")\n        .select(\"id, title, price\")\n        .eq(\"job_id\", job.id)\n        .order(\"sort_order\");\n      \n      if (data) {\n        setPaymentLineItems(data);\n      }\n\n      // Also fetch estimate record and line items for paint details\n      if (job.payment_state === \"proposed\" || job.payment_state === \"approved\") {\n        const { data: estimateData } = await supabase\n          .from(\"estimates\")\n          .select(\"id, public_token\")\n          .eq(\"job_id\", job.id)\n          .maybeSingle();\n        \n        if (estimateData?.public_token && estimatesList.length === 0) {\n          // Update estimatesList if we found an estimate\n          setEstimatesList([{ ...estimatesList[0] || {}, public_token: estimateData.public_token } as any]);\n        }\n      }\n    }\n    fetchPaymentLineItems();\n  }, [job.id, job.payment_state]);\n\n  // Sync schedule token from job\n  useEffect(() => {\n    if ((job as any).schedule_token && !scheduleToken) {\n      setScheduleToken((job as any).schedule_token);\n    }\n  }, [job, scheduleToken]);\n\n  // Refresh job data when window regains focus (catches external updates like customer acceptance)\n  useEffect(() => {\n    const handleFocus = () => {\n      router.refresh();\n    };\n    window.addEventListener('focus', handleFocus);\n    return () => window.removeEventListener('focus', handleFocus);\n  }, [router]);\n\n  function getNextStatus(currentStatus: JobStatus): JobStatus | null {\n    const currentIndex = JOB_STATUSES.indexOf(currentStatus);\n    if (currentIndex === -1 || currentIndex === JOB_STATUSES.length - 1) {\n      return null; // Already at the last status\n    }\n    return JOB_STATUSES[currentIndex + 1];\n  }\n\n  async function handleStatusChange(newStatus: JobStatus) {\n    const { error } = await supabase\n      .from(\"jobs\")\n      .update({ status: newStatus, updated_at: new Date().toISOString() })\n      .eq(\"id\", job.id);\n\n    if (error) {\n      addToast(\"Failed to update status\", \"error\");\n      return;\n    }\n\n    setJob((prev) => ({ ...prev, status: newStatus }));\n    addToast(\"Status updated!\", \"success\");\n    \n    // Force a refresh of the page to update the board view\n    router.refresh();\n  }\n\n  function handleMoveToNextStatus() {\n    const nextStatus = getNextStatus(job.status as JobStatus);\n    if (nextStatus) {\n      handleStatusChange(nextStatus);\n    }\n  }\n\n  async function handleAddMaterial(materialName?: string) {\n    if (materialName) {\n      // Quick add from common materials\n      const materialToAdd = materialName.trim();\n      if (!materialToAdd) return;\n\n      // Check if material already exists\n      if (materials.some(m => m.name.toLowerCase() === materialToAdd.toLowerCase())) {\n        addToast(\"Material already added\", \"error\");\n        return;\n      }\n\n      try {\n        const { data, error } = await supabase\n          .from(\"job_materials\")\n          .insert({\n            job_id: job.id,\n            name: materialToAdd,\n            checked: false,\n          })\n          .select()\n          .single();\n\n        if (error) {\n          const errorMessage = error?.message || error?.details || error?.hint || JSON.stringify(error) || \"Failed to add material\";\n          addToast(errorMessage, \"error\");\n          console.error(\"Error adding material:\", error);\n          return;\n        }\n\n        setMaterials((prev) => [...prev, data]);\n        setShowCommonMaterials(false);\n        addToast(\"Material added!\", \"success\");\n      } catch (error: any) {\n        console.error(\"Error adding material:\", error);\n        const errorMessage = error?.message || error?.details || error?.hint || JSON.stringify(error) || \"Failed to add material\";\n        addToast(errorMessage, \"error\");\n      }\n    } else {\n      // Show form for detailed material entry\n      setShowMaterialForm(true);\n    }\n  }\n\n  async function handleSubmitMaterialForm() {\n    const name = materialFormData.name.trim();\n    if (!name) {\n      addToast(\"Please enter a material name\", \"error\");\n      return;\n    }\n\n    // Validation for paint\n    if (materialType === \"paint\") {\n      if (!materialFormData.color.trim()) {\n        addToast(\"Please enter a color\", \"error\");\n        return;\n      }\n      if (!materialFormData.sheen) {\n        addToast(\"Please select a sheen\", \"error\");\n        return;\n      }\n      if (!materialFormData.area) {\n        addToast(\"Please select an area\", \"error\");\n        return;\n      }\n    }\n\n    // Build notes based on material type\n    const notesParts = [];\n    let quantityDecimal: number = 1; // Default to 1 if not specified\n    let unit: string | null = null;\n\n    if (materialType === \"paint\") {\n      // Paint: Brand, Color, Sheen, Product Line, Area, Notes\n      // Note: quantity is stored separately in quantity_decimal/unit fields\n      if (materialFormData.brand) notesParts.push(materialFormData.brand);\n      notesParts.push(materialFormData.color);\n      notesParts.push(materialFormData.sheen);\n      if (materialFormData.quantity) {\n        quantityDecimal = parseFloat(materialFormData.quantity);\n        unit = materialFormData.quantityUnit;\n      } else {\n        // Default unit for paint\n        unit = materialFormData.quantityUnit;\n      }\n      if (materialFormData.productLine) notesParts.push(`(${materialFormData.productLine})`);\n      if (materialFormData.area) notesParts.push(`- ${materialFormData.area}`);\n      if (materialFormData.notes) notesParts.push(`| ${materialFormData.notes}`);\n    } else {\n      // Generic: Notes only (quantity stored separately)\n      if (materialFormData.quantity) {\n        // Try to parse quantity for generic materials\n        const parsedQty = parseFloat(materialFormData.quantity);\n        if (!isNaN(parsedQty)) {\n          quantityDecimal = parsedQty;\n        }\n        unit = \"each\"; // Default unit for generic materials\n      } else {\n        unit = \"each\";\n      }\n      if (materialFormData.notes) notesParts.push(materialFormData.notes);\n    }\n\n    const notes = notesParts.length > 0 ? notesParts.join(\" â€¢ \") : null;\n\n    try {\n      const { data, error } = await supabase\n        .from(\"job_materials\")\n        .insert({\n          job_id: job.id,\n          name,\n          checked: false,\n          notes,\n          quantity_decimal: quantityDecimal,\n          unit,\n        })\n        .select()\n        .single();\n\n      if (error) {\n        const errorMessage = error?.message || error?.details || error?.hint || JSON.stringify(error) || \"Failed to add material\";\n        addToast(errorMessage, \"error\");\n        console.error(\"Error adding material:\", error);\n        return;\n      }\n\n      setMaterials((prev) => [...prev, data]);\n      setMaterialFormData({\n        name: \"\",\n        brand: \"\",\n        quantity: \"\",\n        quantityUnit: \"gal\",\n        color: \"\",\n        sheen: \"\",\n        productLine: \"\",\n        area: \"\",\n        notes: \"\",\n        showAdvanced: false\n      });\n      setShowMaterialForm(false);\n      setNewMaterial(\"\");\n      addToast(materialType === \"paint\" ? \"Paint added!\" : \"Material added!\", \"success\");\n    } catch (error: any) {\n      console.error(\"Error adding material:\", error);\n      const errorMessage = error?.message || error?.details || error?.hint || JSON.stringify(error) || \"Failed to add material\";\n      addToast(errorMessage, \"error\");\n    }\n  }\n\n  async function handleCreateInvoiceFromEstimate() {\n    const acceptedEstimate = estimatesList.find(e => e.status === \"accepted\");\n    if (!acceptedEstimate) {\n      addToast(\"No accepted estimate found\", \"error\");\n      return;\n    }\n\n    const total = acceptedEstimate.line_items.reduce((sum, li) => sum + li.price, 0);\n    setNewInvoiceAmount((total / 100).toFixed(2));\n    setShowAddInvoice(true);\n  }\n\n  function addEstimateLineItem() {\n    setEstimateLineItems((prev) => [...prev, { title: \"\", price: \"\" }]);\n  }\n\n  function updateEstimateLineItem(index: number, field: \"title\" | \"price\", value: string) {\n    setEstimateLineItems((prev) =>\n      prev.map((item, i) => (i === index ? { ...item, [field]: value } : item))\n    );\n  }\n\n  function removeEstimateLineItem(index: number) {\n    setEstimateLineItems((prev) => prev.filter((_, i) => i !== index));\n  }\n\n  async function handleAddEstimate() {\n    const validItems = estimateLineItems.filter(\n      (item) => item.title.trim() && item.price.trim() && parseFloat(item.price) > 0\n    );\n\n    if (validItems.length === 0) {\n      addToast(\"Please add at least one line item with title and price\", \"error\");\n      return;\n    }\n\n    setAddingEstimate(true);\n\n    try {\n      // Create estimate\n      const { data: estimate, error: estimateError } = await supabase\n        .from(\"estimates\")\n        .insert({\n          company_id: companyId,\n          job_id: job.id,\n          customer_id: job.customer_id || null,\n          status: \"draft\",\n          public_token: generateToken(24),\n        })\n        .select()\n        .single();\n\n      if (estimateError) {\n        console.error(\"Estimate insert error:\", estimateError);\n        throw estimateError;\n      }\n\n      if (!estimate) {\n        throw new Error(\"Estimate was not created\");\n      }\n\n      // Create line items\n      const lineItemsToInsert = validItems.map((item) => ({\n        estimate_id: estimate.id,\n        service_key: \"other\",\n        service_type: \"flat\" as const,\n        name: item.title.trim(),\n        description: \"\",\n        price: Math.round(parseFloat(item.price) * 100),\n      }));\n\n      const { error: itemError } = await supabase\n        .from(\"estimate_line_items\")\n        .insert(lineItemsToInsert);\n\n      if (itemError) {\n        console.error(\"Line item insert error:\", itemError);\n        throw itemError;\n      }\n\n      // Fetch the estimate with line items\n      const { data: lineItems } = await supabase\n        .from(\"estimate_line_items\")\n        .select(\"*\")\n        .eq(\"estimate_id\", estimate.id);\n\n      setEstimatesList((prev) => [{ ...estimate, line_items: lineItems || [] }, ...prev]);\n      setEstimateLineItems([{ title: \"\", price: \"\" }]);\n      setShowAddEstimate(false);\n      addToast(\"Estimate added!\", \"success\");\n    } catch (error: any) {\n      console.error(\"Error creating estimate:\", error);\n      const errorMessage = error?.message || error?.details || error?.hint || JSON.stringify(error) || \"Failed to create estimate\";\n      addToast(errorMessage, \"error\");\n    } finally {\n      setAddingEstimate(false);\n    }\n  }\n\n  async function handleAddInvoice() {\n    if (!newInvoiceAmount.trim()) {\n      addToast(\"Please enter an amount\", \"error\");\n      return;\n    }\n\n    const amountCents = Math.round(parseFloat(newInvoiceAmount) * 100);\n    if (!amountCents || amountCents <= 0) {\n      addToast(\"Please enter a valid amount\", \"error\");\n      return;\n    }\n\n    if (!job.customer_id) {\n      addToast(\"Job must have a customer to create invoice\", \"error\");\n      return;\n    }\n\n    setAddingInvoice(true);\n\n    try {\n      const { data: invoice, error } = await supabase\n        .from(\"invoices\")\n        .insert({\n          company_id: companyId,\n          job_id: job.id,\n          customer_id: job.customer_id,\n          amount_total: amountCents,\n          status: \"draft\",\n          public_token: generateToken(24),\n        })\n        .select()\n        .single();\n\n      if (error) {\n        console.error(\"Invoice insert error:\", error);\n        throw error;\n      }\n\n      if (!invoice) {\n        throw new Error(\"Invoice was not created\");\n      }\n\n      setInvoicesList((prev) => [invoice, ...prev]);\n      setNewInvoiceAmount(\"\");\n      setShowAddInvoice(false);\n      addToast(\"Invoice added!\", \"success\");\n    } catch (error: any) {\n      console.error(\"Error creating invoice:\", error);\n      const errorMessage = error?.message || error?.details || error?.hint || JSON.stringify(error) || \"Failed to create invoice\";\n      addToast(errorMessage, \"error\");\n    } finally {\n      setAddingInvoice(false);\n    }\n  }\n\n  async function handleToggleMaterial(materialId: string, checked: boolean) {\n    const material = materials.find(m => m.id === materialId);\n    if (!material) return;\n\n    const updates: any = { checked };\n\n    // Handle inventory consumption for jobs in progress or done\n    if (material.inventory_item_id && material.quantity_decimal) {\n      const shouldConsumeInventory = [\"in_progress\", \"done\"].includes(job.status);\n\n      if (shouldConsumeInventory) {\n        if (checked && !material.consumed_at) {\n          // Consume: decrement inventory\n          const { data: inventoryItem, error: fetchError } = await supabase\n            .from(\"inventory_items\")\n            .select(\"on_hand\")\n            .eq(\"id\", material.inventory_item_id)\n            .single();\n\n          if (!fetchError && inventoryItem) {\n            const newQuantity = Math.max(0, inventoryItem.on_hand - (material.quantity_decimal || 0));\n            await supabase\n              .from(\"inventory_items\")\n              .update({ on_hand: newQuantity })\n              .eq(\"id\", material.inventory_item_id);\n\n            updates.consumed_at = new Date().toISOString();\n          }\n        } else if (!checked && material.consumed_at) {\n          // Unconsume: increment inventory back\n          const { data: inventoryItem, error: fetchError } = await supabase\n            .from(\"inventory_items\")\n            .select(\"on_hand\")\n            .eq(\"id\", material.inventory_item_id)\n            .single();\n\n          if (!fetchError && inventoryItem) {\n            const newQuantity = inventoryItem.on_hand + (material.quantity_decimal || 0);\n            await supabase\n              .from(\"inventory_items\")\n              .update({ on_hand: newQuantity })\n              .eq(\"id\", material.inventory_item_id);\n\n            updates.consumed_at = null;\n          }\n        }\n      }\n    }\n\n    const { error } = await supabase\n      .from(\"job_materials\")\n      .update(updates)\n      .eq(\"id\", materialId);\n\n    if (error) {\n      addToast(\"Failed to update material\", \"error\");\n      return;\n    }\n\n    setMaterials((prev) =>\n      prev.map((m) => (m.id === materialId ? { ...m, ...updates } : m))\n    );\n  }\n\n  async function handleDeleteMaterial(materialId: string) {\n    const { error } = await supabase\n      .from(\"job_materials\")\n      .delete()\n      .eq(\"id\", materialId);\n\n    if (error) {\n      addToast(\"Failed to delete material\", \"error\");\n      return;\n    }\n\n    setMaterials((prev) => prev.filter((m) => m.id !== materialId));\n  }\n\n  async function handleUpdateMaterialCost(\n    materialId: string, \n    costPerUnit: number | null, \n    quantityDecimal: number | null,\n    unit: string | null\n  ) {\n    const { error } = await supabase\n      .from(\"job_materials\")\n      .update({ \n        cost_per_unit: costPerUnit,\n        quantity_decimal: quantityDecimal,\n        unit: unit\n      })\n      .eq(\"id\", materialId);\n\n    if (error) {\n      addToast(\"Failed to update cost\", \"error\");\n      return;\n    }\n\n    setMaterials((prev) =>\n      prev.map((m) => \n        m.id === materialId \n          ? { ...m, cost_per_unit: costPerUnit, quantity_decimal: quantityDecimal, unit: unit }\n          : m\n      )\n    );\n    setEditingCostId(null);\n  }\n\n  function copyScheduleConfirmationMessage() {\n    const token = scheduleToken || (job as any).schedule_token;\n    if (!token) {\n      addToast(\"Please generate a schedule link first\", \"error\");\n      return;\n    }\n    \n    const customerName = job.customer?.name || \"there\";\n    const dateStr = scheduledDate \n      ? (scheduledEndDate && scheduledEndDate !== scheduledDate\n          ? `${formatDate(scheduledDate)} - ${formatDate(scheduledEndDate)}`\n          : formatDate(scheduledDate))\n      : \"[date]\";\n    const timeStr = scheduledTime ? formatTime(scheduledTime) : \"[time]\";\n    const confirmUrl = `${typeof window !== \"undefined\" ? window.location.origin : \"\"}/s/${token}`;\n    const message = `Hey ${customerName} â€” we'd like to schedule your project for ${dateStr}${scheduledTime ? ` at ${timeStr}` : \"\"}. Please confirm this works for you: ${confirmUrl}`;\n    copyToClipboard(message);\n    addToast(\"Schedule confirmation message copied!\", \"success\");\n  }\n\n  function copyReminderMessage() {\n    const customerName = job.customer?.name || \"there\";\n    const dateStr = scheduledDate \n      ? (scheduledEndDate && scheduledEndDate !== scheduledDate\n          ? `${formatDate(scheduledDate)} - ${formatDate(scheduledEndDate)}`\n          : formatDate(scheduledDate))\n      : \"[date]\";\n    const timeStr = scheduledTime ? formatTime(scheduledTime) : \"[time]\";\n    const message = `Hey ${customerName} â€” just a reminder that we're scheduled for ${dateStr} at ${timeStr} at ${address || \"[address]\"}. Reply here if anything changes. See you then!`;\n    copyToClipboard(message);\n    addToast(\"Reminder message copied!\", \"success\");\n  }\n\n  function copyMaterialsList() {\n    if (materials.length === 0) {\n      addToast(\"No materials to copy\", \"error\");\n      return;\n    }\n\n    const jobTitle = job.title;\n    const customerName = job.customer?.name || \"Customer\";\n    \n    let message = `Materials needed for ${jobTitle} (${customerName}):\\n\\n`;\n    \n    materials.forEach((material, index) => {\n      let line = `${index + 1}. ${material.name}`;\n      \n      if (material.notes) {\n        line += ` - ${material.notes}`;\n      }\n      \n      // Add quantity and unit if available (on the same line)\n      if (material.quantity_decimal && material.unit) {\n        // Format the quantity nicely (remove unnecessary decimals)\n        const qty = material.quantity_decimal % 1 === 0 \n          ? material.quantity_decimal.toFixed(0) \n          : material.quantity_decimal;\n        line += ` - ${qty} ${material.unit}`;\n      }\n      \n      message += line + `\\n`;\n    });\n    \n    message += `\\nTotal items: ${materials.length}`;\n    \n    copyToClipboard(message);\n    addToast(\"Materials list copied!\", \"success\");\n  }\n\n  function copyEstimateMessage() {\n    const customerName = job.customer?.name || \"there\";\n    const latestEstimate = estimatesList[0];\n    const estimateUrl = latestEstimate\n      ? `${typeof window !== \"undefined\" ? window.location.origin : \"\"}/e/${latestEstimate.public_token}`\n      : \"[estimate link]\";\n    const total = latestEstimate\n      ? formatCurrency(latestEstimate.line_items.reduce((sum, li) => sum + li.price, 0))\n      : \"[amount]\";\n    const message = `Hey ${customerName} â€” here's your estimate for ${total}: ${estimateUrl}. Let me know if you have any questions!`;\n    copyToClipboard(message);\n    addToast(\"Estimate message copied!\", \"success\");\n  }\n\n  function copyPaymentRequestMessage() {\n    const customerName = job.customer?.name || \"there\";\n    const latestInvoice = invoicesList[0];\n    const invoiceUrl = latestInvoice\n      ? `${typeof window !== \"undefined\" ? window.location.origin : \"\"}/i/${latestInvoice.public_token}`\n      : \"[invoice link]\";\n    const amount = latestInvoice\n      ? formatCurrency(latestInvoice.amount_total)\n      : \"[amount]\";\n    const message = `Hey ${customerName} â€” thanks again for letting us work on your project! Here's your invoice for ${amount}: ${invoiceUrl}. Let us know if you have any questions!`;\n    copyToClipboard(message);\n    addToast(\"Invoice message copied!\", \"success\");\n  }\n\n  function getScheduleLink() {\n    const token = scheduleToken || (job as any).schedule_token;\n    if (!token) return \"\";\n    return `${typeof window !== \"undefined\" ? window.location.origin : \"\"}/s/${token}`;\n  }\n\n  function getScheduleMessage() {\n    const customerName = job.customer?.name || \"there\";\n    const companyName = \"\"; // You can add company name from context if needed\n    const dateStr = scheduledDate \n      ? (scheduledEndDate && scheduledEndDate !== scheduledDate\n          ? `${formatDate(scheduledDate)} - ${formatDate(scheduledEndDate)}`\n          : formatDate(scheduledDate))\n      : \"TBD\";\n    const timeStr = scheduledTime ? formatTime(scheduledTime) : \"TBD\";\n    const link = getScheduleLink();\n    \n    return `Hi ${customerName}${companyName ? `, this is ${companyName}` : \"\"}. We're scheduled for ${dateStr}${scheduledTime ? ` at ${timeStr}` : \"\"}. Confirm your appointment here: ${link}`;\n  }\n\n  function copyScheduleLink() {\n    copyToClipboard(getScheduleLink());\n    addToast(\"Schedule link copied!\", \"success\");\n  }\n\n  function copyScheduleMessage() {\n    copyToClipboard(getScheduleMessage());\n    addToast(\"Schedule message copied!\", \"success\");\n  }\n\n  async function handleDuplicateJob() {\n    setDuplicating(true);\n\n    try {\n      // Create the duplicate job\n      const { data: newJob, error: jobError } = await supabase\n        .from(\"jobs\")\n        .insert({\n          company_id: companyId,\n          customer_id: job.customer_id,\n          title: `${job.title} (Copy)`,\n          address1: job.address1,\n          address2: job.address2,\n          city: job.city,\n          state: job.state,\n          zip: job.zip,\n          notes: job.notes,\n          assigned_user_id: job.assigned_user_id,\n          status: \"new\",\n        })\n        .select()\n        .single();\n\n      if (jobError) throw jobError;\n\n      // Copy materials\n      if (materials.length > 0) {\n        const materialsToInsert = materials.map((m) => ({\n          job_id: newJob.id,\n          name: m.name,\n          notes: m.notes,\n          checked: false, // Reset checked status\n        }));\n\n        const { error: materialsError } = await supabase\n          .from(\"job_materials\")\n          .insert(materialsToInsert);\n\n        if (materialsError) {\n          console.error(\"Error copying materials:\", materialsError);\n          // Don't fail the whole operation, just warn\n          addToast(\"Job duplicated but materials may not have copied\", \"error\");\n        }\n      }\n\n      addToast(`Job duplicated! New job ID: ${newJob.id}`, \"success\");\n      copyToClipboard(newJob.id);\n      setShowDuplicateDialog(false);\n      router.push(`/app/jobs/${newJob.id}`);\n    } catch (error) {\n      console.error(\"Error duplicating job:\", error);\n      addToast(\"Failed to duplicate job\", \"error\");\n    } finally {\n      setDuplicating(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen pb-20 lg:pb-0\">\n      {/* Header */}\n      <div className=\"border-b bg-card\">\n        <div className=\"max-w-4xl mx-auto p-4\">\n          <button\n            onClick={() => router.back()}\n            className=\"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-4 touch-target\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back\n          </button>\n\n          <div className=\"flex flex-col gap-4\">\n            <div className=\"flex items-start justify-between gap-4\">\n              <div className=\"flex-1 min-w-0\">\n                <h1 className=\"text-xl sm:text-2xl font-bold truncate\">{job.title}</h1>\n                {job.customer && (\n                  <p className=\"text-muted-foreground flex items-center gap-1 mt-1 text-sm sm:text-base min-w-0\">\n                    <User className=\"h-4 w-4 shrink-0\" />\n                    <span className=\"truncate\">{job.customer.name}</span>\n                  </p>\n                )}\n              </div>\n              <div className=\"flex items-center gap-2 flex-shrink-0\">\n                <Badge className={cn(\"w-fit text-base px-4 py-2\", JOB_STATUS_COLORS[job.status as JobStatus])}>\n                  {JOB_STATUS_LABELS[job.status as JobStatus]}\n                </Badge>\n                {getNextStatus(job.status as JobStatus) && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleMoveToNextStatus}\n                    className=\"touch-target min-h-[44px]\"\n                    title={`Move to ${JOB_STATUS_LABELS[getNextStatus(job.status as JobStatus)!]}`}\n                  >\n                    <ChevronRight className=\"h-4 w-4\" />\n                  </Button>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"max-w-4xl mx-auto p-4\">\n        <div className=\"space-y-6\">\n          {/* Main content */}\n          <div className=\"space-y-6\">\n            {/* Quick Info */}\n            <div className=\"rounded-lg border bg-card p-2.5\">\n              <div className=\"flex flex-wrap items-center gap-x-4 gap-y-1 text-sm\">\n                {address && (\n                  <div className=\"flex items-center gap-1.5\">\n                    <MapPin className=\"h-4 w-4 text-muted-foreground shrink-0\" />\n                    <span>{address}</span>\n                  </div>\n                )}\n                {job.customer?.phone && (\n                  <div className=\"flex items-center gap-1.5\">\n                    <Phone className=\"h-4 w-4 text-muted-foreground shrink-0\" />\n                    <a \n                      href={`tel:${job.customer.phone}`} \n                      className=\"hover:underline\"\n                    >\n                      {job.customer.phone}\n                    </a>\n                  </div>\n                )}\n                {job.customer?.email && (\n                  <div className=\"flex items-center gap-1.5\">\n                    <Mail className=\"h-4 w-4 text-muted-foreground shrink-0\" />\n                    <a \n                      href={`mailto:${job.customer.email}`} \n                      className=\"hover:underline\"\n                    >\n                      {job.customer.email}\n                    </a>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* All sections in one view */}\n            <div className=\"space-y-6\">\n              {/* Unified Payment Section (replaces Estimate + Invoice) */}\n              <UnifiedPayment\n                jobId={job.id}\n                companyId={companyId}\n                customerId={job.customer_id}\n                paymentState={(job.payment_state as any) || \"none\"}\n                paymentAmount={job.payment_amount || null}\n                paymentApprovedAt={job.payment_approved_at || null}\n                paymentPaidAt={job.payment_paid_at || null}\n                paymentMethod={job.payment_method || null}\n                publicToken={estimatesList[0]?.public_token}\n                lineItems={paymentLineItems}\n                estimatingConfig={estimatingConfig}\n                estimateStatus={estimatesList[0]?.status || null}\n                estimateDeniedAt={estimatesList[0]?.denied_at || null}\n                estimateDenialReason={estimatesList[0]?.denial_reason || null}\n                onUpdate={async () => {\n                  // Refresh just the estimates list without full page reload\n                  const { data: estimatesData } = await supabase\n                    .from(\"estimates\")\n                    .select(\"*\")\n                    .eq(\"job_id\", job.id)\n                    .order(\"created_at\", { ascending: false });\n\n                  if (estimatesData) {\n                    const estimatesWithLineItems = await Promise.all(\n                      estimatesData.map(async (est) => {\n                        const { data: lineItems } = await supabase\n                          .from(\"estimate_line_items\")\n                          .select(\"*\")\n                          .eq(\"estimate_id\", est.id);\n                        return { ...est, line_items: lineItems || [] };\n                      })\n                    );\n                    setEstimatesList(estimatesWithLineItems);\n                  }\n                }}\n              />\n\n              {/* Scheduling Section */}\n              <div className=\"rounded-lg border bg-card p-4 space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <h3 className=\"font-semibold\">Schedule</h3>\n                    {(job as any).schedule_state === \"accepted\" && (\n                      <Badge variant=\"success\">\n                        <CheckCircle className=\"h-3 w-3 mr-1\" />\n                        Confirmed\n                      </Badge>\n                    )}\n                    {((job as any).schedule_state === \"proposed\" || (job as any).schedule_state === \"awaiting_confirmation\") && (\n                      <Badge variant=\"secondary\">Awaiting Confirmation</Badge>\n                    )}\n                    {(job as any).schedule_state === \"denied\" && (\n                      <Badge variant=\"destructive\">Declined by Customer</Badge>\n                    )}\n                  </div>\n                  {scheduledDate && scheduledTime && !editingSchedule && (\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => setEditingSchedule(true)}\n                      className=\"touch-target min-h-[44px]\"\n                    >\n                      <Pencil className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n                </div>\n\n                {editingSchedule || !scheduledDate || !scheduledTime ? (\n                  /* Edit/Set Schedule Form */\n                  <div className=\"space-y-4\">\n                    <DateTimePicker\n                      date={scheduledDate || null}\n                      time={scheduledTime || null}\n                      onDateChange={(date) => setScheduledDate(date)}\n                      onTimeChange={(time) => setScheduledTime(time)}\n                      label={isMultiDay ? \"Start date and daily arrival time\" : \"Date and time\"}\n                    />\n\n                    {/* Multi-day toggle */}\n                    <div className=\"flex items-center gap-3 p-3 rounded-lg border bg-muted/30\">\n                      <input\n                        type=\"checkbox\"\n                        id=\"multiDayToggle\"\n                        checked={isMultiDay}\n                        onChange={(e) => {\n                          setIsMultiDay(e.target.checked);\n                          if (!e.target.checked) {\n                            setScheduledEndDate(\"\");\n                          }\n                        }}\n                        className=\"h-4 w-4 rounded border-gray-300 text-primary focus:ring-2 focus:ring-primary cursor-pointer\"\n                      />\n                      <label htmlFor=\"multiDayToggle\" className=\"text-sm font-medium cursor-pointer flex-1\">\n                        Multi-day job\n                      </label>\n                    </div>\n\n                    {/* End date field - only visible when multi-day is enabled */}\n                    {isMultiDay && (\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium\">\n                          End date\n                        </label>\n                        <input\n                          type=\"date\"\n                          value={scheduledEndDate}\n                          onChange={(e) => setScheduledEndDate(e.target.value)}\n                          min={scheduledDate || undefined}\n                          className=\"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 min-h-[44px]\"\n                        />\n                        {scheduledEndDate && scheduledEndDate < scheduledDate && (\n                          <p className=\"text-xs text-destructive flex items-center gap-1\">\n                            <span>âš ï¸</span>\n                            End date must be after start date\n                          </p>\n                        )}\n                        {scheduledEndDate && scheduledEndDate >= scheduledDate && scheduledTime && (\n                          <div className=\"p-3 rounded-lg bg-primary/10 border border-primary/20\">\n                            <p className=\"text-xs text-foreground flex items-start gap-2\">\n                              <Calendar className=\"h-4 w-4 text-primary shrink-0 mt-0.5\" />\n                              <span>\n                                Crew will arrive at <strong>{formatTime(scheduledTime)}</strong> each day from <strong>{formatDate(scheduledDate)}</strong> to <strong>{formatDate(scheduledEndDate)}</strong>\n                              </span>\n                            </p>\n                          </div>\n                        )}\n                      </div>\n                    )}\n\n                    <div className=\"flex flex-col sm:flex-row gap-2\">\n                      {scheduledDate && scheduledTime && (\n                        <Button\n                          variant=\"outline\"\n                          onClick={() => {\n                            setEditingSchedule(false);\n                            // Reset to saved values\n                            setScheduledDate(job.scheduled_date || \"\");\n                            setScheduledEndDate(job.scheduled_end_date || \"\");\n                            setScheduledTime(job.scheduled_time || \"\");\n                            setIsMultiDay(!!job.scheduled_end_date);\n                          }}\n                          className=\"w-full sm:w-auto\"\n                        >\n                          Cancel\n                        </Button>\n                      )}\n                      <Button onClick={handleSaveSchedule} className=\"w-full sm:flex-1\">\n                        <Calendar className=\"mr-2 h-4 w-4\" />\n                        {scheduledDate && scheduledTime && job.scheduled_date ? \"Update Schedule\" : \"Save Schedule\"}\n                      </Button>\n                    </div>\n                  </div>\n                ) : (\n                  /* Schedule Summary */\n                  <>\n                    <div className=\"p-3 sm:p-4 rounded-lg bg-muted/30 space-y-3\">\n                      <div className=\"flex items-start gap-2 sm:gap-3 min-w-0\">\n                        <Calendar className=\"h-4 w-4 sm:h-5 sm:w-5 text-primary shrink-0 mt-1\" />\n                        <div className=\"flex-1 min-w-0\">\n                          <p className=\"text-xs sm:text-sm text-muted-foreground\">\n                            {scheduledEndDate && scheduledEndDate !== scheduledDate ? \"Date Range\" : \"Date\"}\n                          </p>\n                          <p className=\"font-medium text-sm sm:text-base break-words\">\n                            {scheduledEndDate && scheduledEndDate !== scheduledDate\n                              ? `${formatDate(scheduledDate)} - ${formatDate(scheduledEndDate)}`\n                              : formatDate(scheduledDate)}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-start gap-2 sm:gap-3 min-w-0\">\n                        <Clock className=\"h-4 w-4 sm:h-5 sm:w-5 text-primary shrink-0 mt-1\" />\n                        <div className=\"flex-1 min-w-0\">\n                          <p className=\"text-xs sm:text-sm text-muted-foreground\">\n                            {scheduledEndDate && scheduledEndDate !== scheduledDate ? \"Daily Arrival Time\" : \"Time\"}\n                          </p>\n                          <p className=\"font-medium text-sm sm:text-base\">{formatTime(scheduledTime)}</p>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Actions */}\n                    {((job as any).schedule_state === \"proposed\" || (job as any).schedule_state === \"awaiting_confirmation\") && (\n                      <div className=\"flex flex-col sm:flex-row gap-2\">\n                        <Button\n                          variant=\"outline\"\n                          onClick={async () => {\n                            await ensureScheduleToken();\n                            setShowShareScheduleDialog(true);\n                          }}\n                          className=\"w-full sm:flex-1\"\n                        >\n                          <Share2 className=\"mr-2 h-4 w-4\" />\n                          Share with Customer\n                        </Button>\n                        <Button\n                          onClick={handleAcceptSchedule}\n                          className=\"w-full sm:flex-1\"\n                        >\n                          <CheckCircle className=\"mr-2 h-4 w-4\" />\n                          Mark Confirmed\n                        </Button>\n                      </div>\n                    )}\n\n                    {(job as any).schedule_state === \"accepted\" && (\n                      <div className=\"p-3 rounded-lg bg-success/10 border border-success/20 text-sm\">\n                        <p className=\"flex items-center gap-2 text-success\">\n                          <CheckCircle className=\"h-4 w-4\" />\n                          <span>Customer confirmed on {formatDate((job as any).schedule_accepted_at)}</span>\n                        </p>\n                      </div>\n                    )}\n\n                    {(job as any).schedule_state === \"denied\" && (\n                      <div className=\"p-3 rounded-lg bg-destructive/10 border border-destructive/20 space-y-2\">\n                        <p className=\"flex items-center gap-2 text-destructive text-sm font-medium\">\n                          <XCircle className=\"h-4 w-4\" />\n                          Customer declined this schedule\n                        </p>\n                        {(job as any).schedule_denial_reason && (\n                          <p className=\"text-sm text-muted-foreground pl-6\">\n                            Reason: {(job as any).schedule_denial_reason}\n                          </p>\n                        )}\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => setEditingSchedule(true)}\n                          className=\"w-full sm:w-auto\"\n                        >\n                          <Calendar className=\"mr-2 h-4 w-4\" />\n                          Propose New Time\n                        </Button>\n                      </div>\n                    )}\n\n                    {!((job as any).schedule_state) && (\n                      <Button\n                        variant=\"outline\"\n                        onClick={async () => {\n                          await ensureScheduleToken();\n                          setShowShareScheduleDialog(true);\n                        }}\n                        className=\"w-full\"\n                      >\n                        <Share2 className=\"mr-2 h-4 w-4\" />\n                        Share with Customer\n                      </Button>\n                    )}\n                  </>\n                )}\n              </div>\n\n              {/* Materials Section */}\n                <div className=\"rounded-lg border bg-card p-4 space-y-6\">\n                  {!editingMaterials && materials.length > 0 ? (\n                    <div>\n                      <div className=\"flex items-center justify-between mb-3\">\n                        <h3 className=\"font-semibold text-lg\">Materials ({materials.length})</h3>\n                        <div className=\"flex items-center gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => {\n                              setCopyDialogType(\"materials\");\n                              setShowCopyDialog(true);\n                            }}\n                            className=\"touch-target min-h-[44px]\"\n                          >\n                            <Share2 className=\"mr-2 h-4 w-4\" />\n                            Share List\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => setEditingMaterials(true)}\n                            className=\"touch-target min-h-[44px]\"\n                          >\n                            <Pencil className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                      {/* Simplified view */}\n                      <div className=\"space-y-2\">\n                        {materials.slice(0, 5).map((material) => (\n                          <div key={material.id} className=\"flex items-start gap-3 p-2 rounded-lg hover:bg-muted/50\">\n                            <SimpleCheckbox\n                              checked={material.checked}\n                              onChange={(e) =>\n                                handleToggleMaterial(material.id, e.target.checked)\n                              }\n                              className=\"mt-0.5\"\n                            />\n                            <div className=\"flex-1 min-w-0\">\n                              <span\n                                className={cn(\n                                  \"font-medium text-sm\",\n                                  material.checked && \"line-through text-muted-foreground\"\n                                )}\n                              >\n                                {material.name}\n                              </span>\n                              {material.notes && (\n                                <p className=\"text-xs text-muted-foreground mt-0.5\">\n                                  {material.notes}\n                                </p>\n                              )}\n                              {(material.quantity_decimal || material.unit) && (\n                                <p className=\"text-xs text-muted-foreground\">\n                                  {material.quantity_decimal && `${material.quantity_decimal} `}\n                                  {material.unit || 'each'}\n                                </p>\n                              )}\n                            </div>\n                          </div>\n                        ))}\n                        {materials.length > 5 && (\n                          <p className=\"text-xs text-muted-foreground pt-1 pl-2\">\n                            +{materials.length - 5} more\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  ) : (\n                    <>\n                      <div className=\"flex items-center justify-between\">\n                        <h3 className=\"font-semibold text-lg\">Materials</h3>\n                        <div className=\"flex items-center gap-2\">\n                          {materials.length > 0 && (\n                            <Button\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => {\n                                setCopyDialogType(\"materials\");\n                                setShowCopyDialog(true);\n                              }}\n                              className=\"touch-target min-h-[44px]\"\n                            >\n                              <Share2 className=\"mr-2 h-4 w-4\" />\n                              Share List\n                            </Button>\n                          )}\n                          {editingMaterials && materials.length > 0 && (\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={() => setEditingMaterials(false)}\n                            >\n                              <X className=\"h-4 w-4\" />\n                            </Button>\n                          )}\n                        </div>\n                      </div>\n                  \n                  {/* Checklist Subsection */}\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <h4 className=\"font-medium text-sm\">Checklist ({materials.length})</h4>\n                      {materials.length > 0 && (\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={copyMaterialsList}\n                          className=\"touch-target min-h-[44px]\"\n                        >\n                          <Copy className=\"mr-2 h-4 w-4\" />\n                          Copy List\n                        </Button>\n                      )}\n                    </div>\n\n                    {/* Smart Presets - Quick Add */}\n                    <div className=\"space-y-2\">\n                      <Label className=\"text-sm text-muted-foreground\">Quick Add</Label>\n                      <div className=\"grid grid-cols-2 gap-2\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setMaterialType(\"paint\");\n                            setMaterialFormData({\n                              name: \"Paint\",\n                              brand: \"\",\n                              color: \"\",\n                              sheen: \"\",\n                              quantity: \"\",\n                              quantityUnit: \"gal\",\n                              productLine: \"\",\n                              area: \"\",\n                              notes: \"\",\n                              showAdvanced: false\n                            });\n                            setShowMaterialForm(true);\n                          }}\n                          className=\"touch-target min-h-[44px] justify-start\"\n                        >\n                          <Plus className=\"mr-2 h-4 w-4\" />\n                          Paint\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setMaterialType(\"generic\");\n                            setMaterialFormData({\n                              name: \"\",\n                              brand: \"\",\n                              color: \"\",\n                              sheen: \"\",\n                              quantity: \"\",\n                              quantityUnit: \"gal\",\n                              productLine: \"\",\n                              area: \"\",\n                              notes: \"\",\n                              showAdvanced: false\n                            });\n                            setShowMaterialForm(true);\n                          }}\n                          className=\"touch-target min-h-[44px] justify-start\"\n                        >\n                          <Plus className=\"mr-2 h-4 w-4\" />\n                          Custom\n                        </Button>\n                      </div>\n                    </div>\n\n                    {/* Materials List */}\n                    <div className=\"rounded-lg border bg-muted/30 divide-y\">\n                      {materials.length === 0 ? (\n                        <div className=\"p-8 text-center text-muted-foreground\">\n                          <Package className=\"mx-auto h-8 w-8 mb-2\" />\n                          <p className=\"text-sm\">No materials yet</p>\n                          <p className=\"text-xs mt-1\">Use Quick Add buttons above</p>\n                        </div>\n                      ) : (\n                        materials.map((material) => (\n                          <div\n                            key={material.id}\n                            className=\"p-3 space-y-2\"\n                          >\n                            <div className=\"flex items-center gap-3\">\n                              <SimpleCheckbox\n                                checked={material.checked}\n                                onChange={(e) =>\n                                  handleToggleMaterial(material.id, e.target.checked)\n                                }\n                              />\n                              <div className=\"flex-1\">\n                                <span\n                                  className={cn(\n                                    \"font-medium\",\n                                    material.checked && \"line-through text-muted-foreground\"\n                                  )}\n                                >\n                                  {material.name}\n                                </span>\n                                {material.notes && (\n                                  <p className=\"text-xs text-muted-foreground mt-0.5\">\n                                    {material.notes}\n                                  </p>\n                                )}\n                              </div>\n                              <button\n                                onClick={() => handleDeleteMaterial(material.id)}\n                                className=\"text-muted-foreground hover:text-destructive touch-target min-h-[44px] min-w-[44px] flex items-center justify-center\"\n                              >\n                                <Trash2 className=\"h-4 w-4\" />\n                              </button>\n                            </div>\n                            \n                            {/* Cost Tracking (Optional) */}\n                            {editingCostId === material.id ? (\n                              <div className=\"flex items-center gap-2 text-sm pl-8\">\n                                <span className=\"text-muted-foreground\">$</span>\n                                <Input\n                                  type=\"number\"\n                                  step=\"0.01\"\n                                  min=\"0\"\n                                  placeholder=\"0.00\"\n                                  defaultValue={material.cost_per_unit || ''}\n                                  className=\"w-20 h-8 text-sm\"\n                                  id={`cost-${material.id}`}\n                                />\n                                <span className=\"text-muted-foreground\">per</span>\n                                <Input\n                                  type=\"text\"\n                                  placeholder=\"unit\"\n                                  defaultValue={material.unit || 'each'}\n                                  className=\"w-20 h-8 text-sm\"\n                                  id={`unit-${material.id}`}\n                                />\n                                <span className=\"text-muted-foreground\">Ã—</span>\n                                <Input\n                                  type=\"number\"\n                                  step=\"0.01\"\n                                  min=\"0\"\n                                  placeholder=\"qty\"\n                                  defaultValue={material.quantity_decimal || ''}\n                                  className=\"w-16 h-8 text-sm\"\n                                  id={`qty-${material.id}`}\n                                />\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  className=\"h-8\"\n                                  onClick={() => {\n                                    const costInput = document.getElementById(`cost-${material.id}`) as HTMLInputElement;\n                                    const unitInput = document.getElementById(`unit-${material.id}`) as HTMLInputElement;\n                                    const qtyInput = document.getElementById(`qty-${material.id}`) as HTMLInputElement;\n                                    handleUpdateMaterialCost(\n                                      material.id,\n                                      costInput.value ? parseFloat(costInput.value) : null,\n                                      qtyInput.value ? parseFloat(qtyInput.value) : null,\n                                      unitInput.value || null\n                                    );\n                                  }}\n                                >\n                                  Save\n                                </Button>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  className=\"h-8\"\n                                  onClick={() => setEditingCostId(null)}\n                                >\n                                  Cancel\n                                </Button>\n                              </div>\n                            ) : material.cost_per_unit ? (\n                              <div className=\"flex items-center justify-between text-sm pl-8\">\n                                <span className=\"text-muted-foreground\">\n                                  {formatCurrency(Math.round(material.cost_per_unit * 100))} per {material.unit || 'each'}\n                                  {material.quantity_decimal && ` Ã— ${material.quantity_decimal}`}\n                                  {material.quantity_decimal && material.cost_per_unit && (\n                                    <span className=\"font-medium ml-2\">\n                                      = {formatCurrency(Math.round(material.cost_per_unit * material.quantity_decimal * 100))}\n                                    </span>\n                                  )}\n                                </span>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  className=\"h-6 text-xs\"\n                                  onClick={() => setEditingCostId(material.id)}\n                                >\n                                  Edit\n                                </Button>\n                              </div>\n                            ) : (\n                              <div className=\"pl-8\">\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  className=\"h-6 text-xs text-muted-foreground\"\n                                  onClick={() => setEditingCostId(material.id)}\n                                >\n                                  + Add cost\n                                </Button>\n                              </div>\n                            )}\n                          </div>\n                        ))\n                      )}\n                    </div>\n                    \n                    {/* Materials Cost Summary */}\n                    {(() => {\n                      const materialsWithCost = materials.filter(m => m.cost_per_unit && m.quantity_decimal);\n                      if (materialsWithCost.length === 0) return null;\n                      \n                      const totalCost = materialsWithCost.reduce(\n                        (sum, m) => sum + ((m.cost_per_unit || 0) * (m.quantity_decimal || 0)),\n                        0\n                      );\n                      const allHaveCosts = materials.length === materialsWithCost.length;\n                      const invoice = invoicesList[0];\n                      \n                      return (\n                        <div className=\"rounded-lg border bg-muted/50 p-3 space-y-2 text-sm\">\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-muted-foreground\">\n                              Materials Total{!allHaveCosts && <span className=\"text-xs ml-1\">(partial)</span>}\n                            </span>\n                            <span className=\"font-medium\">{formatCurrency(Math.round(totalCost * 100))}</span>\n                          </div>\n                          \n                          {invoice && (\n                            <>\n                              <div className=\"flex justify-between\">\n                                <span className=\"text-muted-foreground\">Invoice Total</span>\n                                <span className=\"font-medium\">{formatCurrency(invoice.amount_total)}</span>\n                              </div>\n                              <div className=\"h-px bg-border\" />\n                              <div className=\"flex justify-between font-semibold\">\n                                <span>Estimated Margin</span>\n                                <span className={cn(\n                                  (invoice.amount_total - Math.round(totalCost * 100)) > 0 \n                                    ? 'text-success' \n                                    : 'text-destructive'\n                                )}>\n                                  {formatCurrency(invoice.amount_total - Math.round(totalCost * 100))}\n                                  <span className=\"text-xs ml-1 font-normal\">\n                                    ({Math.round(((invoice.amount_total - Math.round(totalCost * 100)) / invoice.amount_total) * 100)}%)\n                                  </span>\n                                </span>\n                              </div>\n                              <p className=\"text-xs text-muted-foreground\">\n                                âš ï¸ Materials only - doesn't include labor or overhead\n                              </p>\n                            </>\n                          )}\n                        </div>\n                      );\n                    })()}\n                    \n                  </div>\n                    </>\n                  )}\n                </div>\n\n              {/* Assign To Section */}\n              <div className=\"rounded-lg border bg-card p-4\">\n                {!editingAssignment ? (\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <h3 className=\"font-semibold mb-1\">Assign To</h3>\n                      <div className=\"text-sm text-muted-foreground\">\n                        {assignedUserId ? (\n                          <span>{teamMembers.find(m => m.id === assignedUserId)?.fullName || 'Unknown'}</span>\n                        ) : (\n                          <span>Unassigned</span>\n                        )}\n                      </div>\n                    </div>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => setEditingAssignment(true)}\n                      className=\"touch-target min-h-[44px]\"\n                    >\n                      <Pencil className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                ) : (\n                  <div className=\"flex items-center gap-2\">\n                    <Label htmlFor=\"assignedUser\" className=\"text-sm font-medium whitespace-nowrap shrink-0\">\n                      Who's working on this?\n                    </Label>\n                    <Select\n                      id=\"assignedUser\"\n                      value={assignedUserId}\n                      onChange={(e) => setAssignedUserId(e.target.value)}\n                      className=\"flex-1 h-9\"\n                    >\n                      <option value=\"\">Unassigned</option>\n                      {teamMembers.map((member) => (\n                        <option key={member.id} value={member.id}>\n                          {member.fullName}\n                        </option>\n                      ))}\n                    </Select>\n                    <Button \n                      onClick={async () => {\n                        await handleSaveAssignment();\n                        setEditingAssignment(false);\n                      }} \n                      className=\"shrink-0 h-9\"\n                    >\n                      Save\n                    </Button>\n                  </div>\n                )}\n              </div>\n\n              {/* Notes Section */}\n              <div className=\"rounded-lg border bg-card p-4 space-y-4\">\n                {!editingNotes && notes ? (\n                  <div>\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <h3 className=\"font-semibold\">Notes</h3>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => setEditingNotes(true)}\n                        className=\"touch-target min-h-[44px]\"\n                      >\n                        <Pencil className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                    <p className=\"text-sm whitespace-pre-wrap\">{notes}</p>\n                  </div>\n                ) : (\n                  <>\n                    <div className=\"flex items-center justify-between\">\n                      <h3 className=\"font-semibold\">Notes</h3>\n                      {editingNotes && notes && (\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => setEditingNotes(false)}\n                        >\n                          <X className=\"h-4 w-4\" />\n                        </Button>\n                      )}\n                    </div>\n                    <Textarea\n                      value={notes}\n                      onChange={(e) => handleNotesChange(e.target.value)}\n                      placeholder=\"Add notes about this job...\"\n                      rows={4}\n                    />\n                    <Button onClick={handleSaveNotes} className=\"w-full\">\n                      <Save className=\"mr-2 h-4 w-4\" />\n                      Save Notes\n                    </Button>\n                  </>\n                )}\n              </div>\n\n              {/* Tracking Section */}\n              <div className=\"rounded-lg border bg-card p-4 space-y-4\">\n                {!editingTracking && timeEntries.length > 0 ? (\n                  <div>\n                    <div className=\"flex items-center justify-between mb-3\">\n                      <h3 className=\"font-semibold\">Time Tracking</h3>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => setEditingTracking(true)}\n                        className=\"touch-target min-h-[44px]\"\n                      >\n                        <Pencil className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                    {/* Simplified view - show workers and total hours */}\n                    <div className=\"space-y-2\">\n                      {(() => {\n                        // Group entries by user\n                        const groupedByUser = timeEntries.reduce((acc, entry) => {\n                          const userId = entry.user_id || 'unknown';\n                          const userName = userId !== 'unknown' \n                            ? (teamMembers.find(m => m.id === userId)?.fullName || entry.user?.full_name || 'Unknown')\n                            : 'Unknown';\n                          if (!acc[userId]) {\n                            acc[userId] = { name: userName, totalHours: 0, entries: [] };\n                          }\n                          const hours = entry.duration_seconds ? entry.duration_seconds / 3600 : 0;\n                          acc[userId].totalHours += hours;\n                          acc[userId].entries.push(entry);\n                          return acc;\n                        }, {} as Record<string, { name: string; totalHours: number; entries: typeof timeEntries }>);\n\n                        return Object.entries(groupedByUser).map(([userId, data]) => (\n                          <div key={userId} className=\"flex items-center justify-between rounded-lg border bg-muted/30 p-2\">\n                            <span className=\"text-sm font-medium\">{data.name}</span>\n                            <span className=\"text-sm text-muted-foreground\">{data.totalHours.toFixed(1)}h</span>\n                          </div>\n                        ));\n                      })()}\n                    </div>\n                  </div>\n                ) : (\n                  <>\n                    <div className=\"flex items-center justify-between\">\n                      <h3 className=\"font-semibold\">Time Tracking</h3>\n                      {editingTracking && timeEntries.length > 0 && (\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => setEditingTracking(false)}\n                        >\n                          <X className=\"h-4 w-4\" />\n                        </Button>\n                      )}\n                    </div>\n                    {/* Time Tracking */}\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-center justify-between\">\n                        <Label className=\"text-sm font-medium\">Time Logs</Label>\n                        <Button\n                          size=\"sm\"\n                          onClick={() => setShowAddTimeDialog(true)}\n                          className=\"touch-target min-h-[44px]\"\n                        >\n                          <Plus className=\"mr-2 h-4 w-4\" />\n                          Add Hours\n                        </Button>\n                      </div>\n\n                      {/* Time Entries List */}\n                      {loadingTimeEntries ? (\n                        <p className=\"text-sm text-muted-foreground text-center py-4\">Loading...</p>\n                      ) : timeEntries.length === 0 ? (\n                        <p className=\"text-sm text-muted-foreground text-center py-4\">No time entries yet</p>\n                      ) : (\n                        <div className=\"space-y-2\">\n                          {timeEntries.map((entry) => {\n                            const hours = entry.duration_seconds ? (entry.duration_seconds / 3600).toFixed(1) : \"0\";\n                            const date = new Date(entry.started_at).toLocaleDateString([], { month: \"short\", day: \"numeric\" });\n                            const userName = entry.user_id \n                              ? (teamMembers.find(m => m.id === entry.user_id)?.fullName || entry.user?.full_name || \"Unknown\")\n                              : \"Unknown\";\n\n                            return (\n                              <div key={entry.id} className=\"flex items-center justify-between rounded-lg border bg-muted/30 p-3\">\n                                <div className=\"flex-1\">\n                                  <p className=\"text-sm font-medium\">{userName}</p>\n                                  <p className=\"text-xs text-muted-foreground\">\n                                    {date} â€¢ {hours}h\n                                  </p>\n                                </div>\n                                <div className=\"flex items-center gap-2\">\n                                  {editingTimeEntry === entry.id ? (\n                                    <>\n                                      <Input\n                                        type=\"number\"\n                                        step=\"0.25\"\n                                        min=\"0\"\n                                        defaultValue={hours}\n                                        className=\"w-20 h-8 text-sm\"\n                                        onBlur={(e) => {\n                                          const newHours = parseFloat(e.target.value);\n                                          if (!isNaN(newHours) && newHours > 0) {\n                                            handleUpdateTimeEntry(entry.id, newHours);\n                                          } else {\n                                            setEditingTimeEntry(null);\n                                          }\n                                        }}\n                                        onKeyDown={(e) => {\n                                          if (e.key === 'Enter') {\n                                            const newHours = parseFloat((e.target as HTMLInputElement).value);\n                                            if (!isNaN(newHours) && newHours > 0) {\n                                              handleUpdateTimeEntry(entry.id, newHours);\n                                            } else {\n                                              setEditingTimeEntry(null);\n                                            }\n                                          } else if (e.key === 'Escape') {\n                                            setEditingTimeEntry(null);\n                                          }\n                                        }}\n                                        autoFocus\n                                      />\n                                      <Button\n                                        variant=\"ghost\"\n                                        size=\"sm\"\n                                        onClick={() => setEditingTimeEntry(null)}\n                                        className=\"h-8\"\n                                      >\n                                        <X className=\"h-3 w-3\" />\n                                      </Button>\n                                    </>\n                                  ) : (\n                                    <>\n                                      <button\n                                        onClick={() => setEditingTimeEntry(entry.id)}\n                                        className=\"text-muted-foreground hover:text-foreground\"\n                                        title=\"Edit hours\"\n                                      >\n                                        <Pencil className=\"h-4 w-4\" />\n                                      </button>\n                                      <button\n                                        onClick={() => handleDeleteTimeEntry(entry.id)}\n                                        className=\"text-muted-foreground hover:text-destructive\"\n                                        title=\"Delete entry\"\n                                      >\n                                        <Trash2 className=\"h-4 w-4\" />\n                                      </button>\n                                    </>\n                                  )}\n                                </div>\n                              </div>\n                            );\n                          })}\n                        </div>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n\n                {/* Photos Section */}\n                <div className=\"rounded-lg border bg-card p-4 space-y-4\">\n                  {!editingPhotos ? (\n                    <div>\n                      <div className=\"flex items-center justify-between mb-3\">\n                        <h3 className=\"font-semibold\">Photos</h3>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => setEditingPhotos(true)}\n                          className=\"touch-target min-h-[44px]\"\n                        >\n                          <Pencil className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                      <PhotoGallery jobId={job.id} companyId={companyId} compact />\n                    </div>\n                  ) : (\n                    <>\n                      <div className=\"flex items-center justify-between\">\n                        <h3 className=\"font-semibold\">Photos</h3>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => setEditingPhotos(false)}\n                        >\n                          <X className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                      <PhotoGallery jobId={job.id} companyId={companyId} />\n                    </>\n                  )}\n                </div>\n\n                {/* Job History Timeline */}\n                {jobHistory.length > 0 && (\n                  <div className=\"rounded-lg border bg-card p-4 space-y-4\">\n                    <h3 className=\"font-semibold\">History</h3>\n                    <JobHistoryTimeline history={jobHistory} />\n                  </div>\n                )}\n              </div>\n            </div>\n\n        </div>\n      </div>\n\n      {/* Message Templates Dialog */}\n      <MessageTemplatesDialog\n        open={messageTemplatesOpen}\n        onOpenChange={setMessageTemplatesOpen}\n        companyId={companyId}\n        job={job}\n        customer={job.customer}\n        invoices={invoicesList}\n        scheduledDate={scheduledDate}\n        scheduledTime={scheduledTime}\n        address={address}\n      />\n\n      {/* Estimate Detail Dialog */}\n      <Dialog open={!!selectedEstimate} onOpenChange={(open) => !open && setSelectedEstimate(null)}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Estimate Details</DialogTitle>\n          </DialogHeader>\n          {selectedEstimate && (\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <Badge\n                  variant={\n                    selectedEstimate.status === \"accepted\"\n                      ? \"success\"\n                      : selectedEstimate.status === \"sent\"\n                      ? \"secondary\"\n                      : \"outline\"\n                  }\n                >\n                  {selectedEstimate.status}\n                </Badge>\n                <p className=\"text-sm text-muted-foreground\">\n                  Created {formatDate(selectedEstimate.created_at)}\n                </p>\n              </div>\n              <div className=\"rounded-lg border divide-y\">\n                {selectedEstimate.line_items.map((item) => (\n                  <div key={item.id} className=\"p-4\">\n                    <div className=\"flex items-start justify-between\">\n                      <div>\n                        <p className=\"font-medium\">{item.name}</p>\n                        {item.description && (\n                          <p className=\"text-sm text-muted-foreground mt-1\">\n                            {item.description}\n                          </p>\n                        )}\n                      </div>\n                      <p className=\"font-medium\">{formatCurrency(item.price)}</p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n              <div className=\"p-4 border-t bg-muted/50 rounded-b-lg\">\n                <div className=\"flex items-center justify-between text-lg font-semibold\">\n                  <span>Total</span>\n                  <span>{formatCurrency(selectedEstimate.line_items.reduce((sum, li) => sum + li.price, 0))}</span>\n                </div>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      {/* Invoice Detail Dialog */}\n      <Dialog open={!!selectedInvoice} onOpenChange={(open) => !open && setSelectedInvoice(null)}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Invoice Details</DialogTitle>\n          </DialogHeader>\n          {selectedInvoice && (\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <Badge\n                  variant={\n                    selectedInvoice.status === \"paid\"\n                      ? \"success\"\n                      : selectedInvoice.status === \"sent\"\n                      ? \"secondary\"\n                      : \"outline\"\n                  }\n                >\n                  {selectedInvoice.status}\n                </Badge>\n                <p className=\"text-sm text-muted-foreground\">\n                  Created {formatDate(selectedInvoice.created_at)}\n                </p>\n              </div>\n              <div className=\"rounded-lg border bg-card p-6 text-center\">\n                <p className=\"text-sm text-muted-foreground mb-1\">Amount Due</p>\n                <p className=\"text-4xl font-bold\">\n                  {formatCurrency(selectedInvoice.amount_total)}\n                </p>\n              </div>\n              {selectedInvoice.status === \"paid\" && selectedInvoice.paid_at && (\n                <div className=\"bg-success/10 text-success rounded-lg p-4 text-center\">\n                  <p className=\"font-semibold\">Paid</p>\n                  <p className=\"text-sm\">on {formatDate(selectedInvoice.paid_at)}</p>\n                </div>\n              )}\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      {/* Material Form Dialog */}\n      <Dialog open={showMaterialForm} onOpenChange={setShowMaterialForm}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>{materialType === \"paint\" ? \"Add Paint\" : \"Add Material\"}</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            {materialType === \"paint\" ? (\n              /* Paint Form */\n              <>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"paintArea\">Area / Use *</Label>\n                  <Select\n                    id=\"paintArea\"\n                    value={materialFormData.area}\n                    onChange={(e) => setMaterialFormData({ ...materialFormData, area: e.target.value })}\n                    className=\"min-h-[44px]\"\n                  >\n                    <option value=\"\">Select area...</option>\n                    <optgroup label=\"Interior\">\n                      <option value=\"Interior Walls\">Interior Walls</option>\n                      <option value=\"Ceiling\">Ceiling</option>\n                      <option value=\"Interior Trim\">Interior Trim</option>\n                      <option value=\"Doors\">Doors</option>\n                    </optgroup>\n                    <optgroup label=\"Exterior\">\n                      <option value=\"Exterior Walls\">Exterior Walls</option>\n                      <option value=\"Exterior Trim\">Exterior Trim</option>\n                      <option value=\"Deck/Fence\">Deck/Fence</option>\n                      <option value=\"Siding\">Siding</option>\n                    </optgroup>\n                    <option value=\"Other\">Other</option>\n                  </Select>\n                </div>\n\n                <div className=\"grid gap-4 sm:grid-cols-2\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"paintBrand\">Brand (Optional)</Label>\n                    <Select\n                      id=\"paintBrand\"\n                      value={materialFormData.brand}\n                      onChange={(e) => setMaterialFormData({ ...materialFormData, brand: e.target.value })}\n                      className=\"min-h-[44px]\"\n                    >\n                      <option value=\"\">Select brand...</option>\n                      <option value=\"Sherwin-Williams\">Sherwin-Williams</option>\n                      <option value=\"Benjamin Moore\">Benjamin Moore</option>\n                      <option value=\"Behr\">Behr</option>\n                      <option value=\"PPG\">PPG</option>\n                      <option value=\"Other\">Other</option>\n                    </Select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"paintColor\">Color *</Label>\n                    <Input\n                      id=\"paintColor\"\n                      value={materialFormData.color}\n                      onChange={(e) => setMaterialFormData({ ...materialFormData, color: e.target.value })}\n                      placeholder=\"e.g., SW 7008 Alabaster\"\n                      className=\"min-h-[44px]\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"grid gap-4 sm:grid-cols-2\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"paintSheen\">Sheen *</Label>\n                    <Select\n                      id=\"paintSheen\"\n                      value={materialFormData.sheen}\n                      onChange={(e) => setMaterialFormData({ ...materialFormData, sheen: e.target.value })}\n                      className=\"min-h-[44px]\"\n                    >\n                      <option value=\"\">Select sheen...</option>\n                      <option value=\"Flat\">Flat</option>\n                      <option value=\"Matte\">Matte</option>\n                      <option value=\"Eggshell\">Eggshell</option>\n                      <option value=\"Satin\">Satin</option>\n                      <option value=\"Semi-Gloss\">Semi-Gloss</option>\n                      <option value=\"Gloss\">Gloss</option>\n                    </Select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"paintQuantity\">Quantity</Label>\n                    <div className=\"flex gap-2\">\n                      <Input\n                        id=\"paintQuantity\"\n                        type=\"number\"\n                        min=\"0\"\n                        step=\"0.25\"\n                        value={materialFormData.quantity}\n                        onChange={(e) => setMaterialFormData({ ...materialFormData, quantity: e.target.value })}\n                        placeholder=\"e.g., 3\"\n                        className=\"min-h-[44px] flex-1\"\n                      />\n                      <Select\n                        value={materialFormData.quantityUnit}\n                        onChange={(e) => setMaterialFormData({ ...materialFormData, quantityUnit: e.target.value })}\n                        className=\"min-h-[44px] w-28\"\n                      >\n                        <option value=\"gal\">Gallons</option>\n                        <option value=\"qt\">Quarts</option>\n                        <option value=\"pt\">Pints</option>\n                        <option value=\"oz\">Oz</option>\n                      </Select>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Advanced Options */}\n                <button\n                  type=\"button\"\n                  onClick={() => setMaterialFormData({ ...materialFormData, showAdvanced: !materialFormData.showAdvanced })}\n                  className=\"text-sm text-muted-foreground hover:text-foreground flex items-center gap-1\"\n                >\n                  {materialFormData.showAdvanced ? \"Hide\" : \"Show\"} advanced options\n                </button>\n\n                {materialFormData.showAdvanced && (\n                  <div className=\"rounded-lg border bg-muted/30 p-4 space-y-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"paintProductLine\">Product Line</Label>\n                      <Input\n                        id=\"paintProductLine\"\n                        value={materialFormData.productLine}\n                        onChange={(e) => setMaterialFormData({ ...materialFormData, productLine: e.target.value })}\n                        placeholder=\"e.g., Duration, Emerald\"\n                        className=\"min-h-[44px]\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"paintNotes\">Notes</Label>\n                      <Textarea\n                        id=\"paintNotes\"\n                        value={materialFormData.notes}\n                        onChange={(e) => setMaterialFormData({ ...materialFormData, notes: e.target.value })}\n                        placeholder=\"e.g., Back wall only, Second coat needed\"\n                        rows={2}\n                      />\n                    </div>\n                  </div>\n                )}\n              </>\n            ) : (\n              /* Generic Material Form */\n              <>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"materialName\">Material Name *</Label>\n                  <Input\n                    id=\"materialName\"\n                    value={materialFormData.name}\n                    onChange={(e) => setMaterialFormData({ ...materialFormData, name: e.target.value })}\n                    placeholder=\"e.g., Roller Set, Tape, Drop Cloth\"\n                    className=\"min-h-[44px]\"\n                    autoFocus\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"materialQuantity\">Quantity</Label>\n                  <Input\n                    id=\"materialQuantity\"\n                    value={materialFormData.quantity}\n                    onChange={(e) => setMaterialFormData({ ...materialFormData, quantity: e.target.value })}\n                    placeholder=\"e.g., 2 rolls, 1 set, 3 brushes\"\n                    className=\"min-h-[44px]\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"materialNotes\">Notes (Optional)</Label>\n                  <Textarea\n                    id=\"materialNotes\"\n                    value={materialFormData.notes}\n                    onChange={(e) => setMaterialFormData({ ...materialFormData, notes: e.target.value })}\n                    placeholder=\"Any additional details...\"\n                    rows={2}\n                  />\n                </div>\n              </>\n            )}\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => {\n                  setShowMaterialForm(false);\n                  setMaterialFormData({ \n                    name: \"\", \n                    brand: \"\",\n                    quantity: \"\", \n                    quantityUnit: \"gal\",\n                    color: \"\", \n                    sheen: \"\",\n                    productLine: \"\",\n                    area: \"\",\n                    notes: \"\",\n                    showAdvanced: false\n                  });\n                }}\n              >\n                Cancel\n              </Button>\n              <Button \n                onClick={handleSubmitMaterialForm} \n                disabled={!materialFormData.name.trim() || (materialType === \"paint\" && (!materialFormData.color.trim() || !materialFormData.sheen || !materialFormData.area))}\n              >\n                Add {materialType === \"paint\" ? \"Paint\" : \"Material\"}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Share Schedule Dialog */}\n      <Dialog open={showShareScheduleDialog} onOpenChange={async (open) => {\n        setShowShareScheduleDialog(open);\n        if (open) {\n          await ensureScheduleToken();\n        }\n      }}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Share Schedule</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            {!scheduledDate || !scheduledTime ? (\n              <div className=\"rounded-lg border bg-muted/50 p-4 text-center text-muted-foreground\">\n                <Calendar className=\"mx-auto h-8 w-8 mb-2\" />\n                <p>This job hasn't been scheduled yet.</p>\n                <p className=\"text-sm mt-1\">Add a scheduled date and time first.</p>\n              </div>\n            ) : loadingScheduleToken ? (\n              <div className=\"text-center py-4\">\n                <p className=\"text-sm text-muted-foreground\">Generating link...</p>\n              </div>\n            ) : !getScheduleLink() ? (\n              <div className=\"text-center py-4\">\n                <p className=\"text-sm text-destructive\">No token available</p>\n              </div>\n            ) : (\n              <>\n                <div className=\"rounded-lg border bg-card p-4\">\n                  <p className=\"text-sm text-muted-foreground mb-2\">Scheduled for</p>\n                  <p className=\"font-semibold text-lg\">\n                    {scheduledEndDate && scheduledEndDate !== scheduledDate\n                      ? `${formatDate(scheduledDate)} - ${formatDate(scheduledEndDate)}`\n                      : formatDate(scheduledDate)}\n                    {scheduledTime && ` at ${formatTime(scheduledTime)}`}\n                  </p>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <div>\n                    <Label className=\"text-sm text-muted-foreground\">Schedule Link</Label>\n                    <div className=\"flex gap-2 mt-2\">\n                      <Input \n                        value={getScheduleLink()} \n                        readOnly \n                        className=\"font-mono text-sm\"\n                      />\n                      <Button \n                        variant=\"outline\"\n                        onClick={copyScheduleLink}\n                        disabled={loadingScheduleToken}\n                        className=\"shrink-0\"\n                      >\n                        <Copy className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n\n                  <div>\n                    <Label className=\"text-sm text-muted-foreground\">Pre-written Message</Label>\n                    <Textarea \n                      value={getScheduleMessage()} \n                      readOnly \n                      rows={4}\n                      className=\"mt-2 font-sans\"\n                    />\n                    <Button \n                      onClick={copyScheduleMessage}\n                      className=\"w-full mt-2\"\n                    >\n                      <Copy className=\"mr-2 h-4 w-4\" />\n                      Copy Message\n                    </Button>\n                  </div>\n                </div>\n              </>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Duplicate Job Dialog */}\n      <Dialog open={showDuplicateDialog} onOpenChange={setShowDuplicateDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Duplicate Job?</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <p className=\"text-sm text-muted-foreground\">\n              This will create a new job with the same customer, address, and materials.\n            </p>\n            <div className=\"rounded-lg border bg-muted/50 p-3 space-y-2\">\n              <p className=\"text-sm font-medium\">Will be copied:</p>\n              <ul className=\"text-sm text-muted-foreground space-y-1 list-disc list-inside\">\n                <li>Customer & address</li>\n                <li>Notes</li>\n                <li>Assigned team member</li>\n                <li>Materials ({materials.length} items)</li>\n              </ul>\n            </div>\n            <div className=\"rounded-lg border bg-warning/10 p-3 space-y-2\">\n              <p className=\"text-sm font-medium text-warning\">Will NOT be copied:</p>\n              <ul className=\"text-sm text-muted-foreground space-y-1 list-disc list-inside\">\n                <li>Schedule (will be unscheduled)</li>\n                <li>Status (will reset to \"new\")</li>\n                <li>Estimates & invoices</li>\n              </ul>\n            </div>\n            <div className=\"flex gap-3 justify-end pt-2\">\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowDuplicateDialog(false)}\n                disabled={duplicating}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={handleDuplicateJob}\n                loading={duplicating}\n              >\n                <Copy className=\"mr-2 h-4 w-4\" />\n                Duplicate\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Job Templates Dialog */}\n      <JobTemplatesDialog\n        open={showTemplateDialog}\n        onOpenChange={setShowTemplateDialog}\n        mode={templateDialogMode}\n        jobId={job.id}\n        companyId={companyId}\n        onRefresh={() => router.refresh()}\n      />\n\n      {/* Add Hours Dialog */}\n      <Dialog open={showAddTimeDialog} onOpenChange={setShowAddTimeDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Add Hours</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"timeWorker\">Worker</Label>\n              <Select\n                id=\"timeWorker\"\n                value={newTimeEntry.userId}\n                onChange={(e) => setNewTimeEntry({ ...newTimeEntry, userId: e.target.value })}\n              >\n                <option value=\"\">Select worker</option>\n                {teamMembers.map((member) => (\n                  <option key={member.id} value={member.id}>\n                    {member.fullName}\n                  </option>\n                ))}\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"timeDate\">Date</Label>\n              <Input\n                id=\"timeDate\"\n                type=\"date\"\n                value={newTimeEntry.date}\n                onChange={(e) => setNewTimeEntry({ ...newTimeEntry, date: e.target.value })}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"timeHours\">Hours</Label>\n              <Input\n                id=\"timeHours\"\n                type=\"number\"\n                step=\"0.25\"\n                min=\"0\"\n                placeholder=\"0.0\"\n                value={newTimeEntry.hours}\n                onChange={(e) => setNewTimeEntry({ ...newTimeEntry, hours: e.target.value })}\n              />\n            </div>\n            <div className=\"flex gap-2 justify-end\">\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowAddTimeDialog(false)}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={async () => {\n                  await handleAddTimeEntry();\n                  setShowAddTimeDialog(false);\n                  setNewTimeEntry({\n                    userId: currentUserId,\n                    hours: \"\",\n                    date: new Date().toISOString().split(\"T\")[0],\n                  });\n                }}\n                loading={addingTimeEntry}\n                disabled={!newTimeEntry.hours || !newTimeEntry.userId}\n              >\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Add Hours\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Copy Message Dialog */}\n      <Dialog open={showCopyDialog} onOpenChange={setShowCopyDialog}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>\n              {copyDialogType === \"estimate\" && \"Estimate Message\"}\n              {copyDialogType === \"invoice\" && \"Invoice Message\"}\n              {copyDialogType === \"materials\" && \"Materials List\"}\n              {copyDialogType === \"reminder\" && \"Reminder Message\"}\n              {copyDialogType === \"schedule-confirmation\" && \"Schedule Confirmation\"}\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            {copyDialogType === \"estimate\" && estimatesList[0] && (\n              <div className=\"space-y-3\">\n                <div>\n                  <Label className=\"text-sm text-muted-foreground\">Estimate Link</Label>\n                  <div className=\"flex gap-2 mt-2\">\n                    <Input \n                      value={`${typeof window !== \"undefined\" ? window.location.origin : \"\"}/e/${estimatesList[0].public_token}`}\n                      readOnly \n                      className=\"font-mono text-sm\"\n                    />\n                    <Button \n                      variant=\"outline\"\n                      onClick={() => {\n                        copyToClipboard(`${typeof window !== \"undefined\" ? window.location.origin : \"\"}/e/${estimatesList[0].public_token}`);\n                        addToast(\"Link copied!\", \"success\");\n                      }}\n                      className=\"shrink-0\"\n                    >\n                      <Copy className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n\n                <div>\n                  <Label className=\"text-sm text-muted-foreground\">Pre-written Message</Label>\n                  <Textarea \n                    value={`Hey ${job.customer?.name || \"there\"} â€” here's your estimate for ${formatCurrency(estimatesList[0].line_items.reduce((sum, li) => sum + li.price, 0))}: ${typeof window !== \"undefined\" ? window.location.origin : \"\"}/e/${estimatesList[0].public_token}. Let me know if you have any questions!`}\n                    readOnly \n                    rows={4}\n                    className=\"mt-2 font-sans\"\n                  />\n                  <Button \n                    onClick={() => {\n                      copyEstimateMessage();\n                      setShowCopyDialog(false);\n                    }}\n                    className=\"w-full mt-2\"\n                  >\n                    <Copy className=\"mr-2 h-4 w-4\" />\n                    Copy Message\n                  </Button>\n                </div>\n              </div>\n            )}\n\n            {copyDialogType === \"invoice\" && invoicesList[0] && (\n              <div className=\"space-y-3\">\n                <div>\n                  <Label className=\"text-sm text-muted-foreground\">Invoice Link</Label>\n                  <div className=\"flex gap-2 mt-2\">\n                    <Input \n                      value={`${typeof window !== \"undefined\" ? window.location.origin : \"\"}/i/${invoicesList[0].public_token}`}\n                      readOnly \n                      className=\"font-mono text-sm\"\n                    />\n                    <Button \n                      variant=\"outline\"\n                      onClick={() => {\n                        copyToClipboard(`${typeof window !== \"undefined\" ? window.location.origin : \"\"}/i/${invoicesList[0].public_token}`);\n                        addToast(\"Link copied!\", \"success\");\n                      }}\n                      className=\"shrink-0\"\n                    >\n                      <Copy className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n\n                <div>\n                  <Label className=\"text-sm text-muted-foreground\">Pre-written Message</Label>\n                  <Textarea \n                    value={`Hey ${job.customer?.name || \"there\"} â€” thanks again for letting us work on your project! Here's your invoice for ${formatCurrency(invoicesList[0].amount_total)}: ${typeof window !== \"undefined\" ? window.location.origin : \"\"}/i/${invoicesList[0].public_token}. Let us know if you have any questions!`}\n                    readOnly \n                    rows={4}\n                    className=\"mt-2 font-sans\"\n                  />\n                  <Button \n                    onClick={() => {\n                      copyPaymentRequestMessage();\n                      setShowCopyDialog(false);\n                    }}\n                    className=\"w-full mt-2\"\n                  >\n                    <Copy className=\"mr-2 h-4 w-4\" />\n                    Copy Message\n                  </Button>\n                </div>\n              </div>\n            )}\n\n            {copyDialogType === \"materials\" && (\n              <div className=\"space-y-3\">\n                <div>\n                  <Label className=\"text-sm text-muted-foreground\">Materials List</Label>\n                  <Textarea \n                    value={(() => {\n                      const jobTitle = job.title;\n                      const customerName = job.customer?.name || \"Customer\";\n                      let preview = `Materials needed for ${jobTitle} (${customerName}):\\n\\n`;\n                      materials.forEach((m, i) => {\n                        let line = `${i + 1}. ${m.name}`;\n                        if (m.notes) line += ` - ${m.notes}`;\n                        if (m.quantity_decimal && m.unit) {\n                          const qty = m.quantity_decimal % 1 === 0 ? m.quantity_decimal.toFixed(0) : m.quantity_decimal;\n                          line += ` - ${qty} ${m.unit}`;\n                        }\n                        preview += line + `\\n`;\n                      });\n                      preview += `\\nTotal items: ${materials.length}`;\n                      return preview;\n                    })()}\n                    readOnly \n                    rows={Math.min(materials.length + 4, 12)}\n                    className=\"mt-2 font-mono text-sm\"\n                  />\n                  <Button \n                    onClick={() => {\n                      copyMaterialsList();\n                      setShowCopyDialog(false);\n                    }}\n                    className=\"w-full mt-2\"\n                  >\n                    <Copy className=\"mr-2 h-4 w-4\" />\n                    Copy List\n                  </Button>\n                </div>\n              </div>\n            )}\n\n            {copyDialogType === \"reminder\" && scheduledDate && scheduledTime && (\n              <div className=\"space-y-3\">\n                <div>\n                  <Label className=\"text-sm text-muted-foreground\">Reminder Message</Label>\n                  <Textarea \n                    value={`Hey ${job.customer?.name || \"there\"} â€” just a reminder that we're scheduled for ${scheduledEndDate && scheduledEndDate !== scheduledDate ? `${formatDate(scheduledDate)} - ${formatDate(scheduledEndDate)}` : formatDate(scheduledDate)} at ${formatTime(scheduledTime)} at ${address || \"[address]\"}. Reply here if anything changes. See you then!`}\n                    readOnly \n                    rows={4}\n                    className=\"mt-2 font-sans\"\n                  />\n                  <Button \n                    onClick={() => {\n                      copyReminderMessage();\n                      setShowCopyDialog(false);\n                    }}\n                    className=\"w-full mt-2\"\n                  >\n                    <Copy className=\"mr-2 h-4 w-4\" />\n                    Copy Message\n                  </Button>\n                </div>\n              </div>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { createClient } from \"@drip/core/database/client\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select } from \"@/components/ui/select\";\nimport { useToast } from \"@/components/ui/toast\";\nimport { Copy, Send, Plus, Trash2, FileText, Mail } from \"lucide-react\";\nimport { copyToClipboard, formatDate, formatTime, formatCurrency } from \"@/lib/utils\";\nimport type { Job, Customer, Invoice } from \"@drip/core/types\";\n\ninterface MessageTemplate {\n  id: string;\n  name: string;\n  type: \"sms\" | \"email\";\n  subject: string | null;\n  body: string;\n  variables: string[];\n}\n\ninterface MessageTemplatesDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  companyId: string;\n  job: Job;\n  customer: Customer | null;\n  invoices: Invoice[];\n  scheduledDate: string;\n  scheduledTime: string;\n  address: string;\n}\n\nexport function MessageTemplatesDialog({\n  open,\n  onOpenChange,\n  companyId,\n  job,\n  customer,\n  invoices,\n  scheduledDate,\n  scheduledTime,\n  address,\n}: MessageTemplatesDialogProps) {\n  const [templates, setTemplates] = useState<MessageTemplate[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n  const [templateName, setTemplateName] = useState(\"\");\n  const [templateType, setTemplateType] = useState<\"sms\" | \"email\">(\"sms\");\n  const [templateSubject, setTemplateSubject] = useState(\"\");\n  const [templateBody, setTemplateBody] = useState(\"\");\n  const { addToast } = useToast();\n  const supabase = createClient();\n\n  useEffect(() => {\n    if (open) {\n      loadTemplates();\n    }\n  }, [open, companyId]);\n\n  async function loadTemplates() {\n    setLoading(true);\n    try {\n      const { data, error } = await supabase\n        .from(\"message_templates\" as any)\n        .select(\"*\")\n        .eq(\"company_id\", companyId)\n        .order(\"created_at\", { ascending: false });\n\n      if (error) {\n        setTemplates([]);\n        return;\n      }\n      setTemplates((data as any) || []);\n    } catch (error) {\n      console.error(\"Error loading templates:\", error);\n      addToast(\"Failed to load templates\", \"error\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  function replaceVariables(text: string): string {\n    return text\n      .replace(/\\{\\{customer_name\\}\\}/g, customer?.name || \"there\")\n      .replace(/\\{\\{job_date\\}\\}/g, scheduledDate ? formatDate(scheduledDate) : \"[date]\")\n      .replace(/\\{\\{job_time\\}\\}/g, scheduledTime ? formatTime(scheduledTime) : \"[time]\")\n      .replace(/\\{\\{job_address\\}\\}/g, address || \"[address]\")\n      .replace(/\\{\\{amount\\}\\}/g, invoices[0] ? formatCurrency(invoices[0].amount_total) : \"[amount]\")\n      .replace(/\\{\\{invoice_link\\}\\}/g, invoices[0] \n        ? `${typeof window !== \"undefined\" ? window.location.origin : \"\"}/i/${invoices[0].public_token}`\n        : \"[invoice link]\");\n  }\n\n  function handleCopyMessage(template: MessageTemplate) {\n    const message = replaceVariables(template.body);\n    copyToClipboard(message);\n    addToast(\"Message copied!\", \"success\");\n  }\n\n  function handleSendMessage(template: MessageTemplate) {\n    const message = replaceVariables(template.body);\n    \n    if (template.type === \"sms\" && customer?.phone) {\n      window.location.href = `sms:${customer.phone}?body=${encodeURIComponent(message)}`;\n    } else if (template.type === \"email\" && customer?.email) {\n      const subject = template.subject ? replaceVariables(template.subject) : \"Message from Drip\";\n      window.location.href = `mailto:${customer.email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(message)}`;\n    } else {\n      addToast(`No ${template.type === \"sms\" ? \"phone\" : \"email\"} available`, \"error\");\n    }\n  }\n\n  async function handleSaveTemplate() {\n    if (!templateName.trim() || !templateBody.trim()) {\n      addToast(\"Please fill in all required fields\", \"error\");\n      return;\n    }\n\n    try {\n      const { data, error } = await supabase\n        .from(\"message_templates\" as any)\n        .insert({\n          company_id: companyId,\n          name: templateName.trim(),\n          type: templateType,\n          subject: templateType === \"email\" && templateSubject.trim() ? templateSubject.trim() : null,\n          body: templateBody.trim(),\n          variables: extractVariables(templateBody + (templateSubject || \"\")),\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      setTemplates((prev) => [(data as any), ...prev]);\n      setTemplateName(\"\");\n      setTemplateBody(\"\");\n      setTemplateSubject(\"\");\n      setShowCreateForm(false);\n      addToast(\"Template saved!\", \"success\");\n    } catch (error) {\n      console.error(\"Error saving template:\", error);\n      addToast(\"Failed to save template\", \"error\");\n    }\n  }\n\n  function extractVariables(text: string): string[] {\n    const matches = text.match(/\\{\\{(\\w+)\\}\\}/g);\n    return matches ? [...new Set(matches.map(m => m.replace(/\\{\\{|\\}\\}/g, \"\")))] : [];\n  }\n\n  async function handleDeleteTemplate(templateId: string) {\n    try {\n      const { error } = await supabase\n        .from(\"message_templates\" as any)\n        .delete()\n        .eq(\"id\", templateId);\n\n      if (error) throw error;\n\n      setTemplates((prev) => prev.filter((t) => t.id !== templateId));\n      addToast(\"Template deleted!\", \"success\");\n    } catch (error) {\n      console.error(\"Error deleting template:\", error);\n      addToast(\"Failed to delete template\", \"error\");\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Message Templates</DialogTitle>\n          <DialogDescription>\n            Pre-written messages with variables. Use: {\"{{customer_name}}\"}, {\"{{job_date}}\"}, {\"{{job_time}}\"}, {\"{{job_address}}\"}, {\"{{amount}}\"}, {\"{{invoice_link}}\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 mt-4\">\n          {!showCreateForm && (\n            <Button\n              onClick={() => setShowCreateForm(true)}\n              className=\"w-full\"\n              variant=\"outline\"\n            >\n              <Plus className=\"mr-2 h-4 w-4\" />\n              Create New Template\n            </Button>\n          )}\n\n          {showCreateForm && (\n            <div className=\"rounded-lg border p-4 space-y-3\">\n              <div className=\"grid gap-3 sm:grid-cols-2\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"templateName\">Template Name *</Label>\n                  <Input\n                    id=\"templateName\"\n                    value={templateName}\n                    onChange={(e) => setTemplateName(e.target.value)}\n                    placeholder=\"e.g., Job Scheduled\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"templateType\">Type *</Label>\n                  <Select\n                    id=\"templateType\"\n                    value={templateType}\n                    onChange={(e) => setTemplateType(e.target.value as \"sms\" | \"email\")}\n                  >\n                    <option value=\"sms\">SMS</option>\n                    <option value=\"email\">Email</option>\n                  </Select>\n                </div>\n              </div>\n              {templateType === \"email\" && (\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"templateSubject\">Subject</Label>\n                  <Input\n                    id=\"templateSubject\"\n                    value={templateSubject}\n                    onChange={(e) => setTemplateSubject(e.target.value)}\n                    placeholder=\"Email subject...\"\n                  />\n                </div>\n              )}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"templateBody\">Message *</Label>\n                <Textarea\n                  id=\"templateBody\"\n                  value={templateBody}\n                  onChange={(e) => setTemplateBody(e.target.value)}\n                  placeholder=\"Hey {{customer_name}} â€” just a reminder...\"\n                  rows={4}\n                />\n              </div>\n              <div className=\"flex gap-2\">\n                <Button onClick={handleSaveTemplate} disabled={!templateName.trim() || !templateBody.trim()}>\n                  Save Template\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setShowCreateForm(false);\n                    setTemplateName(\"\");\n                    setTemplateBody(\"\");\n                    setTemplateSubject(\"\");\n                  }}\n                >\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          )}\n\n          {loading ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              Loading templates...\n            </div>\n          ) : templates.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <FileText className=\"mx-auto h-8 w-8 mb-2 opacity-50\" />\n              <p>No templates yet</p>\n            </div>\n          ) : (\n            <div className=\"space-y-2\">\n              {templates.map((template) => {\n                const preview = replaceVariables(template.body);\n                return (\n                  <div\n                    key={template.id}\n                    className=\"rounded-lg border p-4 space-y-3\"\n                  >\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <h4 className=\"font-medium\">{template.name}</h4>\n                          <span className=\"text-xs px-2 py-0.5 rounded bg-muted\">\n                            {template.type.toUpperCase()}\n                          </span>\n                        </div>\n                        {template.type === \"email\" && template.subject && (\n                          <p className=\"text-sm text-muted-foreground mt-1\">\n                            Subject: {replaceVariables(template.subject)}\n                          </p>\n                        )}\n                        <p className=\"text-sm text-muted-foreground mt-2 whitespace-pre-wrap\">\n                          {preview}\n                        </p>\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        onClick={() => handleDeleteTemplate(template.id)}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => handleCopyMessage(template)}\n                        className=\"flex-1\"\n                      >\n                        <Copy className=\"mr-2 h-4 w-4\" />\n                        Copy\n                      </Button>\n                      <Button\n                        size=\"sm\"\n                        onClick={() => handleSendMessage(template)}\n                        className=\"flex-1\"\n                        disabled={template.type === \"sms\" && !customer?.phone || template.type === \"email\" && !customer?.email}\n                      >\n                        {template.type === \"sms\" ? (\n                          <>\n                            <Send className=\"mr-2 h-4 w-4\" />\n                            Send SMS\n                          </>\n                        ) : (\n                          <>\n                            <Mail className=\"mr-2 h-4 w-4\" />\n                            Send Email\n                          </>\n                        )}\n                      </Button>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { createClient } from \"@drip/core/database/client\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { SimpleCheckbox } from \"@/components/ui/checkbox\";\nimport { useToast } from \"@/components/ui/toast\";\nimport { Save, Trash2 } from \"lucide-react\";\nimport type { JobTemplateWithRelations } from \"@drip/core/types\";\n\ninterface JobTemplatesDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  mode: \"save\" | \"manage\";\n  jobId?: string;\n  companyId: string;\n  onRefresh?: () => void;\n}\n\nexport function JobTemplatesDialog({\n  open,\n  onOpenChange,\n  mode,\n  jobId,\n  companyId,\n  onRefresh,\n}: JobTemplatesDialogProps) {\n  const [loading, setLoading] = useState(false);\n  const [templates, setTemplates] = useState<JobTemplateWithRelations[]>([]);\n  const [templateName, setTemplateName] = useState(\"\");\n  const [templateDescription, setTemplateDescription] = useState(\"\");\n  const [includeNotes, setIncludeNotes] = useState(true);\n  const [includeMaterials, setIncludeMaterials] = useState(true);\n  const [includeEstimateStructure, setIncludeEstimateStructure] = useState(false);\n  const { addToast } = useToast();\n  const supabase = createClient();\n\n  useEffect(() => {\n    if (open && mode === \"manage\") {\n      loadTemplates();\n    }\n  }, [open, mode]);\n\n  async function loadTemplates() {\n    try {\n      const response = await fetch(\"/api/job-templates\");\n      if (!response.ok) throw new Error(\"Failed to load templates\");\n      const data = await response.json();\n      setTemplates(data);\n    } catch (error) {\n      console.error(\"Error loading templates:\", error);\n      addToast(\"Failed to load templates\", \"error\");\n    }\n  }\n\n  async function handleSaveTemplate() {\n    if (!templateName.trim()) {\n      addToast(\"Please enter a template name\", \"error\");\n      return;\n    }\n\n    if (!jobId) {\n      addToast(\"No job selected\", \"error\");\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const response = await fetch(\"/api/job-templates\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          job_id: jobId,\n          name: templateName.trim(),\n          description: templateDescription.trim() || null,\n          include_notes: includeNotes,\n          include_materials: includeMaterials,\n          include_estimate_structure: includeEstimateStructure,\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"Failed to save template\");\n      }\n\n      addToast(\"Template saved successfully!\", \"success\");\n      setTemplateName(\"\");\n      setTemplateDescription(\"\");\n      setIncludeNotes(true);\n      setIncludeMaterials(true);\n      setIncludeEstimateStructure(false);\n      onOpenChange(false);\n      onRefresh?.();\n    } catch (error: any) {\n      console.error(\"Error saving template:\", error);\n      addToast(error.message || \"Failed to save template\", \"error\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function handleDeleteTemplate(templateId: string) {\n    if (!confirm(\"Are you sure you want to delete this template?\")) {\n      return;\n    }\n\n    try {\n      const response = await fetch(`/api/job-templates/${templateId}`, {\n        method: \"DELETE\",\n      });\n\n      if (!response.ok) throw new Error(\"Failed to delete template\");\n\n      addToast(\"Template deleted\", \"success\");\n      loadTemplates();\n      onRefresh?.();\n    } catch (error) {\n      console.error(\"Error deleting template:\", error);\n      addToast(\"Failed to delete template\", \"error\");\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>\n            {mode === \"save\" ? \"Save as Template\" : \"Manage Templates\"}\n          </DialogTitle>\n          <DialogDescription>\n            {mode === \"save\"\n              ? \"Create a reusable template from this job\"\n              : `Manage your job templates (${templates.length}/50)`}\n          </DialogDescription>\n        </DialogHeader>\n\n        {mode === \"save\" ? (\n          <div className=\"space-y-4 mt-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"templateName\">Template Name *</Label>\n              <Input\n                id=\"templateName\"\n                placeholder=\"e.g., Standard Interior Repaint\"\n                value={templateName}\n                onChange={(e) => setTemplateName(e.target.value)}\n                autoFocus\n                className=\"min-h-[44px]\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"templateDescription\">Description (Optional)</Label>\n              <Textarea\n                id=\"templateDescription\"\n                placeholder=\"Add details about when to use this template...\"\n                value={templateDescription}\n                onChange={(e) => setTemplateDescription(e.target.value)}\n                rows={3}\n              />\n            </div>\n\n            <div className=\"rounded-lg border bg-muted/30 p-4 space-y-3\">\n              <p className=\"text-sm font-medium\">What to include:</p>\n\n              <div className=\"flex items-start gap-3\">\n                <SimpleCheckbox\n                  id=\"includeNotes\"\n                  checked={includeNotes}\n                  onChange={(e) => setIncludeNotes(e.target.checked)}\n                />\n                <div className=\"flex-1\">\n                  <Label htmlFor=\"includeNotes\" className=\"cursor-pointer font-normal\">\n                    Notes\n                  </Label>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Copy job notes to template\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"flex items-start gap-3\">\n                <SimpleCheckbox\n                  id=\"includeMaterials\"\n                  checked={includeMaterials}\n                  onChange={(e) => setIncludeMaterials(e.target.checked)}\n                />\n                <div className=\"flex-1\">\n                  <Label htmlFor=\"includeMaterials\" className=\"cursor-pointer font-normal\">\n                    Materials\n                  </Label>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Save materials list for reuse\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"flex items-start gap-3\">\n                <SimpleCheckbox\n                  id=\"includeEstimateStructure\"\n                  checked={includeEstimateStructure}\n                  onChange={(e) => setIncludeEstimateStructure(e.target.checked)}\n                />\n                <div className=\"flex-1\">\n                  <Label\n                    htmlFor=\"includeEstimateStructure\"\n                    className=\"cursor-pointer font-normal\"\n                  >\n                    Estimate Structure\n                  </Label>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Save line item names (prices not included)\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n              <Button\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                disabled={loading}\n              >\n                Cancel\n              </Button>\n              <Button onClick={handleSaveTemplate} loading={loading}>\n                <Save className=\"mr-2 h-4 w-4\" />\n                Save Template\n              </Button>\n            </div>\n          </div>\n        ) : (\n          <div className=\"space-y-4 mt-4\">\n            {templates.length === 0 ? (\n              <div className=\"p-8 text-center text-muted-foreground\">\n                <p>No templates yet</p>\n                <p className=\"text-sm mt-1\">\n                  Save your first template from a job detail page\n                </p>\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {templates.map((template) => (\n                  <div\n                    key={template.id}\n                    className=\"rounded-lg border bg-card p-4 space-y-2\"\n                  >\n                    <div className=\"flex items-start justify-between gap-3\">\n                      <div className=\"flex-1\">\n                        <h4 className=\"font-medium\">{template.name}</h4>\n                        {template.description && (\n                          <p className=\"text-sm text-muted-foreground mt-1\">\n                            {template.description}\n                          </p>\n                        )}\n                        <div className=\"flex gap-4 mt-2 text-xs text-muted-foreground\">\n                          {template.template_materials && (\n                            <span>{template.template_materials.length} materials</span>\n                          )}\n                          {template.template_estimate_items && (\n                            <span>\n                              {template.template_estimate_items.length} estimate items\n                            </span>\n                          )}\n                          {template.notes && <span>Has notes</span>}\n                        </div>\n                      </div>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleDeleteTemplate(template.id)}\n                        className=\"text-destructive hover:text-destructive hover:bg-destructive/10\"\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}\n","\"use client\";\n\nimport { formatDate, formatTime } from \"@/lib/utils\";\nimport { JOB_STATUS_LABELS } from \"@/lib/utils\";\nimport { Clock, CheckCircle } from \"lucide-react\";\n\ntype JobHistory = {\n  id: string;\n  job_id: string;\n  status: string;\n  changed_at: string;\n  notes?: string | null;\n};\n\ninterface JobHistoryTimelineProps {\n  history: JobHistory[];\n}\n\nexport function JobHistoryTimeline({ history }: JobHistoryTimelineProps) {\n  if (history.length === 0) {\n    return (\n      <div className=\"p-4 text-center text-muted-foreground text-sm\">\n        No history yet\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {history.map((item, index) => (\n        <div key={item.id} className=\"flex gap-4\">\n          <div className=\"flex flex-col items-center\">\n            <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center\">\n              {item.status === \"done\" || item.status === \"paid\" ? (\n                <CheckCircle className=\"h-4 w-4 text-success\" />\n              ) : (\n                <Clock className=\"h-4 w-4 text-muted-foreground\" />\n              )}\n            </div>\n            {index < history.length - 1 && (\n              <div className=\"w-0.5 h-full bg-border mt-2\" />\n            )}\n          </div>\n          <div className=\"flex-1 pb-4\">\n            <div className=\"flex items-center gap-2\">\n              <span className=\"font-medium\">\n                {JOB_STATUS_LABELS[item.status as keyof typeof JOB_STATUS_LABELS] || item.status}\n              </span>\n              <span className=\"text-sm text-muted-foreground\">\n                {formatDate(item.changed_at)} {formatTime(new Date(item.changed_at).toISOString().split('T')[1].split('.')[0])}\n              </span>\n            </div>\n            {item.notes && (\n              <p className=\"text-sm text-muted-foreground mt-1\">{item.notes}</p>\n            )}\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n}\n","\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Plus, Trash2, ExternalLink, Copy, Edit2, Check, DollarSign, Clock, Ruler, Users, Share2, MessageSquare, Pencil } from \"lucide-react\";\nimport { formatCurrency, formatDate, copyToClipboard, generateToken } from \"@/lib/utils\";\nimport { createClient } from \"@drip/core/database/client\";\nimport { useToast } from \"@/components/ui/toast\";\nimport { useRouter } from \"next/navigation\";\nimport type { EstimatingConfig } from \"@drip/core/types\";\n\ntype PaymentState = \"none\" | \"proposed\" | \"approved\" | \"due\" | \"paid\";\n\ntype LineItemType = \"area\" | \"labor\" | \"other\";\n\ninterface PaymentLineItem {\n  id?: string;\n  type: LineItemType;\n  title: string;\n  price: string; // string for input, stored as cents\n  // Area-based fields\n  areaType?: \"walls\" | \"ceilings\" | \"trim\" | \"doors\" | \"exterior_walls\" | \"exterior_trim\" | \"deck_fence\" | \"siding\" | \"other\";\n  ratePerSqft?: string;\n  sqft?: string;\n  // Labor fields\n  hours?: string;\n  ratePerHour?: string;\n  // Paint/Material fields (matching Add Paint dialog)\n  paintBrand?: string; // \"Sherwin-Williams\", etc.\n  paintColor?: string; // \"SW 7008 Alabaster\"\n  paintSheen?: string; // \"Eggshell\", etc.\n  paintQuantity?: string; // number as string\n  paintQuantityUnit?: string; // \"gal\", \"qt\", \"pt\", \"oz\"\n}\n\ninterface UnifiedPaymentProps {\n  jobId: string;\n  companyId: string;\n  customerId: string | null;\n  paymentState: PaymentState;\n  paymentAmount: number | null; // in cents\n  paymentApprovedAt: string | null;\n  paymentPaidAt: string | null;\n  paymentMethod: string | null;\n  publicToken?: string;\n  lineItems: Array<{\n    id: string;\n    title: string;\n    price: number; // in cents\n  }>;\n  estimatingConfig?: EstimatingConfig | null;\n  estimateStatus?: string | null; // \"draft\", \"sent\", \"accepted\", \"denied\"\n  estimateDeniedAt?: string | null;\n  estimateDenialReason?: string | null;\n  onUpdate: () => void;\n}\n\nexport function UnifiedPayment({\n  jobId,\n  companyId,\n  customerId,\n  paymentState,\n  paymentAmount,\n  paymentApprovedAt,\n  paymentPaidAt,\n  paymentMethod,\n  publicToken,\n  lineItems: initialLineItems,\n  estimatingConfig,\n  estimateStatus,\n  estimateDeniedAt,\n  estimateDenialReason,\n  onUpdate,\n}: UnifiedPaymentProps) {\n  const supabase = createClient();\n  const { addToast } = useToast();\n  const router = useRouter();\n\n  // Local state to track current payment state (allows immediate UI updates)\n  const [currentPaymentState, setCurrentPaymentState] = useState<PaymentState>(paymentState);\n  const [currentPaymentPaidAt, setCurrentPaymentPaidAt] = useState<string | null>(paymentPaidAt);\n  const [currentPaymentMethod, setCurrentPaymentMethod] = useState<string | null>(paymentMethod);\n  \n  // Update local state when prop changes\n  useEffect(() => {\n    setCurrentPaymentState(paymentState);\n  }, [paymentState]);\n  \n  useEffect(() => {\n    setCurrentPaymentPaidAt(paymentPaidAt);\n  }, [paymentPaidAt]);\n  \n  useEffect(() => {\n    setCurrentPaymentMethod(paymentMethod);\n  }, [paymentMethod]);\n\n  const [lineItems, setLineItems] = useState<PaymentLineItem[]>(\n    initialLineItems.length > 0\n      ? initialLineItems.map(item => ({ \n          id: item.id, \n          type: \"other\" as LineItemType,\n          title: item.title, \n          price: (item.price / 100).toFixed(2),\n          paintBrand: \"\",\n          paintColor: \"\",\n          paintSheen: \"\",\n          paintQuantity: \"\",\n          paintQuantityUnit: \"gal\"\n        }))\n      : [{ \n          type: \"other\", \n          title: \"\", \n          price: \"\",\n          paintBrand: \"\",\n          paintColor: \"\",\n          paintSheen: \"\",\n          paintQuantity: \"\",\n          paintQuantityUnit: \"gal\"\n        }]\n  );\n  const [saving, setSaving] = useState(false);\n  const [markPaidDialogOpen, setMarkPaidDialogOpen] = useState(false);\n  const [paidMethod, setPaidMethod] = useState(\"cash\");\n  const [editingEstimate, setEditingEstimate] = useState(false);\n  const [loadingEstimateData, setLoadingEstimateData] = useState(false);\n  const [shareDialogOpen, setShareDialogOpen] = useState(false);\n  const [sharePaymentDialogOpen, setSharePaymentDialogOpen] = useState(false);\n  const [selectedPaymentMethods, setSelectedPaymentMethods] = useState<string[]>([\"cash\", \"check\", \"venmo\", \"stripe\"]);\n  const [currentPublicToken, setCurrentPublicToken] = useState<string | undefined>(publicToken);\n  const [currentPaymentToken, setCurrentPaymentToken] = useState<string | undefined>();\n  const [loadingToken, setLoadingToken] = useState(false);\n  const [loadingPaymentToken, setLoadingPaymentToken] = useState(false);\n\n  // Fetch estimate token if not available\n  useEffect(() => {\n    async function fetchEstimateToken() {\n      if (currentPublicToken || !jobId || paymentState !== \"proposed\") return;\n      \n      setLoadingToken(true);\n      try {\n        const { data: estimateData } = await supabase\n          .from(\"estimates\")\n          .select(\"public_token\")\n          .eq(\"job_id\", jobId)\n          .maybeSingle();\n        \n        if (estimateData?.public_token) {\n          setCurrentPublicToken(estimateData.public_token);\n        }\n      } catch (err) {\n        console.error(\"Error fetching estimate token:\", err);\n      } finally {\n        setLoadingToken(false);\n      }\n    }\n    \n    fetchEstimateToken();\n  }, [jobId, paymentState, currentPublicToken, supabase]);\n\n  // Fetch payment token if not available\n  useEffect(() => {\n    async function fetchPaymentToken() {\n      if (currentPaymentToken || !jobId || paymentState !== \"due\") return;\n      \n      setLoadingPaymentToken(true);\n      try {\n        const { data: jobData } = await supabase\n          .from(\"jobs\")\n          .select(\"payment_token\")\n          .eq(\"id\", jobId)\n          .single();\n        \n        if (jobData?.payment_token) {\n          setCurrentPaymentToken(jobData.payment_token);\n        }\n      } catch (err) {\n        console.error(\"Error fetching payment token:\", err);\n      } finally {\n        setLoadingPaymentToken(false);\n      }\n    }\n    \n    fetchPaymentToken();\n  }, [jobId, paymentState, currentPaymentToken, supabase]);\n\n  // Load existing estimate line items when editing\n  async function loadExistingEstimate() {\n    setLoadingEstimateData(true);\n    try {\n      // Fetch the estimate\n      const { data: estimate } = await supabase\n        .from(\"estimates\")\n        .select(\"id\")\n        .eq(\"job_id\", jobId)\n        .maybeSingle();\n      \n      if (!estimate) {\n        setLoadingEstimateData(false);\n        return;\n      }\n\n      // Fetch estimate line items with paint details\n      const { data: estimateLineItems } = await supabase\n        .from(\"estimate_line_items\")\n        .select(\"*\")\n        .eq(\"estimate_id\", estimate.id)\n        .order(\"created_at\", { ascending: true });\n\n      if (estimateLineItems && estimateLineItems.length > 0) {\n        const loadedItems = estimateLineItems.map(item => {\n          // Determine type based on service_type\n          let type: LineItemType = \"other\";\n          let areaType: \"walls\" | \"ceilings\" | \"trim\" | \"doors\" | \"exterior_walls\" | \"exterior_trim\" | \"deck_fence\" | \"siding\" | \"other\" | undefined;\n\n          if (item.service_type === \"sqft\") {\n            type = \"area\";\n            // Parse area type from name\n            const nameLower = item.name.toLowerCase();\n            if (nameLower.includes(\"exterior\") && nameLower.includes(\"walls\")) areaType = \"exterior_walls\";\n            else if (nameLower.includes(\"exterior\") && nameLower.includes(\"trim\")) areaType = \"exterior_trim\";\n            else if (nameLower.includes(\"deck\") || nameLower.includes(\"fence\")) areaType = \"deck_fence\";\n            else if (nameLower.includes(\"siding\")) areaType = \"siding\";\n            else if (nameLower.includes(\"walls\")) areaType = \"walls\";\n            else if (nameLower.includes(\"ceiling\")) areaType = \"ceilings\";\n            else if (nameLower.includes(\"trim\")) areaType = \"trim\";\n            else if (nameLower.includes(\"door\")) areaType = \"doors\";\n            else areaType = \"other\";\n          }\n\n          return {\n            id: item.id,\n            type,\n            title: item.name,\n            price: (item.price / 100).toFixed(2),\n            areaType,\n            sqft: (item as any).sqft?.toString() || \"\",\n            ratePerSqft: (item as any).rate_per_sqft?.toString() || \"\",\n            paintBrand: item.product_line || \"\",\n            paintColor: item.paint_color_name_or_code || \"\",\n            paintSheen: item.sheen || \"\",\n            paintQuantity: item.gallons_estimate?.toString() || \"\",\n            paintQuantityUnit: \"gal\"\n          };\n        });\n\n        setLineItems(loadedItems);\n      }\n    } catch (error) {\n      console.error(\"Error loading estimate:\", error);\n      addToast(\"Failed to load estimate details\", \"error\");\n    } finally {\n      setLoadingEstimateData(false);\n    }\n  }\n\n  // Generate token when needed\n  async function ensurePublicToken() {\n    if (currentPublicToken || publicToken) return currentPublicToken || publicToken;\n    \n    setLoadingToken(true);\n    try {\n      const token = generateToken(24);\n      \n      // First check if estimate exists for this job\n      const { data: existingEstimate } = await supabase\n        .from(\"estimates\")\n        .select(\"id, public_token\")\n        .eq(\"job_id\", jobId)\n        .maybeSingle();\n\n      let estimateData;\n      let estimateError;\n\n      if (existingEstimate) {\n        // Update existing estimate with new token\n        const { data, error } = await supabase\n          .from(\"estimates\")\n          .update({\n            public_token: token,\n            status: \"sent\",\n            customer_id: customerId,\n            updated_at: new Date().toISOString(),\n          })\n          .eq(\"id\", existingEstimate.id)\n          .select(\"public_token\")\n          .single();\n        estimateData = data;\n        estimateError = error;\n      } else {\n        // Create new estimate\n        const { data, error } = await supabase\n          .from(\"estimates\")\n          .insert({\n            company_id: companyId,\n            job_id: jobId,\n            customer_id: customerId,\n            status: \"sent\",\n            public_token: token,\n          })\n          .select(\"public_token\")\n          .single();\n        estimateData = data;\n        estimateError = error;\n      }\n\n      if (estimateError) {\n        console.error(\"Estimate create/update error:\", estimateError);\n        // Still set the token for display even if DB save fails\n        setCurrentPublicToken(token);\n        return token;\n      } else if (estimateData) {\n        setCurrentPublicToken(estimateData.public_token);\n        return estimateData.public_token;\n      }\n    } catch (err) {\n      console.error(\"Error ensuring public token:\", err);\n      // Generate a temporary token for display\n      const tempToken = generateToken(24);\n      setCurrentPublicToken(tempToken);\n      return tempToken;\n    } finally {\n      setLoadingToken(false);\n    }\n    \n    return undefined;\n  }\n\n  const totalAmount = lineItems.reduce((sum, item) => {\n    if (item.type === \"area\" && item.ratePerSqft && item.sqft) {\n      const rate = parseFloat(item.ratePerSqft) || 0;\n      const sqft = parseFloat(item.sqft) || 0;\n      return sum + Math.round(rate * sqft * 100);\n    } else if (item.type === \"labor\" && item.hours && item.ratePerHour) {\n      const hours = parseFloat(item.hours) || 0;\n      const rate = parseFloat(item.ratePerHour) || 0;\n      return sum + Math.round(hours * rate * 100);\n    } else {\n      const price = parseFloat(item.price) || 0;\n      return sum + Math.round(price * 100);\n    }\n  }, 0);\n\n  // Helper to get label based on state\n  const getLabel = () => {\n    switch (paymentState) {\n      case \"none\":\n      case \"proposed\":\n        return \"Estimate\";\n      case \"approved\":\n        return \"Agreed Price\";\n      case \"due\":\n        return \"Payment Due\";\n      case \"paid\":\n        return \"Paid\";\n      default:\n        return \"Payment\";\n    }\n  };\n\n  // Helper to get badge variant\n  const getBadgeVariant = () => {\n    switch (paymentState) {\n      case \"proposed\":\n        return \"secondary\";\n      case \"approved\":\n        return \"default\";\n      case \"due\":\n        return \"warning\" as any;\n      case \"paid\":\n        return \"success\";\n      default:\n        return \"outline\";\n    }\n  };\n\n  const updateLineItem = (index: number, field: keyof PaymentLineItem, value: string | LineItemType) => {\n    const updated = [...lineItems];\n    (updated[index] as any)[field] = value;\n    // Reset type-specific fields when type changes and apply defaults\n    if (field === \"type\") {\n      if (value === \"area\") {\n        updated[index].areaType = \"walls\";\n        updated[index].ratePerSqft = estimatingConfig?.walls_rate_per_sqft?.toString() || \"\";\n        updated[index].sqft = \"\";\n        updated[index].price = \"\";\n      } else if (value === \"labor\") {\n        updated[index].hours = \"\";\n        updated[index].ratePerHour = estimatingConfig?.labor_rate_per_hour?.toString() || \"\";\n        updated[index].price = \"\";\n      } else {\n        updated[index].price = \"\";\n      }\n    }\n    // Apply default rate when area type changes\n    if (field === \"areaType\" && value === \"walls\") {\n      updated[index].ratePerSqft = estimatingConfig?.walls_rate_per_sqft?.toString() || \"\";\n    } else if (field === \"areaType\" && value === \"ceilings\") {\n      updated[index].ratePerSqft = estimatingConfig?.ceilings_rate_per_sqft?.toString() || \"\";\n    } else if (field === \"areaType\" && (value === \"trim\" || value === \"doors\")) {\n      updated[index].ratePerSqft = estimatingConfig?.trim_rate_per_sqft?.toString() || \"\";\n    }\n    setLineItems(updated);\n  };\n\n  const addLineItem = () => {\n    setLineItems([...lineItems, { \n      type: \"other\", \n      title: \"\", \n      price: \"\",\n      paintBrand: \"\",\n      paintColor: \"\",\n      paintSheen: \"\",\n      paintQuantity: \"\",\n      paintQuantityUnit: \"gal\"\n    }]);\n  };\n\n  const removeLineItem = (index: number) => {\n    if (lineItems.length === 1) return;\n    setLineItems(lineItems.filter((_, i) => i !== index));\n  };\n\n  // Create or update proposed payment\n  async function handleSaveProposed() {\n    // Validate that at least one line item is complete\n    const hasValidItem = lineItems.some(item => {\n      if (item.type === \"area\") {\n        return item.ratePerSqft && item.sqft && parseFloat(item.ratePerSqft) > 0 && parseFloat(item.sqft) > 0;\n      } else if (item.type === \"labor\") {\n        return item.hours && item.ratePerHour && parseFloat(item.hours) > 0 && parseFloat(item.ratePerHour) > 0;\n      } else {\n        return item.title.trim() && item.price.trim() && parseFloat(item.price) > 0;\n      }\n    });\n\n    if (!hasValidItem) {\n      addToast(\"Please add at least one complete line item\", \"error\");\n      return;\n    }\n\n    setSaving(true);\n    try {\n      // Update job payment - reset approval if revising an approved estimate\n      const jobUpdate: any = {\n        payment_state: \"proposed\",\n        payment_amount: totalAmount,\n      };\n      \n      // If this was previously approved, reset the approval\n      if (currentPaymentState === \"approved\") {\n        jobUpdate.payment_approved_at = null;\n      }\n\n      const { error: jobError } = await supabase\n        .from(\"jobs\")\n        .update(jobUpdate)\n        .eq(\"id\", jobId);\n\n      if (jobError) {\n        console.error(\"Job update error:\", jobError);\n        throw jobError;\n      }\n\n      // Update local state immediately for instant UI feedback\n      setCurrentPaymentState(\"proposed\");\n\n      // Delete old line items\n      const { error: deleteError } = await supabase\n        .from(\"job_payment_line_items\")\n        .delete()\n        .eq(\"job_id\", jobId);\n\n      if (deleteError) {\n        console.error(\"Delete line items error:\", deleteError);\n        throw deleteError;\n      }\n\n      // Insert new line items\n      const itemsToInsert = lineItems\n        .filter(item => {\n          if (item.type === \"area\") {\n            return item.ratePerSqft && item.sqft && parseFloat(item.ratePerSqft) > 0 && parseFloat(item.sqft) > 0;\n          } else if (item.type === \"labor\") {\n            return item.hours && item.ratePerHour && parseFloat(item.hours) > 0 && parseFloat(item.ratePerHour) > 0;\n          } else {\n            return item.title.trim() && item.price.trim() && parseFloat(item.price) > 0;\n          }\n        })\n        .map((item, index) => {\n          let title = \"\";\n          let price = 0;\n\n          if (item.type === \"area\" && item.areaType && item.ratePerSqft && item.sqft) {\n            const areaLabels: Record<string, string> = {\n              walls: \"Interior Walls\",\n              ceilings: \"Ceilings\",\n              trim: \"Interior Trim\",\n              doors: \"Doors\",\n              exterior_walls: \"Exterior Walls\",\n              exterior_trim: \"Exterior Trim\",\n              deck_fence: \"Deck/Fence\",\n              siding: \"Siding\",\n              other: \"Other\"\n            };\n            title = `${areaLabels[item.areaType]} - ${item.sqft} sqft @ $${item.ratePerSqft}/sqft`;\n            price = Math.round((parseFloat(item.ratePerSqft) || 0) * (parseFloat(item.sqft) || 0) * 100);\n          } else if (item.type === \"labor\" && item.hours && item.ratePerHour) {\n            title = `Labor - ${item.hours} hrs @ $${item.ratePerHour}/hr`;\n            price = Math.round((parseFloat(item.hours) || 0) * (parseFloat(item.ratePerHour) || 0) * 100);\n          } else {\n            title = item.title.trim();\n            price = Math.round((parseFloat(item.price) || 0) * 100);\n          }\n\n          return {\n            job_id: jobId,\n            title,\n            price,\n            sort_order: index,\n          };\n        });\n\n      if (itemsToInsert.length === 0) {\n        throw new Error(\"No valid line items to save\");\n      }\n\n      const { error: itemsError } = await supabase\n        .from(\"job_payment_line_items\")\n        .insert(itemsToInsert);\n\n      if (itemsError) {\n        console.error(\"Items insert error:\", itemsError);\n        throw itemsError;\n      }\n\n      // Create or update estimate record for public sharing\n      // Always update the estimate, whether or not we have a token\n      const token = currentPublicToken || generateToken(24);\n      \n      // First check if estimate exists for this job\n      const { data: existingEstimate } = await supabase\n        .from(\"estimates\")\n        .select(\"id, public_token\")\n        .eq(\"job_id\", jobId)\n        .maybeSingle();\n\n      let estimateId: string;\n      let estimateData;\n      let estimateError;\n\n      if (existingEstimate) {\n        // Update existing estimate and reset approval status\n        const { data, error } = await supabase\n          .from(\"estimates\")\n          .update({\n            public_token: token,\n            status: \"sent\",\n            customer_id: customerId,\n            accepted_at: null, // Reset acceptance if revising\n            updated_at: new Date().toISOString(),\n          })\n          .eq(\"id\", existingEstimate.id)\n          .select(\"id, public_token\")\n          .single();\n        estimateData = data;\n        estimateError = error;\n        estimateId = existingEstimate.id;\n      } else {\n        // Create new estimate\n        const { data, error } = await supabase\n          .from(\"estimates\")\n          .insert({\n            company_id: companyId,\n            job_id: jobId,\n            customer_id: customerId,\n            status: \"sent\",\n            public_token: token,\n          })\n          .select(\"id, public_token\")\n          .single();\n        estimateData = data;\n        estimateError = error;\n        estimateId = data?.id || \"\";\n      }\n\n      if (estimateError) {\n        console.error(\"Estimate create/update error:\", estimateError);\n        // Don't throw - estimate creation is optional for sharing\n      } else if (estimateData && estimateId) {\n        setCurrentPublicToken(estimateData.public_token);\n\n        // Delete old estimate line items\n        await supabase\n          .from(\"estimate_line_items\")\n          .delete()\n          .eq(\"estimate_id\", estimateId);\n\n        // Create estimate line items with paint details\n        const estimateLineItems = lineItems\n            .filter(item => {\n              if (item.type === \"area\") {\n                return item.ratePerSqft && item.sqft && parseFloat(item.ratePerSqft) > 0 && parseFloat(item.sqft) > 0;\n              } else if (item.type === \"labor\") {\n                return item.hours && item.ratePerHour && parseFloat(item.hours) > 0 && parseFloat(item.ratePerHour) > 0;\n              } else {\n                return item.title.trim() && item.price.trim() && parseFloat(item.price) > 0;\n              }\n            })\n            .map((item) => {\n              let name = \"\";\n              let price = 0;\n              let serviceType: \"sqft\" | \"flat\" = \"flat\";\n\n              if (item.type === \"area\" && item.areaType && item.ratePerSqft && item.sqft) {\n                const areaLabels: Record<string, string> = {\n                  walls: \"Interior Walls\",\n                  ceilings: \"Ceilings\",\n                  trim: \"Interior Trim\",\n                  doors: \"Doors\",\n                  exterior_walls: \"Exterior Walls\",\n                  exterior_trim: \"Exterior Trim\",\n                  deck_fence: \"Deck/Fence\",\n                  siding: \"Siding\",\n                  other: \"Other\"\n                };\n                name = areaLabels[item.areaType];\n                price = Math.round((parseFloat(item.ratePerSqft) || 0) * (parseFloat(item.sqft) || 0) * 100);\n                serviceType = \"sqft\";\n              } else if (item.type === \"labor\" && item.hours && item.ratePerHour) {\n                name = \"Labor\";\n                price = Math.round((parseFloat(item.hours) || 0) * (parseFloat(item.ratePerHour) || 0) * 100);\n              } else {\n                name = item.title.trim();\n                price = Math.round((parseFloat(item.price) || 0) * 100);\n              }\n\n              return {\n                estimate_id: estimateId,\n                service_key: \"other\",\n                service_type: serviceType,\n                name,\n                description: null,\n                price,\n                sqft: item.type === \"area\" && item.sqft ? parseFloat(item.sqft) : null,\n                rate_per_sqft: item.type === \"area\" && item.ratePerSqft ? parseFloat(item.ratePerSqft) : null,\n                paint_color_name_or_code: item.paintColor || null,\n                sheen: item.paintSheen || null,\n                product_line: item.paintBrand || null,\n                gallons_estimate: item.paintQuantity ? parseFloat(item.paintQuantity) : null,\n              };\n            });\n          \n          if (estimateLineItems.length > 0) {\n            await supabase\n              .from(\"estimate_line_items\")\n              .insert(estimateLineItems);\n              \n            // Auto-generate materials from line items with paint details\n            try {\n              await fetch(`/api/estimate-materials/${estimateId}/generate`, { method: \"POST\" });\n            } catch (error) {\n              console.error(\"Failed to auto-generate materials:\", error);\n            }\n          }\n        }\n\n      // Show appropriate message based on whether this was a revision\n      const wasApproved = currentPaymentState === \"approved\";\n      if (wasApproved) {\n        addToast(\"Estimate revised - customer needs to approve again\", \"success\");\n        // Immediately update local state to show proposed UI\n        setCurrentPaymentState(\"proposed\");\n      } else {\n        addToast(\"Estimate saved\", \"success\");\n      }\n      setEditingEstimate(false);\n\n      // Call onUpdate asynchronously to avoid blocking UI\n      setTimeout(() => onUpdate(), 100);\n    } catch (err: any) {\n      console.error(\"Failed to save payment:\", err);\n      console.error(\"Error details:\", {\n        message: err?.message,\n        code: err?.code,\n        details: err?.details,\n        hint: err?.hint,\n        fullError: err\n      });\n      const errorMessage = err?.message || err?.code || err?.details || JSON.stringify(err) || \"Unknown error\";\n      addToast(`Failed to save: ${errorMessage}`, \"error\");\n    } finally {\n      setSaving(false);\n    }\n  }\n\n  // Copy estimate link\n  async function handleCopyLink() {\n    const token = await ensurePublicToken();\n    if (!token) {\n      addToast(\"Unable to generate link\", \"error\");\n      return;\n    }\n\n    const link = `${window.location.origin}/e/${token}`;\n    copyToClipboard(link);\n    addToast(\"Estimate link copied to clipboard\", \"success\");\n    setShareDialogOpen(false);\n  }\n\n  // Copy pre-written message\n  async function handleCopyMessage() {\n    const token = await ensurePublicToken();\n    if (!token) {\n      addToast(\"Unable to generate link\", \"error\");\n      return;\n    }\n\n    const link = `${window.location.origin}/e/${token}`;\n    const customerName = \"there\"; // Could be passed as prop if needed\n    const message = `Hey ${customerName} â€” here's your estimate for ${formatCurrency(paymentAmount || totalAmount)}: ${link}. Let me know if you have any questions!`;\n    copyToClipboard(message);\n    addToast(\"Message copied to clipboard\", \"success\");\n    setShareDialogOpen(false);\n  }\n\n  // Customer approves (from public page or internal)\n  async function handleApprove() {\n    setSaving(true);\n    try {\n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          payment_state: \"approved\",\n          payment_approved_at: new Date().toISOString(),\n        })\n        .eq(\"id\", jobId);\n\n      if (error) throw error;\n\n      // Update local state immediately for instant UI feedback\n      setCurrentPaymentState(\"approved\");\n      \n      addToast(\"Price approved! ðŸŽ‰\", \"success\");\n      onUpdate();\n    } catch (err) {\n      console.error(\"Failed to approve:\", err);\n      addToast(\"Failed to approve\", \"error\");\n    } finally {\n      setSaving(false);\n    }\n  }\n\n  // Ensure payment token exists\n  async function ensurePaymentToken() {\n    if (currentPaymentToken) return currentPaymentToken;\n    \n    setLoadingPaymentToken(true);\n    try {\n      // First check if job already has a payment_token\n      const { data: jobData } = await supabase\n        .from(\"jobs\")\n        .select(\"payment_token\")\n        .eq(\"id\", jobId)\n        .single();\n\n      if (jobData?.payment_token) {\n        setCurrentPaymentToken(jobData.payment_token);\n        return jobData.payment_token;\n      }\n\n      // Generate new token\n      const token = generateToken(24);\n      \n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          payment_token: token,\n        })\n        .eq(\"id\", jobId);\n\n      if (error) throw error;\n\n      setCurrentPaymentToken(token);\n      return token;\n    } catch (err) {\n      console.error(\"Failed to generate payment token:\", err);\n      addToast(\"Failed to generate payment link\", \"error\");\n      return null;\n    } finally {\n      setLoadingPaymentToken(false);\n    }\n  }\n\n  // Mark as due (when job is done)\n  async function handleMarkDue() {\n    // Use default payment methods if none selected (cash, check, venmo, stripe)\n    const methodsToUse = selectedPaymentMethods.length > 0 \n      ? selectedPaymentMethods \n      : [\"cash\", \"check\", \"venmo\", \"stripe\"];\n\n    setSaving(true);\n    try {\n      // Generate payment token if it doesn't exist\n      const token = await ensurePaymentToken();\n      if (!token) {\n        setSaving(false);\n        return;\n      }\n\n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          payment_state: \"due\",\n          payment_token: token,\n          payment_methods: methodsToUse,\n        })\n        .eq(\"id\", jobId);\n\n      if (error) throw error;\n\n      // Update local state immediately for instant UI feedback\n      setCurrentPaymentState(\"due\");\n      \n      addToast(\"Payment requested\", \"success\");\n      onUpdate();\n    } catch (err) {\n      console.error(\"Failed to mark due:\", err);\n      addToast(\"Failed to request payment\", \"error\");\n    } finally {\n      setSaving(false);\n    }\n  }\n\n  // Mark as paid\n  async function handleMarkPaid() {\n    setSaving(true);\n    try {\n      const { error } = await supabase\n        .from(\"jobs\")\n        .update({\n          payment_state: \"paid\",\n          payment_paid_at: new Date().toISOString(),\n          payment_method: paidMethod,\n          status: \"paid\", // Also update job status to move card to paid column\n          updated_at: new Date().toISOString(),\n        })\n        .eq(\"id\", jobId);\n\n      if (error) throw error;\n\n      // Update local state immediately for instant UI feedback\n      const paidAt = new Date().toISOString();\n      setCurrentPaymentState(\"paid\");\n      setCurrentPaymentPaidAt(paidAt);\n      setCurrentPaymentMethod(paidMethod);\n      \n      addToast(\"Payment recorded! ðŸ’°\", \"success\");\n      setMarkPaidDialogOpen(false);\n      onUpdate();\n    } catch (err) {\n      console.error(\"Failed to mark paid:\", err);\n      addToast(\"Failed to record payment\", \"error\");\n    } finally {\n      setSaving(false);\n    }\n  }\n\n  return (\n    <>\n      {/* Share Estimate Dialog */}\n      <Dialog open={shareDialogOpen} onOpenChange={async (open) => {\n        setShareDialogOpen(open);\n        if (open) {\n          // Ensure token exists when dialog opens\n          await ensurePublicToken();\n        }\n      }}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Share Estimate</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"space-y-3\">\n              <div>\n                <Label className=\"text-sm text-muted-foreground\">Estimate Link</Label>\n                <div className=\"flex gap-2 mt-2\">\n                  <Input \n                    value={loadingToken ? \"Generating...\" : (typeof window !== \"undefined\" && (currentPublicToken || publicToken) ? `${window.location.origin}/e/${currentPublicToken || publicToken}` : \"No token available\")}\n                    readOnly \n                    className=\"font-mono text-sm\"\n                  />\n                  <Button \n                    variant=\"outline\"\n                    onClick={handleCopyLink}\n                    disabled={loadingToken}\n                    className=\"shrink-0\"\n                  >\n                    <Copy className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n\n              <div>\n                <Label className=\"text-sm text-muted-foreground\">Pre-written Message</Label>\n                <Textarea\n                  value={loadingToken ? \"Generating link...\" : `Hey there â€” here's your estimate for ${formatCurrency(paymentAmount || totalAmount)}: ${typeof window !== \"undefined\" && (currentPublicToken || publicToken) ? `${window.location.origin}/e/${currentPublicToken || publicToken}` : \"[link will be generated]\"}. Let me know if you have any questions!`}\n                  readOnly\n                  rows={4}\n                  className=\"mt-2 font-sans\"\n                />\n                <Button\n                  onClick={handleCopyMessage}\n                  className=\"w-full mt-2\"\n                  disabled={loadingToken}\n                >\n                  <Copy className=\"mr-2 h-4 w-4\" />\n                  Copy Message\n                </Button>\n              </div>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Share Payment Dialog */}\n      <Dialog open={sharePaymentDialogOpen} onOpenChange={async (open) => {\n        setSharePaymentDialogOpen(open);\n        if (open) {\n          await ensurePaymentToken();\n        }\n      }}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Share Payment</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            {loadingPaymentToken ? (\n              <div className=\"text-center py-4\">\n                <p className=\"text-sm text-muted-foreground\">Generating link...</p>\n              </div>\n            ) : !currentPaymentToken ? (\n              <div className=\"text-center py-4\">\n                <p className=\"text-sm text-destructive\">No token available</p>\n              </div>\n            ) : (\n              <>\n                <div className=\"rounded-lg border bg-card p-4\">\n                  <p className=\"text-sm text-muted-foreground mb-2\">Amount Due</p>\n                  <p className=\"font-semibold text-lg\">\n                    {formatCurrency(paymentAmount || 0)}\n                  </p>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <div>\n                    <Label className=\"text-sm text-muted-foreground\">Payment Link</Label>\n                    <div className=\"flex gap-2 mt-2\">\n                      <Input \n                        value={typeof window !== \"undefined\" && currentPaymentToken ? `${window.location.origin}/p/${currentPaymentToken}` : \"\"} \n                        readOnly \n                        className=\"font-mono text-sm\"\n                      />\n                      <Button \n                        variant=\"outline\"\n                        onClick={() => {\n                          const link = `${window.location.origin}/p/${currentPaymentToken}`;\n                          copyToClipboard(link);\n                          addToast(\"Payment link copied\", \"success\");\n                        }}\n                        disabled={loadingPaymentToken}\n                        className=\"shrink-0\"\n                      >\n                        <Copy className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n\n                  <div>\n                    <Label className=\"text-sm text-muted-foreground\">Pre-written Message</Label>\n                    <Textarea \n                      value={`Hey there â€” here's your invoice for ${formatCurrency(paymentAmount || 0)}: ${typeof window !== \"undefined\" && currentPaymentToken ? `${window.location.origin}/p/${currentPaymentToken}` : \"[link will be generated]\"}. Thank you!`}\n                      readOnly \n                      rows={4}\n                      className=\"mt-2 font-sans\"\n                    />\n                    <Button \n                      onClick={() => {\n                        const link = `${window.location.origin}/p/${currentPaymentToken}`;\n                        const customerName = \"there\"; // Could be passed as prop if needed\n                        const message = `Hey ${customerName} â€” here's your invoice for ${formatCurrency(paymentAmount || 0)}: ${link}. Thank you!`;\n                        copyToClipboard(message);\n                        addToast(\"Message copied to clipboard\", \"success\");\n                        setSharePaymentDialogOpen(false);\n                      }}\n                      className=\"w-full mt-2\"\n                      disabled={loadingPaymentToken}\n                    >\n                      <Copy className=\"mr-2 h-4 w-4\" />\n                      Copy Message\n                    </Button>\n                  </div>\n                </div>\n              </>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <div className=\"rounded-lg border bg-card p-4 space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <h3 className=\"font-semibold\">{getLabel()}</h3>\n            {paymentState !== \"none\" && (\n              <Badge variant={getBadgeVariant()}>\n                {paymentState.charAt(0).toUpperCase() + paymentState.slice(1)}\n              </Badge>\n            )}\n            {estimateStatus === \"denied\" && (\n              <Badge variant=\"destructive\">Denied</Badge>\n            )}\n          </div>\n          {paymentAmount && (\n            <div className=\"text-xl font-bold\">\n              {formatCurrency(paymentAmount)}\n            </div>\n          )}\n        </div>\n\n        {/* DENIED ESTIMATE ALERT */}\n        {estimateStatus === \"denied\" && (\n          <div className=\"rounded-lg border-2 border-destructive bg-destructive/10 p-4 space-y-3\">\n            <div className=\"flex items-start gap-3\">\n              <div className=\"w-6 h-6 rounded-full bg-destructive text-white flex items-center justify-center shrink-0 mt-0.5\">\n                âœ—\n              </div>\n              <div className=\"flex-1 space-y-2\">\n                <div>\n                  <h4 className=\"font-semibold text-destructive\">Customer Declined Estimate</h4>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    Declined on {formatDate(estimateDeniedAt || new Date().toISOString())}\n                  </p>\n                </div>\n                {estimateDenialReason && (\n                  <div className=\"bg-card p-3 rounded-lg border\">\n                    <p className=\"text-sm font-medium mb-1\">Customer Feedback:</p>\n                    <p className=\"text-sm text-muted-foreground\">{estimateDenialReason}</p>\n                  </div>\n                )}\n                <div className=\"flex gap-2 pt-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={async () => {\n                      await loadExistingEstimate();\n                      setEditingEstimate(true);\n                    }}\n                    disabled={loadingEstimateData}\n                  >\n                    <Edit2 className=\"h-4 w-4 mr-2\" />\n                    {loadingEstimateData ? \"Loading...\" : \"Revise Estimate\"}\n                  </Button>\n                </div>\n                <p className=\"text-xs text-muted-foreground\">\n                  Review the customer's feedback and revise the estimate. You can adjust pricing, scope, or send a message to discuss their concerns.\n                </p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* PROPOSED STATE - Create/Edit Estimate */}\n        {((currentPaymentState === \"none\" || currentPaymentState === \"proposed\") || (currentPaymentState === \"approved\" && editingEstimate)) && (\n          <div className=\"space-y-4\">\n            {/* Simple view when estimate exists */}\n            {currentPaymentState === \"proposed\" && initialLineItems.length > 0 && !editingEstimate ? (\n              <>\n                <div className=\"rounded-lg border bg-muted/30 p-4 space-y-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <h4 className=\"font-medium text-sm\">Estimate Total</h4>\n                    <span className=\"text-lg font-bold\">{formatCurrency(paymentAmount || totalAmount)}</span>\n                  </div>\n                  <div className=\"space-y-1\">\n                    {initialLineItems.map((item) => (\n                      <div key={item.id} className=\"flex justify-between text-sm text-muted-foreground\">\n                        <span>{item.title}</span>\n                        <span>{formatCurrency(item.price)}</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={async () => {\n                      await ensurePublicToken();\n                      setShareDialogOpen(true);\n                    }}\n                    className=\"flex-1\"\n                  >\n                    <Share2 className=\"mr-2 h-4 w-4\" />\n                    Share Estimate\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    onClick={async () => {\n                      await loadExistingEstimate();\n                      setEditingEstimate(true);\n                    }}\n                    disabled={loadingEstimateData}\n                    className=\"flex-1\"\n                  >\n                    <Pencil className=\"mr-2 h-4 w-4\" />\n                    {loadingEstimateData ? \"Loading...\" : \"Edit\"}\n                  </Button>\n                  {customerId && (\n                    <Button\n                      variant=\"default\"\n                      onClick={handleApprove}\n                      loading={saving}\n                      className=\"flex-1\"\n                    >\n                      <Check className=\"mr-2 h-4 w-4\" />\n                      Approve\n                    </Button>\n                  )}\n                </div>\n              </>\n            ) : (\n              <>\n            <div className=\"rounded-lg border bg-muted/30 p-4 space-y-4\">\n              {lineItems.map((item, index) => {\n                const itemTotal = item.type === \"area\" && item.ratePerSqft && item.sqft\n                  ? (parseFloat(item.ratePerSqft) || 0) * (parseFloat(item.sqft) || 0)\n                  : item.type === \"labor\" && item.hours && item.ratePerHour\n                  ? (parseFloat(item.hours) || 0) * (parseFloat(item.ratePerHour) || 0)\n                  : parseFloat(item.price) || 0;\n\n                return (\n                  <div key={index} className=\"p-3 sm:p-4 rounded-lg border bg-card space-y-3\">\n                    <div className=\"flex items-center justify-between gap-2\">\n                      <Select\n                        value={item.type}\n                        onChange={(e) => updateLineItem(index, \"type\", e.target.value as LineItemType)}\n                        className=\"flex-1 min-h-[44px]\"\n                      >\n                        <option value=\"area\">Area</option>\n                        <option value=\"labor\">Labor</option>\n                        <option value=\"other\">Other</option>\n                      </Select>\n                      {lineItems.length > 1 && (\n                        <button\n                          onClick={() => removeLineItem(index)}\n                          className=\"text-muted-foreground hover:text-destructive min-h-[44px] w-11 flex items-center justify-center shrink-0 touch-target\"\n                          aria-label=\"Remove line item\"\n                        >\n                          <Trash2 className=\"h-5 w-5\" />\n                        </button>\n                      )}\n                    </div>\n\n                    {item.type === \"area\" ? (\n                      <div className=\"space-y-3\">\n                        <div>\n                          <Label className=\"text-xs text-muted-foreground mb-1\">Area Type</Label>\n                          <Select\n                            value={item.areaType || \"walls\"}\n                            onChange={(e) => updateLineItem(index, \"areaType\", e.target.value)}\n                            className=\"w-full min-h-[44px]\"\n                          >\n                            <optgroup label=\"Interior\">\n                              <option value=\"walls\">Interior Walls</option>\n                              <option value=\"ceilings\">Ceilings</option>\n                              <option value=\"trim\">Interior Trim</option>\n                              <option value=\"doors\">Doors</option>\n                            </optgroup>\n                            <optgroup label=\"Exterior\">\n                              <option value=\"exterior_walls\">Exterior Walls</option>\n                              <option value=\"exterior_trim\">Exterior Trim</option>\n                              <option value=\"deck_fence\">Deck/Fence</option>\n                              <option value=\"siding\">Siding</option>\n                            </optgroup>\n                            <option value=\"other\">Other</option>\n                          </Select>\n                        </div>\n                        <div className=\"grid grid-cols-2 gap-3\">\n                          <div>\n                            <Label className=\"text-xs text-muted-foreground mb-1\">Square Feet</Label>\n                            <Input\n                              type=\"number\"\n                              step=\"0.01\"\n                              min=\"0\"\n                              placeholder=\"0\"\n                              value={item.sqft || \"\"}\n                              onChange={(e) => updateLineItem(index, \"sqft\", e.target.value)}\n                              className=\"min-h-[44px]\"\n                            />\n                          </div>\n                          <div>\n                            <Label className=\"text-xs text-muted-foreground mb-1\">Rate ($/sqft)</Label>\n                            <Input\n                              type=\"number\"\n                              step=\"0.01\"\n                              min=\"0\"\n                              placeholder=\"0.00\"\n                              value={item.ratePerSqft || \"\"}\n                              onChange={(e) => updateLineItem(index, \"ratePerSqft\", e.target.value)}\n                              className=\"min-h-[44px]\"\n                            />\n                          </div>\n                        </div>\n                        <div className=\"flex items-center justify-between pt-2 border-t\">\n                          <span className=\"text-sm font-medium text-muted-foreground\">Total</span>\n                          <span className=\"text-lg font-bold\">{formatCurrency(Math.round(itemTotal * 100))}</span>\n                        </div>\n                        \n                        {/* Paint Details - Only for Area type */}\n                        <div className=\"pt-3 border-t space-y-3\">\n                          <Label className=\"text-xs font-semibold\">Paint Details</Label>\n\n                          <div className=\"grid grid-cols-2 gap-3\">\n                            <div className=\"space-y-2\">\n                              <Label className=\"text-xs text-muted-foreground\">Brand</Label>\n                              <Select\n                                value={item.paintBrand || \"\"}\n                                onChange={(e) => updateLineItem(index, \"paintBrand\", e.target.value)}\n                                className=\"min-h-[44px]\"\n                              >\n                                <option value=\"\">Select brand...</option>\n                                <option value=\"Sherwin-Williams\">Sherwin-Williams</option>\n                                <option value=\"Benjamin Moore\">Benjamin Moore</option>\n                                <option value=\"Behr\">Behr</option>\n                                <option value=\"PPG\">PPG</option>\n                                <option value=\"Other\">Other</option>\n                              </Select>\n                            </div>\n                            <div className=\"space-y-2\">\n                              <Label className=\"text-xs text-muted-foreground\">Color</Label>\n                              <Input\n                                placeholder=\"e.g., SW 7008 Alabaster\"\n                                value={item.paintColor || \"\"}\n                                onChange={(e) => updateLineItem(index, \"paintColor\", e.target.value)}\n                                className=\"min-h-[44px]\"\n                              />\n                            </div>\n                          </div>\n\n                          <div className=\"grid grid-cols-2 gap-3\">\n                            <div className=\"space-y-2\">\n                              <Label className=\"text-xs text-muted-foreground\">Sheen</Label>\n                              <Select\n                                value={item.paintSheen || \"\"}\n                                onChange={(e) => updateLineItem(index, \"paintSheen\", e.target.value)}\n                                className=\"min-h-[44px]\"\n                              >\n                                <option value=\"\">Select sheen...</option>\n                                <option value=\"Flat\">Flat</option>\n                                <option value=\"Matte\">Matte</option>\n                                <option value=\"Eggshell\">Eggshell</option>\n                                <option value=\"Satin\">Satin</option>\n                                <option value=\"Semi-Gloss\">Semi-Gloss</option>\n                                <option value=\"Gloss\">Gloss</option>\n                              </Select>\n                            </div>\n                            <div className=\"space-y-2\">\n                              <Label className=\"text-xs text-muted-foreground\">Quantity</Label>\n                              <div className=\"flex gap-2\">\n                                <Input\n                                  type=\"number\"\n                                  min=\"0\"\n                                  step=\"0.25\"\n                                  placeholder=\"e.g., 3\"\n                                  value={item.paintQuantity || \"\"}\n                                  onChange={(e) => updateLineItem(index, \"paintQuantity\", e.target.value)}\n                                  className=\"min-h-[44px] flex-1\"\n                                />\n                                <Select\n                                  value={item.paintQuantityUnit || \"gal\"}\n                                  onChange={(e) => updateLineItem(index, \"paintQuantityUnit\", e.target.value)}\n                                  className=\"min-h-[44px] w-28\"\n                                >\n                                  <option value=\"gal\">Gallons</option>\n                                  <option value=\"qt\">Quarts</option>\n                                  <option value=\"pt\">Pints</option>\n                                  <option value=\"oz\">Oz</option>\n                                </Select>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    ) : item.type === \"labor\" ? (\n                      <div className=\"space-y-3\">\n                        <div className=\"grid grid-cols-2 gap-3\">\n                          <div>\n                            <Label className=\"text-xs text-muted-foreground mb-1\">Hours</Label>\n                            <Input\n                              type=\"number\"\n                              step=\"0.25\"\n                              min=\"0\"\n                              placeholder=\"0\"\n                              value={item.hours || \"\"}\n                              onChange={(e) => updateLineItem(index, \"hours\", e.target.value)}\n                              className=\"min-h-[44px]\"\n                            />\n                          </div>\n                          <div>\n                            <Label className=\"text-xs text-muted-foreground mb-1\">Rate ($/hr)</Label>\n                            <Input\n                              type=\"number\"\n                              step=\"0.01\"\n                              min=\"0\"\n                              placeholder=\"0.00\"\n                              value={item.ratePerHour || \"\"}\n                              onChange={(e) => updateLineItem(index, \"ratePerHour\", e.target.value)}\n                              className=\"min-h-[44px]\"\n                            />\n                          </div>\n                        </div>\n                        <div className=\"flex items-center justify-between pt-2 border-t\">\n                          <span className=\"text-sm font-medium text-muted-foreground\">Total</span>\n                          <span className=\"text-lg font-bold\">{formatCurrency(Math.round(itemTotal * 100))}</span>\n                        </div>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-3\">\n                        <div>\n                          <Label className=\"text-xs text-muted-foreground mb-1\">Description</Label>\n                          <Input\n                            placeholder=\"e.g., Materials, Travel, etc.\"\n                            value={item.title}\n                            onChange={(e) => updateLineItem(index, \"title\", e.target.value)}\n                            className=\"w-full min-h-[44px]\"\n                          />\n                        </div>\n                        <div>\n                          <Label className=\"text-xs text-muted-foreground mb-1\">Amount</Label>\n                          <div className=\"relative\">\n                            <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground\">$</span>\n                            <Input\n                              type=\"number\"\n                              step=\"0.01\"\n                              min=\"0.01\"\n                              placeholder=\"0.00\"\n                              value={item.price}\n                              onChange={(e) => updateLineItem(index, \"price\", e.target.value)}\n                              className=\"pl-7 min-h-[44px]\"\n                            />\n                          </div>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                );\n              })}\n              <div className=\"flex gap-2\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={addLineItem}\n                  className=\"flex-1 touch-target min-h-[44px]\"\n                >\n                  <Plus className=\"mr-2 h-4 w-4\" />\n                  Add Line\n                </Button>\n                <Button\n                  onClick={handleSaveProposed}\n                  loading={saving}\n                  disabled={lineItems.every(item => {\n                    if (item.type === \"area\") {\n                      return !item.ratePerSqft || !item.sqft || parseFloat(item.ratePerSqft || \"0\") <= 0 || parseFloat(item.sqft || \"0\") <= 0;\n                    } else if (item.type === \"labor\") {\n                      return !item.hours || !item.ratePerHour || parseFloat(item.hours || \"0\") <= 0 || parseFloat(item.ratePerHour || \"0\") <= 0;\n                    } else {\n                      return !item.title.trim() || !item.price.trim() || parseFloat(item.price) <= 0;\n                    }\n                  })}\n                  className=\"flex-1 touch-target min-h-[44px]\"\n                >\n                  {currentPaymentState === \"proposed\" || (currentPaymentState === \"approved\" && editingEstimate)\n                    ? \"Update Estimate\"\n                    : \"Create Estimate\"}\n                </Button>\n              </div>\n            </div>\n\n            {editingEstimate && (\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setEditingEstimate(false);\n                    // Reset line items to initial state\n                    setLineItems(\n                      initialLineItems.length > 0\n                        ? initialLineItems.map(item => ({ \n                            id: item.id, \n                            type: \"other\" as LineItemType,\n                            title: item.title, \n                            price: (item.price / 100).toFixed(2) \n                          }))\n                        : [{ type: \"other\", title: \"\", price: \"\" }]\n                    );\n                  }}\n                  className=\"flex-1\"\n                >\n                  Cancel\n                </Button>\n              </div>\n            )}\n            </>\n            )}\n          </div>\n        )}\n\n        {/* APPROVED STATE - Price Locked */}\n        {currentPaymentState === \"approved\" && !editingEstimate && (\n          <div className=\"space-y-4\">\n            <div className=\"rounded-lg border bg-success/10 border-success/20 p-4\">\n              <p className=\"text-sm font-medium text-success mb-2\">\n                âœ“ Thanks for approving!\n              </p>\n              <p className=\"text-sm text-muted-foreground\">\n                Price is locked at {formatCurrency(paymentAmount || 0)}\n              </p>\n              {paymentApprovedAt && (\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Approved {formatDate(paymentApprovedAt)}\n                </p>\n              )}\n            </div>\n\n            <div className=\"flex gap-2\">\n              <Button\n                variant=\"outline\"\n                onClick={async () => {\n                  await loadExistingEstimate();\n                  setEditingEstimate(true);\n                }}\n                disabled={loadingEstimateData}\n                className=\"flex-1\"\n              >\n                <Edit2 className=\"mr-2 h-4 w-4\" />\n                {loadingEstimateData ? \"Loading...\" : \"Revise Estimate\"}\n              </Button>\n              <Button\n                onClick={handleMarkDue}\n                loading={saving}\n                className=\"flex-1\"\n              >\n                <DollarSign className=\"mr-2 h-4 w-4\" />\n                Finalize Payment\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {/* DUE STATE - Payment Requested */}\n        {currentPaymentState === \"due\" && (\n          <div className=\"space-y-4\">\n            <div className=\"rounded-lg border bg-warning/10 border-warning/20 p-4\">\n              <p className=\"text-sm font-medium text-foreground mb-2\">\n                ðŸ’° Payment Requested\n              </p>\n              <p className=\"text-sm text-muted-foreground\">\n                Amount due: {formatCurrency(paymentAmount || 0)}\n              </p>\n            </div>\n\n            {/* Line Items (read-only) */}\n            <div className=\"space-y-2\">\n              {initialLineItems.map((item) => (\n                <div key={item.id} className=\"flex justify-between text-sm\">\n                  <span>{item.title}</span>\n                  <span className=\"font-medium\">{formatCurrency(item.price)}</span>\n                </div>\n              ))}\n            </div>\n\n            <div className=\"flex gap-2\">\n              <Button\n                variant=\"outline\"\n                onClick={async () => {\n                  await ensurePaymentToken();\n                  setSharePaymentDialogOpen(true);\n                }}\n                className=\"flex-1\"\n              >\n                <Share2 className=\"mr-2 h-4 w-4\" />\n                Share Payment\n              </Button>\n              <Button\n                onClick={() => setMarkPaidDialogOpen(true)}\n                className=\"flex-1\"\n              >\n                <Check className=\"mr-2 h-4 w-4\" />\n                Mark as Paid\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {/* PAID STATE - Payment Complete */}\n        {currentPaymentState === \"paid\" && (\n          <div className=\"space-y-4\">\n            <div className=\"rounded-lg border bg-success/10 border-success/20 p-4\">\n              <p className=\"text-sm font-medium text-success mb-2\">\n                âœ“ Payment Received\n              </p>\n              <div className=\"space-y-1 text-sm text-muted-foreground\">\n                {currentPaymentPaidAt && (\n                  <p>Paid on {formatDate(currentPaymentPaidAt)}</p>\n                )}\n                {currentPaymentMethod && (\n                  <p className=\"capitalize\">Method: {currentPaymentMethod}</p>\n                )}\n              </div>\n            </div>\n\n            {/* Line Items (read-only) */}\n            <div className=\"space-y-2\">\n              {initialLineItems.map((item) => (\n                <div key={item.id} className=\"flex justify-between text-sm\">\n                  <span>{item.title}</span>\n                  <span className=\"font-medium\">{formatCurrency(item.price)}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Mark Paid Dialog */}\n      <Dialog open={markPaidDialogOpen} onOpenChange={setMarkPaidDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Record Payment</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 mt-4\">\n            <div className=\"rounded-lg bg-muted p-3\">\n              <p className=\"text-sm text-muted-foreground\">Amount:</p>\n              <p className=\"text-2xl font-bold\">{formatCurrency(paymentAmount || 0)}</p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Payment Method</Label>\n              <select\n                value={paidMethod}\n                onChange={(e) => setPaidMethod(e.target.value)}\n                className=\"w-full rounded-md border border-input bg-background px-3 py-2\"\n              >\n                <option value=\"cash\">Cash</option>\n                <option value=\"check\">Check</option>\n                <option value=\"card\">Credit/Debit Card</option>\n                <option value=\"zelle\">Zelle</option>\n                <option value=\"venmo\">Venmo</option>\n                <option value=\"other\">Other</option>\n              </select>\n            </div>\n\n            <div className=\"flex gap-3\">\n              <Button variant=\"outline\" onClick={() => setMarkPaidDialogOpen(false)} className=\"flex-1\">\n                Cancel\n              </Button>\n              <Button onClick={handleMarkPaid} loading={saving} className=\"flex-1\">\n                Record Payment\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}\n","\"use client\";\n\nimport { useState } from \"react\";\nimport { Calendar, Clock } from \"lucide-react\";\nimport { Input } from \"./input\";\nimport { Label } from \"./label\";\nimport { cn } from \"@/lib/utils\";\n\ninterface DateTimePickerProps {\n  date: string | null;\n  time: string | null;\n  onDateChange: (date: string) => void;\n  onTimeChange: (time: string) => void;\n  label?: string;\n  className?: string;\n  disabled?: boolean;\n}\n\nexport function DateTimePicker({\n  date,\n  time,\n  onDateChange,\n  onTimeChange,\n  label = \"Date & Time\",\n  className,\n  disabled = false,\n}: DateTimePickerProps) {\n  const [focused, setFocused] = useState<\"date\" | \"time\" | null>(null);\n  const dateValue = date || \"\";\n  const timeValue = time || \"\";\n\n  const formattedDate = date\n    ? new Date(date + \"T00:00\").toLocaleDateString(\"en-US\", {\n        weekday: \"short\",\n        month: \"short\",\n        day: \"numeric\",\n        year: \"numeric\",\n      })\n    : \"\";\n\n  return (\n    <div className={cn(\"space-y-2\", className)}>\n      {label && <Label className=\"text-sm font-medium\">{label}</Label>}\n      <div className=\"grid gap-3 grid-cols-1 sm:grid-cols-2\">\n        <div className=\"space-y-1.5\">\n          <div\n            className={cn(\n              \"relative rounded-lg border bg-background transition-all\",\n              focused === \"date\"\n                ? \"ring-2 ring-primary ring-offset-2 border-primary\"\n                : \"border-input hover:border-muted-foreground/50\",\n              disabled && \"opacity-50 cursor-not-allowed\"\n            )}\n          >\n            <Calendar className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10\" />\n            <Input\n              type=\"date\"\n              value={dateValue}\n              onChange={(e) => onDateChange(e.target.value)}\n              onFocus={() => setFocused(\"date\")}\n              onBlur={() => setFocused(null)}\n              disabled={disabled}\n              className=\"pl-10 border-0 focus-visible:ring-0 focus-visible:ring-offset-0 min-h-[44px] cursor-pointer bg-transparent\"\n            />\n          </div>\n          {formattedDate && (\n            <p className=\"text-sm text-muted-foreground mt-1 ml-1\">\n              {formattedDate}\n            </p>\n          )}\n        </div>\n        <div className=\"space-y-1.5\">\n          <div\n            className={cn(\n              \"relative rounded-lg border bg-background transition-all\",\n              focused === \"time\"\n                ? \"ring-2 ring-primary ring-offset-2 border-primary\"\n                : \"border-input hover:border-muted-foreground/50\",\n              disabled && \"opacity-50 cursor-not-allowed\"\n            )}\n          >\n            <Clock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10\" />\n            <Input\n              type=\"time\"\n              value={timeValue}\n              onChange={(e) => onTimeChange(e.target.value)}\n              onFocus={() => setFocused(\"time\")}\n              onBlur={() => setFocused(null)}\n              disabled={disabled}\n              className=\"pl-10 border-0 focus-visible:ring-0 focus-visible:ring-offset-0 min-h-[44px] cursor-pointer bg-transparent\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['rect', { width: '14', height: '14', x: '8', y: '8', rx: '2', ry: '2', key: '17jyea' }],\n  ['path', { d: 'M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2', key: 'zix9uf' }],\n];\n\n/**\n * @component @name Copy\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHg9IjgiIHk9IjgiIHJ4PSIyIiByeT0iMiIgLz4KICA8cGF0aCBkPSJNNCAxNmMtMS4xIDAtMi0uOS0yLTJWNGMwLTEuMS45LTIgMi0yaDEwYzEuMSAwIDIgLjkgMiAyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/copy\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Copy = createLucideIcon('copy', __iconNode);\n\nexport default Copy;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M16 5h6', key: '1vod17' }],\n  ['path', { d: 'M19 2v6', key: '4bpg5p' }],\n  ['path', { d: 'M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5', key: '1ue2ih' }],\n  ['path', { d: 'm21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21', key: '1xmnt7' }],\n  ['circle', { cx: '9', cy: '9', r: '2', key: 'af1f0g' }],\n];\n\n/**\n * @component @name ImagePlus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgNWg2IiAvPgogIDxwYXRoIGQ9Ik0xOSAydjYiIC8+CiAgPHBhdGggZD0iTTIxIDExLjVWMTlhMiAyIDAgMCAxLTIgMkg1YTIgMiAwIDAgMS0yLTJWNWEyIDIgMCAwIDEgMi0yaDcuNSIgLz4KICA8cGF0aCBkPSJtMjEgMTUtMy4wODYtMy4wODZhMiAyIDAgMCAwLTIuODI4IDBMNiAyMSIgLz4KICA8Y2lyY2xlIGN4PSI5IiBjeT0iOSIgcj0iMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/image-plus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ImagePlus = createLucideIcon('image-plus', __iconNode);\n\nexport default ImagePlus;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['circle', { cx: '18', cy: '5', r: '3', key: 'gq8acd' }],\n  ['circle', { cx: '6', cy: '12', r: '3', key: 'w7nqdw' }],\n  ['circle', { cx: '18', cy: '19', r: '3', key: '1xt0gg' }],\n  ['line', { x1: '8.59', x2: '15.42', y1: '13.51', y2: '17.49', key: '47mynk' }],\n  ['line', { x1: '15.41', x2: '8.59', y1: '6.51', y2: '10.49', key: '1n3mei' }],\n];\n\n/**\n * @component @name Share2\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxOCIgY3k9IjUiIHI9IjMiIC8+CiAgPGNpcmNsZSBjeD0iNiIgY3k9IjEyIiByPSIzIiAvPgogIDxjaXJjbGUgY3g9IjE4IiBjeT0iMTkiIHI9IjMiIC8+CiAgPGxpbmUgeDE9IjguNTkiIHgyPSIxNS40MiIgeTE9IjEzLjUxIiB5Mj0iMTcuNDkiIC8+CiAgPGxpbmUgeDE9IjE1LjQxIiB4Mj0iOC41OSIgeTE9IjYuNTEiIHkyPSIxMC40OSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/share-2\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Share2 = createLucideIcon('share-2', __iconNode);\n\nexport default Share2;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z',\n      key: '1a8usu',\n    },\n  ],\n];\n\n/**\n * @component @name Pen\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuMTc0IDYuODEyYTEgMSAwIDAgMC0zLjk4Ni0zLjk4N0wzLjg0MiAxNi4xNzRhMiAyIDAgMCAwLS41LjgzbC0xLjMyMSA0LjM1MmEuNS41IDAgMCAwIC42MjMuNjIybDQuMzUzLTEuMzJhMiAyIDAgMCAwIC44My0uNDk3eiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/pen\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Pen = createLucideIcon('pen', __iconNode);\n\nexport default Pen;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z',\n      key: '1c8476',\n    },\n  ],\n  ['path', { d: 'M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7', key: '1ydtos' }],\n  ['path', { d: 'M7 3v4a1 1 0 0 0 1 1h7', key: 't51u73' }],\n];\n\n/**\n * @component @name Save\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTUuMiAzYTIgMiAwIDAgMSAxLjQuNmwzLjggMy44YTIgMiAwIDAgMSAuNiAxLjRWMTlhMiAyIDAgMCAxLTIgMkg1YTIgMiAwIDAgMS0yLTJWNWEyIDIgMCAwIDEgMi0yeiIgLz4KICA8cGF0aCBkPSJNMTcgMjF2LTdhMSAxIDAgMCAwLTEtMUg4YTEgMSAwIDAgMC0xIDF2NyIgLz4KICA8cGF0aCBkPSJNNyAzdjRhMSAxIDAgMCAwIDEgMWg3IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/save\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Save = createLucideIcon('save', __iconNode);\n\nexport default Save;\n"],"names":[],"mappings":"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O,OAItD,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,cACR,KAAK,KACL,QAAS,IAAM,EAAkB,EAAc,EAAE,YAEjD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,iBAAiB,yBAUrD,CKtQA,IAAA,EAAA,EAAA,CAAA,CAAA,OKkBA,CCb4E,ADa5E,GAAA,EAAA,CAAA,EAAA,EAAA,OAAY,AAAZ,EAA6B,CCZb,ADYa,MAAO,CAnBhC,CFAD,AEAC,AHAD,AIAC,CAAA,AHAD,AEAC,AHAD,CIAC,AHAD,AEAC,AHAD,CIAC,AHAD,ADAA,AGAC,CCAA,AHAD,ADAA,AGAC,CAAA,ACAA,AJAD,ACAA,wJHKH,IAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,WIYM,EAAS,CAAA,CDAT,ACAS,CAAA,CAAT,CAAS,AAAT,CAAA,MAAS,EAAiB,CDAd,ACAc,UAAW,CDAR,ACAQ,CDAR,ACAQ,CDAR,ACAQ,CDAR,ACAQ,CAAA,MAlB5B,GAAI,KAAM,GAAI,CDAF,ADAD,CCAC,ADAD,IEAW,CDAL,ADAE,AEAG,CDAL,ADAE,AEAG,EAAK,IAAK,UAAU,CFAD,WECzC,GAAI,CFAH,AEAG,ADAH,CAAA,ACAG,AFAH,CAAA,ACAA,ACAG,CFAH,ACAA,ACAQ,CFAR,ACAA,ACAQ,CDAR,ACAQ,AFAR,CAAA,KEAkB,CFAlB,AEAkB,ADAF,CCAK,ADAL,ADAhB,CCAgB,ADAhB,AEAqB,CDAL,ADAhB,AEAqB,CAAA,AFArB,CEA0B,IAAK,CAAA,AFA/B,CAAA,AEA+B,CAAA,AFA/B,CAAA,AEA+B,CFA/B,AEA+B,CFA/B,AEA+B,CFA/B,AEA+B,CFA/B,AEA+B,EAAU,CFAzC,CECb,AFDa,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CECD,AFDC,CAAA,CAAA,CECG,AFDH,CECG,AFDH,ACCA,CAAA,ACAG,CDAH,ACAG,CDAH,ACAG,CDAH,ACAS,CAAA,ADAT,CCAS,ADAT,CAAA,ACAS,AAAI,CDAb,CAAA,CAAA,CAAA,ACAa,CDAb,ACAa,AAAM,CDAnB,ACAmB,CDAnB,ACAsB,CAAA,ADAtB,CCAsB,ADAtB,CAAA,ACAsB,CAAA,ADAtB,ACA2B,CDA3B,CAAA,CAAA,ACA2B,CDA3B,ACA2B,AAAK,CDAhC,ACAgC,CAAA,ADAhC,CAAA,ACAgC,CAAA,ADAhC,CAAA,ACAgC,CAAA,ADAhC,CAAA,ACAgC,CDAhC,ACAgC,EAAU,CDA1C,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,ACCL,CDAA,ACAA,AAAE,ADDG,AECP,AHYH,AIZG,CFAI,ADDG,AGCP,AJYI,AGZJ,CFDO,AECP,ACAA,AJYI,AEZA,CDDG,ACCH,CDDG,CAAA,CAAA,CAAA,CAAA,CAAA,CCCS,ADDT,CACA,AADA,AECP,AHYI,AIZJ,AFAgB,CDAT,ACAS,ACAhB,AHYI,AIZJ,CDAA,AHYI,AIZJ,AHAO,ACAS,AAAI,QAAS,CCA7B,AFAO,ADYsB,AIZ7B,CFA6B,ADAtB,ADYsB,AGZ7B,ACAA,CJY6B,AEZA,ADAtB,AGAP,ADAA,ADAiC,CAAA,ADA1B,AEAP,AHY6B,AIZ7B,CFAiC,AEAjC,AHAO,ADYsB,AGZ7B,CCAA,ADAA,AHY6B,ACZtB,ACA0B,CFYJ,AGZ7B,AFAO,ACA0B,AEAjC,CAAA,AHAO,AEAP,AHY6B,AEZI,CFYM,AIZvC,AHAO,AEAP,ADAiC,CDA1B,ADYgC,AGZvC,ADAiC,AEAjC,CHAO,AEAP,ACAA,AFAiC,AAAS,CDAnC,AEAP,ACAA,AFA0C,CAAA,ADAnC,AEAP,ACAA,CFA0C,ACA1C,ACAA,AHAO,ACAuC,CAAA,ACA9C,AFAO,AGAP,CFA8C,ACA9C,ACAA,AHAO,CCAuC,ADAvC,AGAP,ADAA,CDA8C,ADAvC,AGAP,ADAA,CCAA,ADAA,AFAO,ACAuC,GAAS,CAAA,AEAvD,AHAoD,AEApD,GDAuD,UAAe,CCAtE,ACAA,AFCP,CAAC,ACDM,ACAA,CAAA,ADAA,AFCN,AEDM,ACAA,CDAA,ACAA,AHCN,AGDM,CAAA,ADAA,CCAA,ADAA,CCAA,ADAA,CAAA,ACAA,CAAA,ADAA,CAAA,ACAA,CAAA,ADAA,CAAA,ACAA,CFCQ,AEDR,ADAA,CCAA,ADCE,ADAM,ADAF,AG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","ignoreList":[7,8,9,10,11]}