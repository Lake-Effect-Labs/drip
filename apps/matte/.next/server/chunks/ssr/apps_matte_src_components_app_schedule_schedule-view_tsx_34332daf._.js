module.exports=[73039,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(56711),f=a.i(9635),g=a.i(65052),h=a.i(55258),i=a.i(22658),j=a.i(10248),k=a.i(85579),l=a.i(82884),m=a.i(42724),n=a.i(74016);function o(a,b,c){let d=(0,n.toDate)(a,c?.in);return isNaN(b)?(0,m.constructFrom)(c?.in||a,NaN):(b&&d.setDate(d.getDate()+b),d)}var p=a.i(86451),q=a.i(68465),r=a.i(67638),s=a.i(60178);function t(a,b){return(0,n.toDate)(a,b?.in).getDay()}var u=a.i(83016);a.i(59193);var v=a.i(63561),w=a.i(39177),x=a.i(48351),y=a.i(22174),z=a.i(85158),A=a.i(20170),B=a.i(13749),C=a.i(50522),D=a.i(41675),E=a.i(41710),F=a.i(24987),G=a.i(46842);function H({initialJobs:a,teamMembers:m,currentUserId:n}){let[H,I]=(0,c.useState)(a),[J,K]=(0,c.useState)(new Date),[L,M]=(0,c.useState)("day"),[N,O]=(0,c.useState)("all"),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(!1),T=(0,c.useRef)(null),{addToast:U}=(0,A.useToast)();(0,u.createClient)();let V=(0,c.useCallback)(()=>{let a=T.current;a&&(Q(a.scrollLeft>0),S(a.scrollLeft<a.scrollWidth-a.clientWidth-1))},[]),W=(0,c.useCallback)(a=>{let b=T.current;if(b){let c=.8*b.clientWidth;b.scrollBy({left:"left"===a?-c:c,behavior:"smooth"})}},[]),X=H.filter(a=>"mine"!==N||a.assigned_user_id===n),Y=(0,c.useMemo)(()=>{let a,b;return"day"===L?(a=(0,r.startOfDay)(J),b=(0,r.startOfDay)(o(J,1))):"week"===L?(a=(0,f.startOfWeek)(J,{weekStartsOn:0}),b=(0,g.endOfWeek)(J,{weekStartsOn:0})):(a=(0,h.startOfMonth)(J),b=(0,i.endOfMonth)(J)),{start:a,end:b}},[J,L]),Z=(0,c.useMemo)(()=>{let{start:a,end:b}=Y;return X.filter(c=>{if(!c.scheduled_date)return!1;let d=(0,s.parseISO)(c.scheduled_date),e=c.scheduled_end_date?(0,s.parseISO)(c.scheduled_end_date):d;return d<=b&&e>=a}).sort((a,b)=>{if(a.scheduled_date!==b.scheduled_date)return a.scheduled_date.localeCompare(b.scheduled_date);let c=a.scheduled_time||"00:00",d=b.scheduled_time||"00:00";return c.localeCompare(d)})},[X,Y]),$=(0,c.useMemo)(()=>{if("day"===L)return[J];if("week"===L){let a=(0,f.startOfWeek)(J,{weekStartsOn:0});return(0,j.eachDayOfInterval)({start:a,end:(0,g.endOfWeek)(J,{weekStartsOn:0})})}let a=(0,h.startOfMonth)(J),b=(0,i.endOfMonth)(J),c=(0,j.eachDayOfInterval)({start:a,end:b}),d=t(a),e=[];for(let b=0;b<d;b++)e.push(o(a,-(d-b),void 0));let k=c[c.length-1],l=t(k),m=[];for(let a=1;a<7-l;a++)m.push(o(k,a));return[...e,...c,...m]},[J,L]),_=(0,c.useMemo)(()=>{let a=new Map,{start:b,end:c}=Y;return Z.forEach(d=>{if(!d.scheduled_date)return;let f=(0,s.parseISO)(d.scheduled_date),g=d.scheduled_end_date?(0,s.parseISO)(d.scheduled_end_date):f,h=new Date(f);for(;h<=g;){let f=(0,e.format)(h,"yyyy-MM-dd");if(h>=b&&h<=c){let b=a.get(f)||[];a.set(f,[...b,d])}h.setDate(h.getDate()+1)}}),a},[Z,Y]);function aa(a){"day"===L?K(b=>"next"===a?o(b,1):o(b,-1,void 0)):"week"===L?K(b=>"next"===a?o(b,7,void 0):o(b,-7,void 0)):K(b=>"next"===a?(0,p.addMonths)(b,1):(0,q.subMonths)(b,1))}return(0,c.useEffect)(()=>{V();let a=()=>V();return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[V,L]),(0,b.jsxs)("div",{className:"min-h-screen pb-20 lg:pb-0",children:[(0,b.jsx)("div",{className:"border-b bg-card p-4",children:(0,b.jsx)("div",{className:"w-full",children:(0,b.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Schedule"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"day"===L?(0,e.format)(J,"EEEE, MMMM d, yyyy"):"week"===L?`Week of ${(0,e.format)((0,f.startOfWeek)(J,{weekStartsOn:0}),"MMM d")}`:(0,e.format)(J,"MMMM yyyy")})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsxs)(x.Select,{value:N,onChange:a=>O(a.target.value),className:"w-full sm:w-40 min-w-[120px]",children:[(0,b.jsx)("option",{value:"all",children:"All jobs"}),(0,b.jsx)("option",{value:"mine",children:"My jobs"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 border rounded-lg shrink-0",children:[(0,b.jsx)(w.Button,{variant:"day"===L?"default":"ghost",size:"sm",onClick:()=>M("day"),className:"rounded-r-none rounded-l-lg",children:"Day"}),(0,b.jsx)(w.Button,{variant:"week"===L?"default":"ghost",size:"sm",onClick:()=>M("week"),className:"rounded-none",children:"Week"}),(0,b.jsx)(w.Button,{variant:"month"===L?"default":"ghost",size:"sm",onClick:()=>M("month"),className:"rounded-l-none rounded-r-lg",children:"Month"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 shrink-0",children:[(0,b.jsx)(w.Button,{variant:"outline",size:"sm",onClick:()=>aa("prev"),children:(0,b.jsx)(B.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsx)(w.Button,{variant:"outline",size:"sm",onClick:function(){K(new Date)},className:"text-xs px-2",children:"Today"}),(0,b.jsx)(w.Button,{variant:"outline",size:"sm",onClick:()=>aa("next"),children:(0,b.jsx)(C.ChevronRight,{className:"h-4 w-4"})})]})]})]})})}),(0,b.jsx)("div",{className:"w-full p-4",children:"day"===L?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"text-sm font-medium text-muted-foreground mb-2",children:[Z.length," job",1!==Z.length?"s":""," scheduled"]}),0===Z.length?(0,b.jsxs)(y.Card,{className:"p-12 text-center",children:[(0,b.jsx)(D.Calendar,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No jobs scheduled for this day"})]}):(0,b.jsx)("div",{className:"space-y-3",children:Z.map(a=>(0,b.jsx)(d.default,{href:`/app/jobs/${a.id}`,className:"block",children:(0,b.jsx)(y.Card,{className:(0,v.cn)("p-4 hover:opacity-90 transition-all border-l-4",v.JOB_STATUS_COLORS[a.status]),children:(0,b.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,b.jsxs)("div",{className:"flex-1 min-w-0 space-y-2",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 min-w-0",children:[(0,b.jsx)("h3",{className:"font-semibold flex-1",children:a.title}),(0,b.jsx)(z.Badge,{className:(0,v.cn)("shrink-0 self-start sm:self-center",v.JOB_STATUS_COLORS[a.status]),children:v.JOB_STATUS_LABELS[a.status]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2 text-sm text-muted-foreground",children:[a.scheduled_time&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(E.Clock,{className:"h-4 w-4 shrink-0"}),(0,b.jsx)("span",{children:(0,v.formatTime)(a.scheduled_time)})]}),a.customer&&(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)(G.User,{className:"h-4 w-4 shrink-0"}),(0,b.jsx)("span",{className:"truncate",children:a.customer.name})]}),a.address1&&(0,b.jsxs)("div",{className:"flex items-start gap-2 min-w-0",children:[(0,b.jsx)(F.MapPin,{className:"h-4 w-4 shrink-0 mt-0.5"}),(0,b.jsx)("span",{className:"break-words",children:[a.address1,a.city,a.state].filter(Boolean).join(", ")})]}),a.assigned_user_id&&(0,b.jsxs)("div",{className:"text-xs",children:["Assigned to: ",(a=>{if(!a)return"Unassigned";let b=m.find(b=>b.id===a);return b?.fullName||"Unknown"})(a.assigned_user_id)]})]})]})})})},a.id))})]}):(0,b.jsxs)("div",{className:"relative",children:[P&&"week"===L&&(0,b.jsx)("button",{onClick:()=>W("left"),className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 bg-card border rounded-full p-2 shadow-lg hover:bg-muted transition-colors touch-target","aria-label":"Scroll left",children:(0,b.jsx)(B.ChevronLeft,{className:"h-6 w-6"})}),R&&"week"===L&&(0,b.jsx)("button",{onClick:()=>W("right"),className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 bg-card border rounded-full p-2 shadow-lg hover:bg-muted transition-colors touch-target","aria-label":"Scroll right",children:(0,b.jsx)(C.ChevronRight,{className:"h-6 w-6"})}),(0,b.jsx)("div",{ref:T,onScroll:V,className:"overflow-x-auto scrollbar-hide",children:"week"===L?(0,b.jsx)("div",{className:"grid grid-cols-7 gap-1 sm:gap-2",children:$.map((a,c)=>{let f=(0,e.format)(a,"yyyy-MM-dd"),g=_.get(f)||[],h=(0,k.isSameDay)(a,new Date);return(0,b.jsxs)("div",{className:"space-y-2 min-w-[70px] sm:min-w-[80px]",children:[(0,b.jsxs)("div",{className:(0,v.cn)("text-center p-1 sm:p-2 rounded-lg",h&&"bg-primary text-primary-foreground"),children:[(0,b.jsx)("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:(0,e.format)(a,"EEE")}),(0,b.jsx)("div",{className:"text-base sm:text-lg font-semibold",children:(0,e.format)(a,"d")})]}),(0,b.jsx)("div",{className:"space-y-1.5 min-h-[200px]",children:g.map(a=>(0,b.jsx)(d.default,{href:`/app/jobs/${a.id}`,className:"block",children:(0,b.jsxs)(y.Card,{className:(0,v.cn)("p-2.5 hover:opacity-90 transition-all border-l-4",v.JOB_STATUS_COLORS[a.status]),children:[(0,b.jsx)("div",{className:"font-semibold text-sm truncate mb-1",children:a.title}),a.scheduled_time&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-0.5",children:(0,v.formatTime)(a.scheduled_time)}),a.customer&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground truncate",children:a.customer.name})]})},a.id))})]},c)})}):(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsx)("div",{className:"grid grid-cols-7 gap-px sm:gap-1 mb-1 sm:mb-2",children:[{full:"Sun",short:"S"},{full:"Mon",short:"M"},{full:"Tue",short:"T"},{full:"Wed",short:"W"},{full:"Thu",short:"T"},{full:"Fri",short:"F"},{full:"Sat",short:"S"}].map(a=>(0,b.jsxs)("div",{className:"text-center text-xs sm:text-sm font-semibold text-muted-foreground py-1 sm:py-2",children:[(0,b.jsx)("span",{className:"hidden sm:inline",children:a.full}),(0,b.jsx)("span",{className:"sm:hidden",children:a.short})]},a.full))}),(0,b.jsx)("div",{className:"grid grid-cols-7 gap-px sm:gap-1 auto-rows-fr",style:{minHeight:"400px"},children:$.map((a,c)=>{let f=(0,e.format)(a,"yyyy-MM-dd"),g=_.get(f)||[],h=(0,k.isSameDay)(a,new Date),i=(0,l.isSameMonth)(a,J);return(0,b.jsxs)("div",{className:(0,v.cn)("border rounded p-1 sm:p-2 flex flex-col overflow-hidden min-h-[60px] sm:min-h-[100px]",!i&&"bg-muted/30 text-muted-foreground",h&&"ring-1 sm:ring-2 ring-primary"),children:[(0,b.jsx)("div",{className:(0,v.cn)("text-xs sm:text-sm font-semibold mb-0.5 sm:mb-1 shrink-0",h&&"text-primary"),children:(0,e.format)(a,"d")}),(0,b.jsxs)("div",{className:"space-y-0.5 sm:space-y-1 overflow-y-auto flex-1",children:[g.slice(0,2).map(a=>(0,b.jsx)(d.default,{href:`/app/jobs/${a.id}`,className:"block",children:(0,b.jsxs)("div",{className:(0,v.cn)("text-[10px] sm:text-xs p-0.5 sm:p-1 rounded border-l-2 truncate touch-target-sm",v.JOB_STATUS_COLORS[a.status]),children:[(0,b.jsx)("span",{className:"hidden sm:inline",children:a.scheduled_time&&`${(0,v.formatTime)(a.scheduled_time)} `}),a.title]})},a.id)),g.length>2&&(0,b.jsxs)("div",{className:"text-[9px] sm:text-[10px] text-muted-foreground px-0.5",children:["+",g.length-2]})]})]},c)})})]})})]})})]})}a.s(["ScheduleView",()=>H],73039)}];

//# sourceMappingURL=apps_matte_src_components_app_schedule_schedule-view_tsx_34332daf._.js.map